% Authors:  Nils Carqueville, Daniel Murfet
 
\documentclass{compositio}
\usepackage{stmaryrd}
\usepackage{amsmath, amscd, amssymb, mathrsfs, accents, amsfonts}
\usepackage{url}
\usepackage[all]{xy}
\usepackage{longtable}
\usepackage{dsfont}
\usepackage{tikz}
\def\nicedashedcolourscheme{\shadedraw[top color=blue!22, bottom color=blue!22, draw=gray, dashed]}
\def\nicecolourscheme{\shadedraw[top color=blue!22, bottom color=blue!22, draw=white]}
\def\nicepalecolourscheme{\shadedraw[top color=blue!12, bottom color=blue!12, draw=white]}
\def\nicenocolourscheme{\shadedraw[top color=gray!2, bottom color=gray!25, draw=white]}
\def\nicereallynocolourscheme{\shadedraw[top color=white!2, bottom color=white!25, draw=white]}
\definecolor{Myblue}{rgb}{0,0,0.6}
\usepackage[a4paper,colorlinks,citecolor=Myblue,linkcolor=Myblue,urlcolor=Myblue,pdfpagemode=None]{hyperref}

\SelectTips{cm}{}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem*{theoremn}{Theorem}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{s}[theorem]{}
\newtheorem*{setup}{Setup}
\newtheorem*{propositionn}{Proposition}

\numberwithin{equation}{section}

% Operators
\def\eval{\operatorname{ev}}
\def\coev{\operatorname{coev}}
\def\res{\operatorname{Res}}
\def\sg{\operatorname{sg}}
\def\Inj{\operatorname{Inj}}
\def\inc{\operatorname{inc}}
\def\Proj{\operatorname{Proj}}
\def\Coker{\operatorname{Coker}}
\def\Ker{\operatorname{Ker}}
\def\Im{\operatorname{Im}}
\def\free{\operatorname{free}}
\def\can{\operatorname{can}}
\def\ac{\operatorname{ac}}
\def\HH{\operatorname{HH}}
\def\K{\mathbf{K}}
\def\D{\mathbf{D}}
\def\N{\mathbf{N}}
\def\sing{\operatorname{Sg}}
\def\Hom{\operatorname{Hom}}
\def\uHom{\underline{\Hom}}
\def\modd{\operatorname{mod}}
\def\Modd{\operatorname{Mod}}
\def\Grmodd{\operatorname{GrMod}}
\def\CM{\operatorname{CM}}
\def\Ker{\operatorname{Ker}}
\def\Spec{\operatorname{Spec}}
\def\straightK{\operatorname{K}}
\def\straightC{\operatorname{C}}
\def\holim{\operatorname{hocolim}}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\coh}{coh}
\DeclareMathOperator{\serre}{S}
\DeclareMathOperator{\Flat}{Flat}
\DeclareMathOperator{\qc}{qc}
\DeclareMathOperator{\Perf}{Perf}
\DeclareMathOperator{\Map}{Map}
\DeclareMathOperator{\Qco}{Qco}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\tot}{Tot}
\DeclareMathOperator{\skos}{K}
\DeclareMathOperator{\hht}{ht}
\DeclareMathOperator{\depth}{depth}
\DeclareMathOperator{\STr}{STr}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\str}{str}
\DeclareMathOperator{\hmf}{hmf}
\DeclareMathOperator{\HMF}{HMF}
\DeclareMathOperator{\HF}{HF}
\DeclareMathOperator{\pr}{pr}
\DeclareMathOperator{\At}{At}
\DeclareMathOperator{\lAt}{lAt}
\DeclareMathOperator{\mff}{mf}
\DeclareMathOperator{\MF}{MF}
\DeclareMathOperator{\Sh}{Sh}

\begin{document}

% Commands
\def\Atlarrow{\overset{\leftarrow}{\At}}
\def\Res{\res\!}
\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\lto}{\longrightarrow}
\newcommand{\xlto}[1]{\stackrel{#1}\lto}
\newcommand{\mf}[1]{\mathfrak{#1}}
\newcommand{\md}[1]{\mathscr{#1}}
\newcommand{\intvar}{\bs{x}_{\textup{int}}}
\newcommand{\extvar}{\bs{x}_{\textup{ext}}}
\newcommand{\qderu}[2]{\mathbf{D}^{#1}(#2)}
\newcommand{\ud}{\mathrm{d}}
\def\l{\,|\,}
\def\cf{\boldsymbol{cf}}
\def\bx{\boldsymbol{x}}
\def\by{\boldsymbol{y}}
\def\ba{\boldsymbol{a}}
\def\bb{\boldsymbol{b}}
\def\totimes{\otimes}
\def\di{Q}
\newcommand{\cotimes}[1]{\,\widehat{\otimes}_{#1}\,}
\def\QQ{\mathds{Q}}
\def\krc{C}
\def\diffm{d}
\def\diffh{d_{\chi}}
\def\redh{\overline{H}}
\def\ZZ{\mathds{Z}}
\def\bs{\boldsymbol}
\def\Ztwo{\mathds{Z}_2}
\def\mdual{^{\vee}}
\def\KR{\operatorname{KR}}
\def\I{\!\operatorname{i}\!}
\def\E{\operatorname{e}\!}
\def\sln{\mathfrak{sl}(N)}
\def\nN{\mathds{N}}
\def\nZ{\mathds{Z}}
\def\nQ{\mathds{Q}}
\def\nR{\mathds{R}}
\def\nC{\mathds{C}}
\def\Bar{\mathds{B}}
\def\cBar{\widehat{\mathds{B}}}
\def\Re{R^{\operatorname{e}}}
\def\Ae{A^{\operatorname{e}}}
\def\Be{B^{\operatorname{e}}}
\def\Aop{A^{\operatorname{op}}}
\def\Rop{R^{\operatorname{op}}}
\def\lra{\longrightarrow}
\def\lmt{\longmapsto}
\def\LG{\mathcal{LG}_k}
\def\dual{\dagger}
\def\dlangle{\big\langle\!\big\langle}
\def\drangle{\big\rangle\!\big\rangle}
\def\bigdlangle{\Big\langle\!\!\Big\langle}
\def\bigdrangle{\Big\rangle\!\!\Big\rangle}
\def\reprod{\gamma}
\newcommand{\Ress}[1]{\res_{#1}\!}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\def\Xcirc{%
\begin{tikzpicture}[inner sep=0mm]
\node (X) at (0,0) {$X$};
\node (0) at (0,0) [circle,inner sep=0.99pt, thin,draw=black,fill= white] {};
\end{tikzpicture}%
}
\def\Xbul{%
\begin{tikzpicture}[inner sep=0mm]
\node (X) at (0,0) {$X$};
\node (0) at (0,0) [circle,inner sep=0.99pt, thin,draw=black,fill= black] {};
\end{tikzpicture}%
}

\renewcommand{\labelenumi}{(\roman{enumi})}

\allowdisplaybreaks

\usetikzlibrary{arrows,calc,decorations.pathreplacing,decorations.markings,shapes.geometric,shadows}
\tikzset{
    string/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .51 with {\arrow[draw=#1]{>}}}},
    costring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .51 with {\arrow[draw=#1]{<}}}},
    ostring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .47 with {\arrow[draw=#1]{>}}}},
    ustring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .56 with {\arrow[draw=#1]{>}}}},
    oostring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .43 with {\arrow[draw=#1]{>}}}},
    uustring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .59 with {\arrow[draw=#1]{>}}}},
    directed/.style={string=blue!50!black}, 
    odirected/.style={ostring=blue!50!black}, 
    udirected/.style={ustring=blue!50!black}, 
    oodirected/.style={oostring=blue!50!black}, 
    uudirected/.style={uustring=blue!50!black},     
    redirected/.style={costring= blue!50!black},
}

\usetikzlibrary{fadings,decorations.pathreplacing}

\newcommand\pgfmathsinandcos[3]{%
  \pgfmathsetmacro#1{sin(#3)}%
  \pgfmathsetmacro#2{cos(#3)}%
}
\newcommand\LongitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % azimuth
  \tikzset{#1/.estyle={cm={\cost,\sint*\sinEl,0,\cosEl,(0,0)}}}
}
\newcommand\LatitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % latitude
  \pgfmathsetmacro\yshift{\cosEl*\sint}
  \tikzset{#1/.estyle={cm={\cost,0,0,\cost*\sinEl,(0,\yshift)}}} %
}
\newcommand\DrawLongitudeCircle[2][1]{
  \LongitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\angVis{atan(sin(#2)*cos(\angEl)/sin(\angEl))} %
  \draw[redirected,current plane,color=blue!50!black, very thick] (\angVis:1) arc (\angVis:\angVis+180:1);
  \draw[current plane,dotted,color=blue!50!gray, very thick] (\angVis-180:1) arc (\angVis-180:\angVis:1);
}
\newcommand\DrawLatitudeCircle[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[directed,current plane, color=blue!50!black] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed, color=blue!50!gray] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}
\newcommand\DrawLatitudeCircleU[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[redirected,current plane, color=blue!50!black] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed, color=blue!50!gray] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}





\title{Rise of the Planet of the Coevaluations}
\author{Nils Carqueville}
\email{nils.carqueville@physik.uni-muenchen.de}
\address{Arnold Sommerfeld Center for Theoretical Physics, LMU M\"unchen \& Excellence Cluster Universe}

\author{Daniel Murfet}
\email{daniel.murfet@math.ucla.edu}
\address{Department of Mathematics, UCLA}

\classification{TODO}

\begin{abstract}
They take over. 
\end{abstract}

\maketitle

\section{Introduction}\label{sec:Introduction}

Landau-Ginzburg models play a central role in many areas of mathematical physics and pure mathematics. Among them are diverse fields such as singularity theory, representation theory, (homological) mirror symmetry, knot invariants, or conformal and topological field theory. All these areas are intimately interrelated, and this richness is actually one of the aesthetical motivations to study Landau-Ginzburg models. Another general motivation is their dual nature of affording insight into deep, often beautiful, results while at the same time maintaining to provide the ability to perform concrete, hands-on computations. 

In the present paper we wish to show how the dichotomy just mentioned manifests itself in the context of two-dimensional topological field theory (TFT) with defects. In short, we will explain how Landau-Ginzburg models give rise to a class of bicategories with adjoints (and several additional properties), and we will see that these structures can be described both elegantly and explicitly. This in turn allows us to prove various general results to whose discussion we will come towards the end of this section. 

To set the stage and provide some background, let us recall a few ideas about TFTs with defects; for more detailed accounts we refer e.\,g.~to~\cite{k1004.2307} and~\cite[Section~2]{dkr1107.0495}. We imagine the bulk sector theories~$T_I$ to ``live'' on a two-dimensional surface called the \textsl{worldsheet}. More precisely, the worldsheet may be partitioned into various domains to which the (not necessarily distinct) theories~$T_I$ are associated, and which are separated by one-dimensional oriented \textsl{defect lines} $D_\alpha$. A sketch of a typical such partitioned worldsheet looks as follows: 
\be\label{worldsheetwithdefects}
\begin{tikzpicture}[very thick,scale=0.7,color=blue!50!black, baseline,>=stealth]
\clip (0,0) ellipse (6cm and 3cm);
\nicedashedcolourscheme (0,0) ellipse (6cm and 3cm);

\draw (-4.15,1.3) [white] node {{\scriptsize $T_1$}};
\draw (-5.1,-0.3) [white] node {{\scriptsize $T_2$}};
\draw (-1.3,2.2) [white] node {{\scriptsize $T_3$}};
\draw (2.2,2.0) [white] node {{\scriptsize $T_4$}};
\draw (1,0) [white] node {{\scriptsize $T_5$}};

\draw (-4.9,-1) node {{\scriptsize $D_1$}};
\draw (-4.7,0.8) node {{\scriptsize $D_2$}};
\draw (-2.5,1.3) node {{\scriptsize $D_3$}};
\draw (-3.6,-1.1) node {{\scriptsize $D_4$}};
\draw (-2.1,0.6) node {{\scriptsize $D_5$}};
\draw (3.5,1.8) node {{\scriptsize $D_6$}};
\draw (-0.4,0) node {{\scriptsize $D_7$}};
\draw (1.7,-1.7) node {{\scriptsize $D_8$}};

\draw (-4,0.45) node {{\scriptsize $\phi_1$}};
\draw (-2.1,-2) node {{\scriptsize $\phi_2$}};
\draw (-1.45,-2.15) node {{\scriptsize $\phi_3$}};
\draw (-0.62,-2.2) node {{\scriptsize $\phi_4$}};
\draw (4.5,0.84) node {{\scriptsize $\phi_5$}};
\draw (0.85,2.32) node {{\scriptsize $\phi_6$}};

\draw[->, very thick, out=60, in=260] (-5,-2) to (-4.5,-1);
\draw[very thick, out=80, in=220] (-4.5,-1) to (-4,0);
\filldraw (-4,0) circle (2.5pt);
\draw[->,very thick, out=150, in=350] (-4,0) to (-5,0.5);
\draw[very thick, out=170, in=350] (-5,0.5) to (-6,0.75);

\draw[->,very thick, out=-30, in=110] (-4,0) to (-3.2,-1);
\draw[very thick, out=-70, in=170] (-3.2,-1) to (-2.5,-2);
\filldraw (-2.5,-2) circle (2.5pt);

\draw[->,very thick, out=70, in=230] (-2.5,-2) to (-1.5,0.5);
\draw[very thick, out=50, in=200] (-1.5,0.5) to (1,2);
\filldraw (1,2) circle (2.5pt);

\draw[very thick, out=-30, in=180] (1,2) to (2,1.5);
\draw[->,very thick, out=0, in=270] (2,1.5) to (3,2);
\draw[very thick, out=90, in=0] (3,2) to (2,2.5);
\draw[very thick, out=180, in=30] (2,2.5) to (1,2);

\draw[very thick] (1,0) circle (1);
\draw[->,very thick, out=90, in=270] (0,0) to (0,0);

\filldraw (-1.5,-2.5) circle (2.5pt);

\filldraw (-0.5,-2.6) circle (2.5pt);
\draw[->,very thick, out=0, in=220] (-0.5,-2.6) to (2,-2);
\draw[very thick, out=40, in=260] (2,-2) to (4.5,0.5);
\filldraw (4.5,0.5) circle (2.5pt);

\draw[->,very thick, out=40, in=260] (-4,0) to (-3,1.5);
\draw[very thick, out=80, in=270] (-3,1.5) to (-2.5,3);
\end{tikzpicture}
\ee
In addition to the labels $T_I$ for the two-dimensional domains and $D_\alpha$ for the one-dimensional defect lines, we also include labels~$\phi_i$ for zero-dimensional points. These labels are interpreted as describing ``degrees of freedom'', or \textsl{fields}, inserted at the points on the worldsheet. Note that the fields can also be placed at junctions of multiple defect lines. 

A TFT is a functor that assigns a number called the \textsl{correlator} to a labelled worldsheet like~\eqref{worldsheetwithdefects}. Its topological nature implies that the value of any correlator does not depend on the precise position of the $D_\alpha$'s and $\phi_i$'s, but only on their isotopy class. 

It is natural to try and make sense of this situation in terms of a bicategory: its objects are the theories $T_I$, 1-morphisms are labelled defect lines $D_\alpha$, and 2-morphisms are the fields $\phi_i$. The composition of 2-morphisms is the operator product of the fields, which is strictly associative because we only consider \textsl{topological} field theories. The composition of 1-morphisms comes about as follows: since the exact locus of the defect lines does not matter, two (or more) adjacent defect lines can be brought together arbitrarily close, and the limit of this \textsl{fusion} is well-defined and non-singular. The unit of the fusion product is the \textsl{invisible defect} which by definition leaves any other defect line invariant under fusion (from both left and right). 

Thus any TFT with defects is expected to give rise to a bicategory. Standard examples for bicategories include the bicategory of categories (with objects, 1- and 2-morphisms given by categories, functors and natural transformations, respectively) or rings (rings, bimodules, bimodule maps), but these are too generic to be known to describe relevant TFTs. A rich and interesting example is the bicategory of algebraic varieties with Fourier-Mukai kernels as 1-morphisms~\cite{ct1007.2679} which describes B-twisted sigma models, see~e.\,g.~\cite{MB2}. 

The example that we study in this paper is the bicategory $\LG$ of Landau-Ginzburg models. Roughly, its objects (or bulk theories) are given by elements (or \textsl{potentials})~$W$ in a polynomial ring $R=k[x_1,\ldots,x_n]$ which have isolated singularities, and its 1- and 2-morphisms (or defects and fields) are described by the triangulated categories of matrix factorisations of potential differences $V-W$.\footnote{We will allow any commutative noetherian $\nQ$-algebra~$k$ for the coefficients of the polynomial ring, e.\,g.~$k=\nC$ or $k=\nC[t_1,\ldots,t_d]$ where the~$t_i$ may be interpreted as deformation parameters.} The fusion of 1-morphisms is the tensor product~\cite{br0707.0922}, and the invisible defect is the stabilised diagonal which we present as the Koszul factorisation $\Delta = \bigwedge (\bigoplus_{i=1}^n (R\otimes_k R)\cdot \theta_i)$ (see Section~\ref{sec:Background} for a detailed description). That $\LG$ is indeed a bicategory has been worked out in~\cite{McNameethesis, Calinetal, cr0909.4381}. 

On general grounds it is expected that the bicategorical description of TFTs with defects comes equipped with additional structure. In particular, the fact that we consider \textsl{oriented} defect lines should give rise to adjunctions on the level of 1-morphisms: the ``same'' defect line with reversed orientation should be adjoint to the defect with opposite orientation. In the case of Landau-Ginzburg models this means that for every matrix factorisation~$X$ of $V-W$ there is a matrix factorisation~$X^\dual$ of $W-V$ together with evaluation and coevaluation maps
\be\label{evcoevintro}
\eval_X: X^\dual \otimes X \lra \Delta_W 
\, , \qquad
\coev_X: \Delta_V \lra X \otimes X^\dual
\ee
that are the counit and unit of a (right) adjunction between~$X$ and~$X^\dual$. Similarly, one expects maps $\widetilde\eval_X: X\otimes X^\dual \lra \Delta_V$ and $\widetilde\coev_X: \Delta_W \lra X^\dual \otimes X$ that make~$X^\dual$ the left adjoint of~$X$, and furthermore there should exist natural isomorphisms $X\lra X^{\dual\dual}$ which give rise to a so-called pivotal structure. The special case where~$V$ and~$W$ are the same polynomial and depend on only one variable was worked out in~\cite{cr1006.5609}; we refer to that paper's introductory section for further motivation from the physical picture. 

In the present paper we prove that $\LG$ has adjoints and is pivotal in the general case. We do so by developing a conceptual framework from which we obtain explicit expressions for the above adjunction maps, opening the door for many applications. The two key ingredients for our description are \textsl{homological perturbation} and the introduction of \textsl{associative Atiyah classes} to the world of matrix factorisations, following a suggestion by Buchweitz. In this way the adjunction structures can be organised in a rather clean and elegant way, the basic intuition behind which is roughly as follows: [TODO: some words on Atiyah classes, curvature, and all that] 

But regardless of the conceptual origins of the adjunction properties of $\LG$, in the end they produce very explicit formulas one can actually calculate with in practice: for a matrix factorisation~$X$ of $V-W$ with differential~$D$, the maps are given by
\be\label{evcoevexplicit}
\eval_X = TODO \, , \qquad
\coev_X = TODO
\ee
where $\partial_{[i]}$ denotes the difference quotient operator for the $i$-th variable in $k[x]=k[x_1,\ldots,x_n]$, see~\eqref{diffquotop}. The mixture of explicitness and conceptual control rather effortlessly affords various applications which are of importance in their own right. We shall discuss some of them in later parts of this paper, and we briefly mention two of them already now. 

Recall that a bulk field in a Landau-Ginzburg model with potential $W\in k[x]$ is described as an endomorphism of the stabilised diagonal $\Delta_W$, so the field is an element in the Jacobi algebra $\operatorname{Jac}(W) = k[x]/(\partial_{x_i} W)$. Given a matrix factorisation~$X$ of $V-W$, i.\,e.~a defect between the theories~$W$ and $V\in k[z_1,\ldots,z_m]$, we obtain an operator $\mathcal D_r(X)$ between the spaces of bulk fields by sending $\psi\in\operatorname{Jac}(W)$ to an element in $\operatorname{Jac}(V)$ obtained by ``wrapping the defect line labelled by~$X$ around~$\psi$''. We can make rigorous sense of this \textsl{defect action on bulk fields} in terms of string diagrams in the bicategory $\LG$ as 
\begin{align}\label{defectactionIntro}
\mathcal D_r(X)(\psi) = 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]
%\fill (1.5,1.3) circle (2.5pt) node[right] {{\small $\lambda_{X^\dual}$}};
%\fill (1.5,-1.3) circle (2.5pt) node[right] {{\small $\lambda^{-1}_{X^\dual}$}};
%\fill (0,0) circle (2.5pt) node[left] {{\small $\psi$}};
%\fill (0.6,1) circle (0pt) node {{\small $\Delta_W$}};
%\fill (0.6,-0.95) circle (0pt) node {{\small $\Delta_W$}};
%\draw[redirected] (1.5,1.3) .. controls +(0,1.5) and +(0,1.5) .. (-1.5,1.3);
%\draw[redirected] (-1.5,-1.3) .. controls +(0,-1.5) and +(0,-1.5) .. (1.5,-1.3);
%\draw (1.5,-1.3) -- (1.5,1.3);
%\draw (-1.5,-1.3) -- (-1.5,1.3)
%node[midway,left] {{{\small$X$}}};
%\draw[dashed] (0,0) .. controls +(0,1) and +(-0.5,-1) .. (1.5,1.3);
%\draw[dashed] (0,0) .. controls +(0,-1) and +(-0.5,1) .. (1.5,-1.3);
%\draw[dashed] (0,-2.5) -- (0,-3.5)
%node[near end,right] {{{\small$\Delta_V$}}};
%\draw[dashed] (0,2.47) -- (0,3.5)
%node[near end,right] {{{\small$\Delta_V$}}};
%\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\nicepalecolourscheme (0,0) circle (3.5);
\fill (-2.2,-2.2) circle (0pt) node[white] {{\small$V$}};
\nicecolourscheme (0,0) circle (2);
\fill (-1.1,-1.1) circle (0pt) node[white] {{\small$W$}};
%
\fill (180:2) circle (0pt) node[left] {{\small$X$}};
\draw (0,0) circle (2);
\draw[<-, very thick] (0.100,2) -- (-0.101,2) node[above] {}; 
\draw[<-, very thick] (-0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (135:0) circle (3.3pt) node[left] {{\small$\psi$}};
\fill (50:2) circle (3.3pt) node[right] {{\small$\lambda_{X^\dual}$}};
\fill (-50:2) circle (3.3pt) node[right] {{\small$\lambda^{-1}_{X^\dual}$}};
\draw[dashed] (135:0) .. controls +(0,1) and +(-0.5,-1) .. (50:2);
\fill (0.4,1.15) circle (0pt) node {{\small $\Delta_W$}};
\fill (0.4,-1.15) circle (0pt) node {{\small $\Delta_W$}};
\draw[dashed] (135:0) .. controls +(0,-1) and +(-0.5,1) .. (-50:2);
\draw[dashed] (270:2) -- (270:3.3)
node[near end,right] {{{\small$\Delta_V$}}};
\draw[dashed] (90:2) -- (90:3.3)
node[near end,right] {{{\small$\Delta_V$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\equiv\;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\nicepalecolourscheme (0,0) circle (3.5);
\fill (-2.2,-2.2) circle (0pt) node[white] {{\small$V$}};
\nicecolourscheme (0,0) circle (2);
\fill (-1.1,-1.1) circle (0pt) node[white] {{\small$W$}};
%
\fill (180:2) circle (0pt) node[left] {{\small$X$}};
\draw (0,0) circle (2);
\draw[<-, very thick] (0.100,2) -- (-0.101,2) node[above] {}; 
\draw[<-, very thick] (-0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (135:0) circle (3.3pt) node[left] {{\small$\psi$}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\; ,
\end{align}
where as usual (and explained in more detail in Section~\ref{subsec:bicatLG}) evaluation and coevaluation maps are denoted as caps and cups, respectively, $\lambda_{X^\dual}$ is the left action of $\Delta_W$ on~$X^\dual$, and we always read diagrams like the above from bottom to top. In Section~\ref{sec:defectaction} we will prove the general formula 
\be\label{DrXpsi}
\mathcal D_r(X)(\psi)  = (-1)^{{m\choose 2} + {n+1\choose 2}} \Res_{k[x,z]/k[z]} \left[ \frac{\psi \str\big( \partial_{z_1} D\ldots \partial_{z_m} D \, \partial_{x_1} D\ldots \partial_{x_n} D \big) \underline{\operatorname{d}\! x}}{\partial_{x_1} W \ldots \partial_{x_n} W} \right]
\ee
as well as various properties such as $\mathcal D_r(X\otimes Y) = \mathcal D_r(X) \circ \mathcal D_r(Y)$. 

One may also consider the situation in~\eqref{defectactionIntro} with an additional defect field $\Phi\in\End(X)$ inserted on the $X$-loop. We will see that this simply amounts to the insertion of~$\Phi$ as a factor inside the supertrace in~\eqref{DrXpsi}. As the two special cases $V=0$ and $W=0$ we thus obtain
$$
\!\!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.4,color=blue!50!black, baseline,>=stealth]
\nicecolourscheme (0,0) circle (2);
\fill (-1.0,-1.0) circle (0pt) node[white] {{\small$W$}};
%
\fill (180:1.8) circle (0pt) node[left] {{\small$X$}};
\fill (130:2) circle (3.3pt) node[left] {{\small$\Phi$}};
\draw (0,0) circle (2);
\draw[<-, very thick] (0.100,2) -- (-0.101,2) node[above] {}; 
\draw[<-, very thick] (-0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (135:0) circle (3.3pt) node[left] {{\small$\psi$}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
= 
(-1)^{{n+1\choose 2}} \Res_{k[x]/k} \!\!\left[ \frac{\psi \str\big( \Phi \Lambda_X^{(x)} \big) \underline{\operatorname{d}\! x}}{\partial_{x_1} W \ldots \partial_{x_n} W} \right] , 
\qquad
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.4,color=blue!50!black, baseline,>=stealth]
\nicepalecolourscheme (0,0) circle (3.5);
\fill (-2.1,-2.1) circle (0pt) node[white] {{\small$V$}};
\shadedraw[top color=white, bottom color=white, draw=white] (0,0) circle (2);
%
\fill (180:1.8) circle (0pt) node[left] {{\small$X$}};
\fill (130:2) circle (3.3pt) node[left] {{\small$\Phi$}};
\draw (0,0) circle (2);
\draw[<-, very thick] (0.100,2) -- (-0.101,2) node[above] {}; 
\draw[<-, very thick] (-0.100,-2) -- (0.101,-2) node[below] {}; 
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 = 
(-1)^{{m\choose 2}} \str\big( \Phi \Lambda_X^{(z)} \big) \, . 
$$
In this way we recover the \textsl{Kapustin-Li disk correlator} and the \textsl{boundary-bulk map} (which reduces to the \textsl{Chern character} $(-1)^{{m\choose 2}} \str( \partial_{z_1} D\ldots \partial_{z_m} D)$ for $\Phi=1$). 

Another application of our construction of adjunctions in $\LG$ is a new proof of the \textsl{Cardy condition} (see Section~\ref{sec:CardyCondition} for its precise statement). This generalisation of the Hirzebruch-Riemann-Roch theorem is the most ``quantum'' among the axioms for open/closed TFTs (as it stems from a one-loop diagram) and may accordingly be viewed as a particularly deep structure. In the case of Landau-Ginzburg models it was proved only recently in~\cite{pv1002.2116} and~\cite{dm1102.2957} for $k=\nC$ using rather heavy or technical machinery. Or proof works for any commutative noetherian $\nQ$-algebra~$k$ and simply follows from the fact that the 2-morphisms
$$
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline,>=stealth]
\nicecolourscheme (0,0) circle (2);
\nicereallynocolourscheme (0,0) circle (1);
\fill (1.5,0) circle (0pt) node[white] {{\small$W$}};
\draw (0,0) circle (2);
\draw[->, very thick] (-0.100,2) -- (-0.101,2) node[above] {{\small$\eval_Y$}}; 
\draw[->, very thick] (0.100,-2) -- (0.101,-2) node[below] {{\small$\widetilde\coev_Y$}}; 
\fill (45:2) circle (2.5pt) node[right] {{\small$\psi$}};
%
\draw (0,0) circle (1);
\draw[->, very thick] (0.100,1) -- (0.101,1) node[above] {{\small$\widetilde\eval_X$}}; 
\draw[->, very thick] (-0.100,-1) -- (-0.101,-1) node[below] {{\small$\coev_X$}}; 
\fill (135:1) circle (2.5pt) node[left] {{\small$\varphi$}};
\end{tikzpicture} 
$$
in $\LG$ (which is to be identified with an annulus correlator) can be evaluated in two ways: either by first contracting the inner $X$-loop and then contracting the outer $Y$-loop, or by first fusing~$X$ with~$Y$ and then contracting the fused $(X^\dual \otimes Y)$-loop. Applying special cases of our expressions~\eqref{evcoevexplicit} then immediately produces the Cardy condition. 

[TODO: mention new, more general Kapustin-Li proof here or somewhere else]

Let us conclude this introductory section by naming some further motivations for and future applications of the results presented in this paper. One of the most intriguing properties of Landau-Ginzburg models is that they are on one of the two sides of the \textsl{CFT/LG correspondence}. It roughly states that many aspects of a large class of conformal field theories (CFTs) can be described in terms of (non-conformal) Landau-Ginzburg models. CFTs have an extremely rich structure, and the subclass of \textsl{rational} CFTs are particularly well-understood. Starting with~\cite{tft1} their description in terms of a beautiful categorical theory has been developed, and one may wonder which structures encountered in rational CFT can also be found in the theory of Landau-Ginzburg models -- whether or not they correspond to a rational CFT. The complete answer to this question is not known, but at least all the formal properties of $\LG$ that we establish in this paper also hold for the bicategory of topological defects in rational conformal field theory. Of course this by no means exhausts the richness of rational CFT, and there remain many properties of Landau-Ginzburg models to be uncovered, inspired by the CFT/LG correspondence. 

One example is the \textsl{generalised orbifold} procedure of~\cite{ffrs0909.5013} which constructs all rational CFTs of fixed central charge from any given single such CFT. Carried over to Landau-Ginzburg models this leads to the following picture: under the right circumstances a Landau-Ginzburg model with potential~$V$ can be obtained from a model with completely different potential~$W$ by identifying a 1-endomorphism~$F$ in $\LG(W,W)$ that can be equipped with the structure of a special symmetric Frobenius algebra (see e.\,g.~\cite[Section~3]{tft1}). Then the category of matrix factorisations of~$V$ is equivalent to the category of $F$-modules. The results of the present paper facilitate the construction of suitable algebras as follows: for any defect $X\in \LG(W,V)$ with invertible \textsl{quantum dimension} $\mathcal D_r(X)(1)$ we obtain a special symmetric Frobenius algebra $F = X^\dual \otimes X$ that allows to recast everything about theory~$V$ in terms of theory~$W$. Also note that with our explicit formula~\eqref{DrXpsi} the condition of invertibility of the quantum dimension is very easy to check in practice. The details of this construction will be described along with examples in the forthcoming paper~\cite{genorb}. 

[TODO: 2-representations, work of Murfet-Rouquier]

TODO: The rest of the present paper is organised as follows. 


\begin{acknowledgements}
TODO: especially Ragnar Buchweitz, also Ingo Runkel and who else? 
\end{acknowledgements}


\section{Background}\label{sec:Background}

\subsection{Bicategory of Landau-Ginzburg models}\label{subsec:bicatLG}

Let us fix the ring $R=k[x_1,\ldots,x_n]$, where~$k$ is a commutative noetherian $\nQ$-algebra; relevant examples are $k=\nC$ and $k=\nC[t_1,\ldots,t_d]$. Typically we will simply write $k[x]$ for $k[x_1,\ldots,x_n]$. We call an element $W\in R$ a \textsl{potential} if $R/(\partial_{x_i}W)$ is finitely generated projective over~$k$ and the $\partial_{x_i}W$ form a regular sequence. In this case $k=\nC$ this simply means that the Jacobi ring $R/(\partial_{x_i}W)$ is a finite-dimensional vector space. 

A \textsl{linear factorisation} of a potential $W\in R$ is a $\nZ_2$-graded $R$-module $X=X^0\oplus X^1$ together with an odd $R$-linear endomorphism~$d_X$ such that $d_X^2=W\cdot 1_X$. If~$X$ is a free $R$-module then the pair $(X,d_X)$ is called a \textsl{matrix factorisation}, and we often refer to it simply by~$X$ without explicitly mentioning the \textsl{differential} $d_X$; given a basis for~$X$ we sometimes identify the latter with the associated matrix: 
$$
d_{X} = \begin{pmatrix} 0 & d_X^1 \\ d_X^0 & 0\end{pmatrix} .
$$

A \textsl{morphism} of linear factorisations $(X,d_X)$ and $(Y,d_Y)$ is an even $R$-linear map $\varphi: X \longrightarrow Y$ such that $d_Y \varphi = \varphi d_X$. Two morphisms $\varphi, \psi: X\lra Y$ are \textsl{homotopic} if there exists an odd $R$-linear map $\lambda:X\lra Y$ such that $d_Y\lambda + \lambda d_X = \psi-\varphi$. Equality up to homotopy is an equivalence relation. \textbf{todo} Fix notation for Hom complexes.

The \textsl{(homotopy) category of linear factorisations} $\HF(R,W)$ is the category of linear factorisations of $W\in R$ modulo homotopy relations. We denote by $\HMF(R,W)$ its full subcategory of matrix factorisations, and we write $\hmf(R,W)$ for the full subcategory of matrix factorisations whose objects are isomorphic to matrix factorisations with finitely-generated underlying $R$-modules. These three categories have standard triangulated structures whose shift functor we denote as~$[1]$. 

Given a potential $W\in R=k[x]$ there is always the \textsl{unit matrix factorisation} $\Delta_W \in \hmf(\Re, \widetilde W)$ where $\Re = R\otimes_k R$ and $\widetilde W = W\otimes 1 - 1\otimes W$. Introducing~$n$ formal symbols $\theta_i$ as a convenient notational device, we have 
\be\label{DeltaW}
\Delta_W = \bigwedge \Big( \bigoplus_{i=1}^n \Re \theta_i \Big)
\ee
as an $\Re$-module whose $\nZ_2$-grading is given by $\theta$-degree modulo~2. We write 
\be\label{DeltaWstabmap}
\pi: \Delta_W \lra R
\ee
for the projection $\Delta_W \lra \Re$ to the $\theta$-degree~$0$ component composed with multiplication $\Re \lra R$. Typically we will omit the wedge product and write  e.\,g.~$\theta_i\wedge \theta_j$ simply as $\theta_i \theta_j$. To describe the differential $d_{\Delta_W}$ we further need the variable-changing map
$$
{}^{t_i}(-): k[x,x'] \lra k[x,x'] \, , \qquad f \lmt f\big|_{x_i\lmt x'_i}
$$
in terms of which we can define difference quotient operators
\be\label{diffquotop}
\partial_{[i]}: k[x,x'] \lra k[x,x'] \, , \qquad f \lmt \frac{{}^{t_1\ldots t_{i-1}}f - {}^{t_1\ldots t_i}f}{x_i-x'_i} \, . 
\ee
It is easy to check that the $\partial_{[i]}$ satisfy the following kind of Leibniz rule: 
\begin{lemma}\label{lem:LeibnizForDQO}
For $f,g \in k[x,x']$ we have $\partial_{[i]}(fg) = (\partial_{[i]}f) ({}^{t_1\ldots t_{i}}g) + ({}^{t_1\ldots t_{i-1}}f) (\partial_{[i]}g)$. 
\end{lemma}

The differential on $\Delta_W$ is given by
\be\label{DeltaW}
d_{\Delta_W} = \delta_+ + \delta_- \, , \qquad \delta_+ = \sum_{i=1}^n \partial_{[i]}W\cdot \theta_i\, , \qquad \delta_- =  \sum_{i=1}^n (x_i-x'_i) \cdot \theta_i^*  \,. 
\ee
We call $\Delta_W$ the unit matrix factorisation as it is the unit with respect to the tensor product of matrix factorisations. For our purposes it will be sufficient to consider matrix factorisations $X\in \HMF(R_1\otimes_k R_2, W_2-W_1)$ and $Y\in \HMF(R_2\otimes_k R_3, W_3-W_2)$ (where of course $R_i = k$ is a possibility for any~$i$). Then the \textsl{tensor product matrix factorisation} $Y\otimes X \in \HMF(R_1\otimes_k R_3, W_3-W_1)$ is the module 
$$
Y\otimes X = \Big( (Y^0\otimes_{R_2} X^0) \oplus (Y^1\otimes_{R_2} X^1) \Big) \oplus \Big( (Y^0\otimes_{R_2} X^1) \oplus (Y^1\otimes_{R_2} X^0) \Big) 
$$
together with the differential
$$
d_{Y\otimes X} = d_Y \otimes 1 + 1 \otimes d_X
$$
where the second term comes with the usual Koszul signs when applied to elements. We  observe that e.\,g.~by the argument of~\cite[Section~12]{dm1102.2957} the tensor product does not lead out of the categories $\hmf(R_i \otimes_k R_j, W_j - W_i)$ (\textbf{todo} warning warning). Also note that there are obvious natural isomorphisms $\alpha_{X,Y,Z}: (X\otimes Y)\otimes Z \lra X\otimes (Y \otimes Z)$. 

Now we can be more specific about the tensor action of the unit matrix factorisation. For $X\in \hmf(R_1 \otimes_k R_2,W_2-W_1)$ there are natural maps
\be\label{lambdarho}
\lambda_X = \pi \otimes 1_X: \Delta_{W_2} \otimes X \lra X \, , \qquad \rho_X = 1_X \otimes \pi : X \otimes \Delta_{W_1} \lra X
\ee
which are isomorphisms in $\hmf(R_1 \otimes_k R_2,W_2-W_1)$. Later in Section~\ref{section:pertandhtpy} we will give a description of their explicit homotopy inverses. 

\begin{definition}
The \textsl{bicategory of Landau-Ginzburg models} $\LG$ consists of the following data: 
\begin{itemize}
\item Objects are pairs $(R,W)$ with $W\in R=k[x]$ a potential. 
\item 1- and 2-morphisms are the objects and morphisms of the categories $\hmf(R_1 \otimes_k R_2,W_2-W_1)$, respectively. 
\item The unit 1-morphisms are $\Delta_W \in \hmf(\Re,\widetilde W)$. 
\item The composition functor is the tensor product
$$
\otimes : \hmf(R_2 \otimes_k R_3,W_3-W_2) \times \hmf(R_1 \otimes_k R_2,W_2-W_1) \lra \hmf(R_1 \otimes_k R_3,W_3-W_1) \, .
$$
\item There are natural 2-isomorphisms $\alpha, \lambda, \rho$ as above. 
\end{itemize}¥
\end{definition}

\begin{proposition}[\cite{McNameethesis, Calinetal, cr0909.4381}] 
$\LG$ really is a bicategory, i.\,e.~$\alpha, \lambda, \rho$ are natural isomorphisms up to homotopy, and they satisfy the coherence axioms for bicategories. 
\end{proposition}

\begin{remark}\label{remark:gradedbicategory}
An analogous statement is also true of the bicategory of \textsl{graded} Landau-Ginzburg models $\LG^{\mathrm{gr}}$. Its objects are pairs $(R,W)$ as above but with the additional requirement that~$R$ is a $\nZ$-graded ring and~$W$ is homogeneus of some degree $2c$. A graded linear factorisation is then a pair $(X,d_X)$ as before, but in addition we ask~$X$ to be a $\nZ$-graded module and~$d_X$ homogeneous of degree~$c$. Morphisms of graded linear factorisations must have $\nZ$-degree zero. As shown in~\cite{cr0909.4381} this is in particular true of the structure maps $\alpha, \lambda, \rho$. 

As a relevant example let us discuss the graded Hom. For graded linear factorisations $X,Y$ of $W,W' \in R_{2c}$, respectively, we can form the $\nZ$-graded $R$-module $\Hom_{\mathrm{gr}}(X,Y) = \bigoplus_{i \in \mathds{Z}} \Hom_R(X,Y)_i$, where $\Hom_R(X,Y)_i$ denotes the group of all $R$-linear maps $X \lto Y$ of $\nZ$-degree~$i$. This is a submodule of $\Hom_R(X,Y)$, and if~$X,Y$ are finitely generated then $\Hom_{\mathrm{gr}}(X,Y) = \Hom_R(X,Y)$. This graded module has a $\nZ_2$-decomposition into even and odd maps, 
\begin{align*}
\Hom_{\mathrm{gr}}(X,Y) &= \Big( \Hom_{\mathrm{gr}}(X^0, Y^0) \oplus \Hom_{\mathrm{gr}}(X^1, Y^1) \Big) \oplus \Big( \Hom_{\mathrm{gr}}(X^0, Y^1) \oplus \Hom_{\mathrm{gr}}(X^1, Y^0) \Big) \, .
\end{align*}
Together with the differential defined on a $\nZ$-homogeneous map $\alpha$ by $\alpha \lmt d_Y \circ \alpha - (-1)^{|\alpha|} \alpha \circ d_X$, the graded module $\Hom_{\mathrm{gr}}(X,Y)$ is a graded linear factorisation of $W' - W$. In particular if $W = W'$ we have a $(\ZZ \times \nZ_2)$-graded complex. This construction is functorial, in the sense that if $\varphi: Y \lra Y'$ is a morphism of graded linear factorisations of degree~$i$, then $\Hom_{\mathrm{gr}}(1_X,\varphi)$ is another morphism of degree~$i$, and similarly in the first variable.
\end{remark}


One of the main results of the present paper is that $\LG$ (and also $\LG^{\mathrm{gr}}$) is endowed with an additional duality structure. Let us recall the relevant notion. 

\begin{definition}\label{def:bicatduals}
We say a bicategory~$\mathcal B$ \textsl{has adjoints} if for each 1-morphism $X\in \mathcal B(A,B)$ there exists a 1-morphism $X^\dual \in \mathcal B(B,A)$ together with 2-morphisms 
\be\label{evcoev}
\eval_X : X^\dual \otimes X \lra 1_A \, , \qquad \coev_X : 1_B \lra X \otimes X^\dual
\ee
satisfying 
\begin{align}
\rho_X \circ (1_X \otimes \eval_X) \circ \alpha_{X,X^\dual,X} \circ (\coev_X \otimes 1_X) \circ \lambda_X^{-1} & = 1_X \, , \label{uglyZorro1}\\
\lambda_{X^\dual} \circ (\eval_X \otimes 1_{X^\dual}) \circ \alpha^{-1}_{X^\dual,X,X^\dual} \circ (1_{X^\dual} \otimes \coev_X) \circ \rho_{X^\dual}^{-1} & = 1_{X^\dual} \, . \label{uglyZorro2}
\end{align}
\end{definition}

It is convenient (and also suggested by the motivation discussed in the Introduction) to denote identities in bicategories with duals in string diagram notation, see e.\,g.~\cite{JSGoTCI,JSGoTCII} for more details (\textbf{todo} So we fix specific adjunctions for each $X$). In this language the evaluation and coevaluation maps~\eqref{evcoev} are written as
$$
\eval_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_A$}}
(3,0) node[line width=0pt] (D) {{\small $X\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {\small{$X^\dual$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {{\small$X^\dual$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture} , 
\qquad
\coev_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_B$}}
(3,0) node[line width=0pt] (D) {{\small$X\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {{\small$X^\dual$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X\vphantom{A^\dual}$}}
(2,0) node[line width=0pt] (s) {{\small$X^\dual$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture} \, . 
$$
Note that such diagrams are always to be read from bottom to top. Then the defining relations~\eqref{uglyZorro1} and~\eqref{uglyZorro2} translate into the \textsl{Zorro moves}
\be\label{Zorros}
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(-1,1.25) node[line width=0pt] (A) {{\small $X$}}
(1,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw[directed] (0,0) .. controls +(0,-1) and +(0,-1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,1) and +(0,1) .. (0,0);
\draw (-1,0) -- (A); 
\draw (1,0) -- (A2); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw (A2) -- (A); 
\end{tikzpicture}
\, , \qquad
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(1,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(-1,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw[directed] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,-1) and +(0,-1) .. (0,0);
\draw (-1,0) -- (A2); 
\draw (1,0) -- (A); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw (A2) -- (A); 
\end{tikzpicture} \, .
\ee

The adjoint~$X^\dual$ of~$X$ as described in Definition~\ref{def:bicatduals} is more precisely called \textsl{right adjoint} to~$X$, and one says that~$X^\dual$ is \textsl{left adjoint} to~$X$ if there are maps 
$$
\widetilde\eval_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_B$}}
(3,0) node[line width=0pt] (D) {{\small $X^\dual\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {\small{$X\vphantom{X^\dual}$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X^\dual$}}
(2,0) node[line width=0pt] (s) {{\small$X\vphantom{X^\dual}$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture} , 
\qquad
\widetilde\coev_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_A$}}
(3,0) node[line width=0pt] (D) {{\small$X^\dual$}}
(2,0) node[line width=0pt] (s) {{\small$X\vphantom{X^\dual}$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X^\dual$}}
(2,0) node[line width=0pt] (s) {{\small$X\vphantom{X^\dual}$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture}
$$
satisfying the associated Zorro moves
\be\label{otherZorros}
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(1,1.25) node[line width=0pt] (A) {{\small $X$}}
(-1,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw[redirected] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[redirected] (1,0) .. controls +(0,-1) and +(0,-1) .. (0,0);
\draw (-1,0) -- (A2); 
\draw (1,0) -- (A); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw (A2) -- (A); 
\end{tikzpicture}
\, , \qquad
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(-1,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(1,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw[redirected] (0,0) .. controls +(0,-1) and +(0,-1) .. (-1,0);
\draw[redirected] (1,0) .. controls +(0,1) and +(0,1) .. (0,0);
\draw (-1,0) -- (A); 
\draw (1,0) -- (A2); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw (A2) -- (A); 
\end{tikzpicture} \, .
\ee
We will mostly continue to simply speak of adjoints without a further attribute as we will see that in $\LG$ left and right adjoints coincide. 

Checking that the Zorro moves hold in $\LG$ with the evaluation and coevaluation maps~\eqref{TODO} and adjoints $X^\dual = X^\vee[n]$ (all to be discussed in detail in Section~\ref{sec:derivcoeval}) is no easy task. Instead of tackling it directly we will in an intermediate step first prove the Zorro moves using a different model for the unit matrix factorisation, namely the completed bar complex of the ring~$R$. As preparation we shall next discuss some background on non-commutative forms. 


\subsection{Bar complex}\label{subsec:Bar}

Let us for the moment be slightly more general and consider an arbitrary unital associative $k$-algebra~$A$. In our applications to matrix factorisations we will set $A=R=k[x]$. 

\textsl{Non-commutative $n$-forms over~$A$} are elements in 
$$
\Omega^n A = A\otimes \bar A^{\otimes n} 
$$
where $\bar A = A/k$ and in this section by ``$\otimes$'' we mean ``$\otimes_k$''. We denote the projection of $a_0\otimes a_1 \otimes \ldots \otimes a_n \in A^{\otimes n}$ to $\Omega^n A$ as $(a_0,a_1,\ldots,a_n)$. The direct sum 
$$
\Omega A = \bigoplus_{n\geq 0} \Omega^n A
$$
is a differential graded algebra $(\Omega A, d, \cdot)$ with multiplication given by
$$
(a_0,\ldots,a_m) \cdot (a_{m+1},\ldots, a_{m+n}) = \sum_{i=0}^m (-1)^{m-i}(a_0,\ldots,a_{i-1},a_i a_{i+1},a_{i+2},\ldots, a_{m+n}) 
$$
and differential
$$
d: (a_0,\ldots,a_n) \lmt (1,a_0,\ldots,a_n)
$$
where $a_i\in A$. We will write $(a_0,a_1,\ldots,a_n)$ also as $a_0da_1\ldots da_n$. 

More generally one can consider relative non-commutative forms: for a subalgebra $B\subset A$ they are elements in $\Omega_B A = \bigoplus_{n\geq 0} A\otimes_B (A/B)^{\otimes_B n}$, which has a differential graded structure analogous to $\Omega A = \Omega_k A$. We refer to the book~\cite{Loday} for further details. 

A central role is played by the \textsl{(normalised) bar complex} 
\be\label{BarComplex}
\Bar = \bigoplus_{n\geq 0} \Bar_n \, , \qquad \Bar_n = \Omega^n A \otimes A \, .
\ee
It is an $(A^{\text{op}} \otimes A)$-module via $(a\otimes a').(a_0da_1\ldots da_n\otimes a_{n+1}) = aa_0da_1\ldots da_n\otimes a_{n+1}a'$. Together with the differential $d\otimes 1_A$ (which by standard abuse of notation we usually simply write~$d$) and the product induced from $\Omega A$ and~$A$, the bar complex~$\Bar$ is a differential graded algebra $(\Bar,d,\cdot)$. While $d$ is right $A$-linear, we will also make use of the left $A$-linear operator $s$ on $\Bar$ defined by
% for the operator s see coevc3
\[
s( a_0 da_1 \cdots da_n \otimes a_{n+1} ) = (-1)^{n+1} a_0 da_1 \cdots da_n da_{n+1}\,.
\]
There is a second differential graded structure on~$\Bar$ if the algebra~$A$ is commutative. To describe it let us first recall that (still for arbitrary~$A$) the bar complex is the standard resolution 
$$
\xymatrix{%
\cdots \ar[r]^-{b'} & A \otimes \bar A^{\otimes 2} \otimes A \ar[r]^-{b'} & A \otimes \bar A \otimes A \ar[r]^-{b'} & A\otimes A \ar[r]^-{b'} & A \ar[r] & 0
}%
$$
of~$A$, where the degree-lowering differential~$b'$ is the $A$-bilinear map
$$
b': (a_0,\ldots,a_n)\otimes a_{n+1} \lmt \sum_{i=0}^{n-1} (-1)^i (a_0,\ldots,a_i a_{i+1},\ldots, a_n) \otimes a_{n+1} + (-1)^n (a_0,\ldots,a_{n-1}) \otimes a_n a_{n+1} \, . 
$$
%Equivalently, in differential form notation~$b'$ acts as
%$$
%b': da_0\ldots da_n\otimes a_{n+1} \lmt (-1)^{n-1} a_0da_1\ldots da_{n-1} \cdot a_n \otimes a_{n+1} + (-1)^n a_0 da_1\ldots da_{n-1} \otimes a_n a_{n+1} \, . 
%$$
From this it is straightforward to check that we have the identities
\be\label{b'd+db'}
b'd+db'=1_{\Bar} \, \qquad b' s + s b' = 1_{\Bar}\,.
\ee

From now on we assume that~$A$ is commutative. Recall that $(m,n)$-shuffles are permutations in
$$
\operatorname{Sh}(m,n) = \big\{ \sigma\in S_{m+n} \,|\, \sigma(1)<\sigma(2)<\ldots<\sigma(m), \, \sigma(m+1)<\sigma(m+2)<\ldots<\sigma(m+n) \big\} \, . 
$$
We use them to define the $A$-bilinear \textsl{shuffle product}~$\times$ on~$\Bar$ as
\begin{align*}
& (a_0da_1\ldots da_m \otimes a_{m+1}) \times (b_0db_1\ldots db_n \otimes b_{n+1}) \\
& \qquad 
= \sum_{\sigma \in \operatorname{Sh}(m,n)} (-1)^{|\sigma|} a_0 b_0 \, \sigma_\bullet (da_1\ldots da_m db_1 \ldots db_n) \otimes a_{m+1} b_{n+1}
\end{align*}
where $\sigma_\bullet(da_1\ldots da_j) = da_{\sigma^{-1}(1)}\ldots da_{\sigma^{-1}(j)}$. One finds that $(\Bar,b',\times)$ is a graded-commutative differential graded algebra. Note that for $\omega\in A\otimes A=\Bar_0$ it follows immediately that $\omega\times(-) = \omega\cdot(-)$. 

We now return to the $k$-algebra $A=R=k[x_1,\ldots,x_n]$. Earlier we set $\widetilde W = W\otimes 1 - 1\otimes W \in \Re$ for a potential $W\in R$, in terms of which we now define the bar complex endomorphism
$$
d_{\Bar} = b' + d\widetilde W \times (-) \, . 
$$
(\textbf{todo} Cite other places where this Bar model of the diagonal appears)

\begin{lemma}\label{lemma:barisafactorisation}
$(\Bar,d_{\Bar})$ is a linear factorisation of $\widetilde W\in \Re$. 
\end{lemma}

\begin{proof}
The bar complex $\Bar=\Bar^0 \oplus \Bar^1$ is $\nZ_2$-graded with $\Bar^i = \bigoplus_{n\in 2\nN+i}\Bar_n$. Since~$b'$ and~$\times$ are both $R$-bilinear, $d_{\Bar}$ is indeed $\Re$-linear. Furthermore, we have $b'^2=0$ and $d\widetilde W \times d\widetilde W = (dW\otimes 1) \times (dW\otimes 1) = dWdW\otimes 1 - dWdW \otimes 1 = 0$, so that for $\omega\in\Bar$ we find 
\begin{align*}
d_{\Bar}^2 (\omega) & = b'(d\widetilde W \times \omega) + d\widetilde W \times b'(\omega) \\
& = b'(d\widetilde W) \times \omega - d\widetilde W \times b'(\omega) + d\widetilde W \times b'(\omega) \\
& = \widetilde W \times \omega \\
& = \widetilde W \cdot \omega
\end{align*}
where in the second last step we used~\eqref{b'd+db'} together with $b'(\widetilde W)=0$. 
\end{proof}

If we use~$\pi$ also to denote the projection $\BarÊ\lra \Bar_0 = \Re$ composed with multiplication $\Re \lra R$, then $\pi \otimes 1_X : \Bar \otimes X \lra X$ and $1_X \otimes \pi: X \otimes \Bar \lra X$ give left and right actions of~$\Bar$ as in~\eqref{lambdarho}. These maps have homotopy inverses too and we will construct them in Section~\ref{section:pertandhtpy}. For the moment we take the fact that~$\Bar$ is another model for the unit action on matrix factorisations as motivation to discuss its relation to the Koszul matrix factorisation~$\Delta_W$. Before we do this on the level of linear factorisations we shall consider the special case $W=0$. We write $\Delta = \Delta_0 = \bigwedge( \bigoplus_{i=1}^n \Re \theta_i)$ and observe that now $(\Delta_W, d_{\Delta_W})$ reduces to the ordinary Koszul complex $(\Delta, \delta_-)$, see~\eqref{DeltaW}

There are two $\Re$-linear maps between~$\Bar$ and~$\Delta$ which will be important to us: 
\begin{align}
\Phi & : \Delta \lra \Bar \, , \qquad \theta_{i_1}\ldots \theta_{i_p} \lmt \sum_{\sigma\in S_p} (-1)^{|\sigma|} dx_{i_{\sigma(1)}} \ldots dx_{i_{\sigma(p)}} \otimes 1 \, , \label{intro_phi}\\
\Psi & : \Bar \lra \Delta \, , \qquad df_1\ldots df_p \otimes 1 \lmt \sum_{1\leq i_1<\ldots<i_p\leq n} \Big( \prod_{k=1}^p \partial_{[i_k]} f_k \Big) \, \theta_{i_1} \ldots \theta_{i_p} \, \label{intro_psi}.
\end{align}
These maps were studied in~\cite{sw0911.0917}, we only rephrase the presentation of~$\Psi$ in terms of the difference quotient operators~$\partial_{[i]}$ suitable for our setting. One easily verifies that $\Psi\Phi = 1_\Delta$. 

\begin{lemma}\label{PhiPsiDG}
Both~$\Phi$ and~$\Psi$ are maps of differential graded algebras between $(\Delta, \delta_-, \wedge)$ and $(\Bar, b', \times)$. 
\end{lemma}

\begin{proof}
We refer to~\cite{sw0911.0917} for the case of~$\Phi$; since our expression for~$\Psi$ is not manifestly the same as in loc.~cit.~we spell out the proof. Let us first show that~$\Psi$ is compatible with the differentials. On the one hand we compute $(\delta_- \Psi) (df_1\ldots df_p \otimes 1)$ to be 
\begin{align}
& \delta_ -\Big( \sum_{i_1<\ldots <i_p} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_1} \ldots \theta_{i_p} \Big) \nonumber \\
& =  \sum_{i_1<\ldots <i_p} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_p]} f_p) \cdot (x_{i_k} - x'_{i_k}) \sum_{k=1}^p (-1)^{k+1} \theta_{i_1} \ldots \widehat{\theta_{i_k}} \ldots \theta_{i_p}  \nonumber \\
& = \sum_{k=1}^p (-1)^{k+1}\sum_{i_1<\ldots <i_p} (\partial_{[i_1]} f_1) \ldots ({}^{t_1\ldots t_{i_{k-1}}} f_k - {}^{t_1\ldots t_{i_{k}}} f_k) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_1} \ldots \widehat{\theta_{i_k}} \ldots \theta_{i_p}  \nonumber \\
& = \sum_{2\leq i_2<\ldots< i_p} (f_1 - {}^{t_1\ldots t_{i_{2}-1}} f_1) (\partial_{[i_2]} f_2) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_2} \ldots \theta_{i_p} \nonumber \\
& \qquad + \sum_{k=2}^{p-1} (-1)^{k+1}\sum_{i_1 < \ldots <i_p} (\partial_{[i_1]} f_1) \ldots ({}^{t_1\ldots t_{i_{k-1}}} f_k - {}^{t_1 \ldots t_{i_{k+1}-1}} f_k) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_1} \ldots \widehat{\theta_{i_k}} \ldots \theta_{i_p}  \nonumber \\
& \qquad + (-1)^{p+1} \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) ({}^{t_1\ldots t_{i_{p-1}}} f_p - {}^{t_1\ldots t_n} f_p)  \, \theta_{i_1} \ldots \theta_{i_{p-1}} \nonumber \\
& = \sum_{2\leq t_2<\ldots <i_p} f_1 (\partial_{[i_2]} f_2) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_2} \ldots \theta_{i_p} \nonumber \\
& \qquad + (-1)^{p} \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p  \, \theta_{i_1} \ldots \theta_{i_{p-1}}  \label{delPsi} 
\end{align}
while on the other hand $(\Psi b') (df_1\ldots df_p \otimes 1)$ equals
\begin{align*}
& \Psi \Big( f_1 df_2 \ldots df_p \otimes 1 + \sum_{k=1}^{p-1} (-1)^k df_1 \ldots d(f_k f_{k+1}) \ldots df_p \otimes 1 + (-1)^p df_1 \ldots df_{p-1} \otimes f_p \Big) \\
& = \sum_{i_1<\ldots< i_{p-1}} f_1 (\partial_{[i_1]} f_2) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad + \sum_{k=1}^{p-1} (-1)^k \sum_{i_1<\ldots< i_{p-1}} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_k]} (f_k f_{k+1}) )\ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad + (-1)^p \sum_{i_1<\ldots< i_{p-1}} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& = \sum_{2\leq i_1<\ldots< i_{p-1}} f_1 (\partial_{[i_1]} f_2) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\ 
& \qquad + \sum_{2\leq i_2 \ldots< i_{p-1}} f_1 (\partial_{[1]} f_2) (\partial_{[i_2]} f_3) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\ 
& \qquad + \sum_{k=1}^{p-1} (-1)^k \sum_{i_1<\ldots< i_{p-1}} (\partial_{[i_1]} f_1) \ldots \big\{ ({}^{t_1\ldots t_{i_k -1}}f_k)(\partial_{[i_k]} f_{k+1}) \\
& \qquad\quad + (\partial_{[i_k]} f_k) ({}^{t_1\ldots t_{i_k}} f_{k+1}) \big\} \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad + (-1)^p \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad\quad + (-1)^p \sum_{i_1<\ldots< i_{p-2}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& = \sum_{2\leq i_1<\ldots< i_{p-1}} f_1 (\partial_{[i_1]} f_2) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\ 
& \qquad + (-1)^p \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} 
\end{align*}
which agrees with~\eqref{delPsi}. 

To establish compatibility with the products we compute 
\begin{align*}
& \Psi( df_1\ldots df_p \otimes 1) \wedge \Psi( df_{p+1}\ldots df_{p+q} \otimes 1) \\ 
=\, & \Big\{ \sum_{i_1<\ldots< i_p} \Big( \prod_{k=1}^p \partial_{[i_k]} f_k \Big) \theta_{i_1} \ldots \theta_{i_p}\Big\} 
\wedge 
\Big\{ \sum_{i_{p+1}<\ldots< i_{p+q}} \Big( \prod_{k=p+1}^{p+q} \partial_{[i_k]} f_k \Big) \theta_{i_{p+1}} \ldots \theta_{i_{p+q}} \Big\} \\
= \, & \sum_{i_1<\ldots< i_p} \sum_{i_{p+1}<\ldots< i_{p+q}} \Big( \prod_{k=1}^{p+q} \partial_{[i_k]} f_k \Big) \theta_{i_{1}} \ldots \theta_{i_{p+q}} \\
= \, & \sum_{i_1<\ldots< i_{p+q}} \sum_{\sigma\in\operatorname{Sh}(p,q)} (-1)^{|\sigma|} \Big( \prod_{k=1}^{p+q} \partial_{[i_{\sigma(k)}]} f_k \Big) \theta_{i_{1}} \ldots \theta_{i_{p+q}} \\
= \, & \Psi \big((df_1\ldots df_p \otimes 1) \times( df_{p+1}\ldots df_{p+q} \otimes 1) \big)
\end{align*}
where in the third step the anti-commutativity of the~$\theta_i$ allowed us to sum over the longer sequences $i_1<\ldots< i_{p+q}$ by introducing an additional sum over shuffles. 
\end{proof}

Now we come back to consider any $W\in R$. The map~$\Psi$ continues to be a good map on the level of linear factorisations: 
\begin{lemma}\label{PsiHF}
$\Psi: (\Bar, d_\Bar) \lra (\Delta_W, d_{\Delta_W})$ is a morphism in $\HF(\Re,\widetilde W)$. 
\end{lemma}

\begin{proof}
We need to show $d_{\Delta_W} \Psi = \Psi d_\Bar$. But since $d_{\Delta_W} = \delta_+ + \delta_-$ and $d_\Bar = b' + d\widetilde W \times (-)$ by Lemma~\eqref{PhiPsiDG} what remains to be checked is $\delta_+ \Psi = \Psi (d\widetilde W\times (-))$. This can be done: 
$$
\delta_+ \Psi = \Big( \sum_{i=1}^n \partial_{[i]} W \cdot \theta_i^* \Big) \wedge \Psi(-) = \Psi(dW\otimes 1) \wedge \Psi(-) = \Psi (d\widetilde W\times (-)) \, . 
$$
\end{proof}


%\begin{remark}
%Instead of the bar complex $\Bar = \bigoplus_{n\geq 0} \Bar_n$ one can also consider its completed version
%$$
%\cBar = \prod_{n\geq 0} \Bar_n \, .
%$$
%It has differential graded structures $(\cBar,d,\cdot)$ and $(\cBar,b',\times)$ analogous to~$\Bar$, and the maps~$\Phi$ and~$\Psi$ lift to maps to and from the completed bar complex~$\cBar$ with the same properties as in Lemmas~\ref{PhiPsiDG} and~\ref{PsiHF}. 
%\end{remark}

\subsection{Perturbation}

A crucial role will be played by the homological perturbation lemma, which we will use to promote homotopy equivalences of complexes (arising from the bar and Koszul resolutions of the diagonal) to homotopy equivalences of associated matrix factorisations. More importantly, the perturbation lemma provides explicit homotopy inverses in terms of Atiyah classes.

Let $R$ be a ring and $W \in R$. An $R$-linear \textsl{deformation retract datum} is a diagram
\begin{equation}\label{eq:perturbeddiagr1}
\xymatrix@C+2pc{
(X,d_X) \ar@<-1ex>[r]_-{\sigma} & (Y,d_Y) \ar@<-1ex>[l]_-{\pi}
}%
\!\!\!\xymatrix{%
{}\ar@(ur,dr)[]^{h}
}%
\end{equation}
in which $(X,d_X)$ and $(Y,d_Y)$ are linear factorisations of $W$, $\pi, \sigma$ are morphisms of linear factorisations and $h: Y \lto Y$ is a degree one $R$-linear map such that
$$
\pi \sigma = 1 \, , \qquad
\sigma \pi = 1 + d_Yh + hd_Y \, .
$$
A degree one morphism $\delta: Y \lto Y$ is a \textsl{small perturbation} of the deformation retract datum if $1_M - \delta h$ is an isomorphism of $R$-modules. In this case we define
\[
\tau = (1- \delta h)^{-1} \delta
\]
and consider the new ``perturbed'' diagram
\begin{equation}\label{eq:perturbeddiagr}
\xymatrix@C+2pc{
(X,d_{X,\infty}) \ar@<-1ex>[r]_-{\sigma_\infty} & (Y,d_Y+\delta) \ar@<-1ex>[l]_-{\pi_\infty}
}%
\!\!\!\xymatrix{%
{}\ar@(ur,dr)[]^{h_\infty}
}%
\end{equation}
where
\begin{align*}
\sigma_\infty &= \sigma + h\tau\sigma \,, & h_\infty &= h + h \tau h\,,\\
\pi_\infty &= \pi + \pi \tau h \, , & d_{X,\infty} &= d_X + \pi \tau \sigma\,.
\end{align*}

\begin{proposition}\label{prop:pertlemma} Suppose that $h \sigma = 0, \pi h = 0$ and $h^2 = 0$. If $\delta$ is a small perturbation of (\ref{eq:perturbeddiagr1}) such that $(d_Y + \delta)^2 = W' \cdot 1_M$ for some $W' \in R$ then (\ref{eq:perturbeddiagr}) is a deformation retract datum of linear factorisations of $W'$ over $R$.
\end{proposition}
\begin{proof}
TODO: Just reference Crainic.
\end{proof}

In the cases of interest to us the sum $\sum_{m \ge 0} (\delta h)^m$ converges, so that $\tau = \sum_{m \ge 0} (\delta h)^m \delta$ and
\[
\sigma_\infty = \sigma + \sum_{m \ge 0} h(\delta h)^m \delta \sigma = \sum_{m \ge 0} (h \delta)^m \sigma\,.
\]

\section{Atiyah Classes}\label{section:atiyahclasses}
% see assat, the onct series

As explained in the introduction, the structure of the bicategory $\LG$ can be understood in terms of associative Atiyah classes. In this section we develop the basic theory of these operators, beginning with the simplest definition (which involves a choice of basis) and then afterwards developing the more abstract general theory in the setting of noncommutative form-valued connections. For this paper the simpler definition is sufficient, since we will only use the Atiyah class to construct explicit chain level representatives of morphisms which we already know to be well-defined up to homotopy, and in this situation it is natural to make some auxiliary choices. In any case, we develop the general theory in order to have a more solid foundation for the subject of associative Atiyah classes.

Let $k$ be a ring, $R$ a $k$-algebra, and set $R^e = R_1 \otimes_k R_2$ where $R_i = R$ for $i = 1,2$. We define  the operators $s,d$ on the Bar complex $\Bar = \Bar_{R/k}$ as in Section \ref{subsec:Bar} and recall that $\Bar$ is equipped with an $R^e$-bimodule structure by left and right multiplication. Let $(X,D)$ be a pair consisting of a $\mathbb{Z}_2$-graded free $R^e$-module $X$ and an odd $R^e$-linear operator $D$ on $X$ (for the moment we do not require any condition on $D^2$). By default $\otimes$ means $\otimes_{R^e}$.

Given a homogeneous basis $\{ e_i \}_{i \in I}$ for $X$ we can extend $d$ and $s$ to operators
\begin{align*}
d&: X \otimes \Bar \lto X \otimes \Bar, &\qquad d( e_i \otimes \omega ) = (-1)^{|e_i|} e_i \otimes d \omega\,,\\
s&: X \otimes \Bar \lto X \otimes \Bar, &\qquad s( e_i \otimes \omega ) = (-1)^{|e_i|} e_i \otimes s \omega\,.
\end{align*}

\begin{definition}
The \emph{associative Atiyah classes} of $(X,D)$ are operators on $X \otimes \Bar$ defined by
\begin{align*}
\At_{R^e/R_2}(X) &= [d, D] = d D + D d\,,\\
\At_{R^e/R_1}(X) &= [s, D] = s D + D s\,.
\end{align*}
\end{definition}

One can easily check that for $\omega \in \Bar$
\[
\At_{R^e/R_2}(X)( e_i \otimes \omega ) = \sum_j (-1)^{|e_j|} e_j \otimes d( D_{ji} ) \omega
\]
and more generally for $m \ge 1$
\begin{equation}\label{eq:powerofatiyah}
\At_{R^e/R_2}(X)^m( e_i \otimes \omega ) = \sum_{j_1,\ldots,j_m} (-1)^{m|e_i| + \binom{m+1}{2}} e_{j_m} \otimes d( D_{j_m, j_{m-1}} ) \cdots d(D_{j_2,j_1})d( D_{j_1 i} ) \omega\,.
\end{equation}
% for signs see for example shati
There are similar formulas for $\At_{R^e/R_1}$. We call these \emph{associative} Atiyah classes to distinguish them from the more standard Atiyah classes defined using commutative differential forms, but since the latter do not appear in this paper (with the exception of Appendix \ref{section:dualityadjointop}) we will omit the qualifier ``associative''. Without conditions on $D^2$ there is no interpretation of $\At_{R^e/R_2}$ as a cohomology class, so we should perhaps refer to Atiyah \emph{operators}, but we persist with the above terminology.

To discuss the linearity we need to be clear that $X \otimes \Bar$ is made into a right $R^e$-module via the right action of $R^e$ on $\Bar$ by multiplication. It is then apparent from \eqref{eq:powerofatiyah} that both $\At_{R^e/R_2}(X)$ and $\At_{R^e/R_1}(X)$ are right $R^e$-linear. The subscripts on the Atiyah classes arise because we think of $d$ (resp. $s$) as differentiating in the $R_1$-directions (resp. $R_2$-directions).

There are two more variants of the Atiyah class that differ from the above only in the way in which we order the noncommutative differential forms. We can extend $s,d$ to operators on $\Bar \otimes X$ (using the right $R^e$-multiplication on $\Bar$ to form the tensor product) as above, but now without Koszul signs, and define operators on this tensor product by
\begin{equation}\label{eq:leftatiyahclasses}
\lAt_{R^e/R_2}(X) = [d, D], \qquad \lAt_{R^e/R_1}(X) = [s,D]\,.
\end{equation}
The difference from the other Atiyah classes appears when we exponentiate
\begin{equation}\label{eq:leftatiyahexp}
\lAt_{R^e/R_2}(X)^m( \omega \otimes e_i ) = \sum_{j_1,\ldots,j_m} \omega d( D_{j_1,i} ) d(D_{j_2,j_1}) \cdots d(D_{j_m,j_{m-1}}) \otimes e_{j_m}\,.
\end{equation}
From this expression it is clear that $\lAt_{R^e/R_2}$ and $\lAt_{R^e/R_1}$ are both left $R^e$-linear, using the action of left multiplication on $\Bar$ in $\Bar \otimes X$.

In addition to these four distinct kinds of Atiyah classes, we will sometimes need purely cosmetic variants where we switch the order of elements of $X$ and $\Bar$ in the tensors. This creates an awkward situation with the notation, since we want elements of $R^e$ traversing the tensor product to act on the same side of $\Bar$ as before. The clearest way to indicate this is to use the map
\begin{equation}\label{eq:attau}
\reprod: R^e \otimes_k R^e \lto R^e \otimes_k R^e, \qquad \reprod ( a \otimes a' ) = aa' \otimes 1
\end{equation}
so that in $\reprod_*( \Bar ) \otimes X$ we have $\omega \otimes a x$ = $a \omega \otimes x$. If we extend $d$ and $s$ to operators on $\reprod_*( \Bar ) \otimes X$ as before, then we define operators on this tensor product by
\[
\Atlarrow_{R^e/R_2}(X) = [ d, D ], \qquad \Atlarrow_{R^e/R_1}(X) = [s, D]\,.
\]
There is a commutative diagram
\[
\xymatrix@C+2pc@R+1pc{
X \otimes \Bar \ar[d]_{\At_{R^e/R_2}(X)^m} \ar[r]^-{\cong} & \reprod_*( \Bar ) \otimes X \ar[d]^{\Atlarrow_{R^e/R_2}(X)^m}\\
X \otimes \Bar \ar[r]_-{\cong} & \reprod_*( \Bar ) \otimes X
}
\]
in which the rows are graded twist maps (with Koszul signs). We adopt similar conventions for the other Atiyah classes.

\newpage

\subsection{Properties}

With the above notation, let $(X,d_X)$ and $(Y,d_Y)$ be $\mathbb{Z}_2$-graded free $R^e$-modules equipped with odd $R^e$-linear differentials (again, no condition on $d_X^2$ or $d_Y^2$) and respective homogeneous bases $\{ e_i \}_{i \in I}$ and $\{ f_j \}_{j \in J}$. Throughout all Atiyah classes are of the same ``type'' and we write $\At$ for $\At_{R^e/R_2}$. 

Giving $X \otimes Y$ the differential $d_{X \otimes Y} = d_X \otimes 1 + 1 \otimes d_Y$ and the basis $\{ e_i \otimes f_j \}_{i \in I, j \in J}$ we have
\begin{align*}
\At(X) &\in \End( X \otimes \Bar ),\\
\Atlarrow(Y) &\in \End( \reprod_*(\Bar) \otimes Y ),\\
\At(X \otimes Y) &\in \End( X \otimes Y \otimes \Bar )\,.
\end{align*}
An important property of the commutative Atiyah class is that the class of $X \otimes Y$ can be expressed in terms of the classes of $X$ and $Y$. The analogue for associative Atiyah classes involves the shuffle product, which we make into an $R^e$-linear operation
\begin{equation}\label{eq:shuffle_opat}
\xymatrix@C+2pc{
X \otimes \reprod_*(\Bar) \otimes \reprod_*(\Bar) \otimes Y \ar[r]^-{1 \otimes \times \otimes 1} & X \otimes \reprod_*(\Bar) \otimes Y \ar[r]^-{\cong} & X \otimes Y \otimes \Bar
}
\end{equation}
where the last map is the graded twist on the second two components. The following lemma is sufficient for our purposes, but it would be desirable to have a natural, basis-free analogue.

\begin{lemma}\label{lemma:atshufat} For $m \ge 0$ we have
\be\label{eq:atshufat}
\At(X \otimes Y)^m( e_i \otimes f_j ) = \sum_{p+q = m} \At(X)^p(e_i) \times \Atlarrow(Y)^q(f_j)
\ee
where on the right hand side we use the operation \eqref{eq:shuffle_opat}. 
\end{lemma}
\begin{proof}
We have
\[
\At(X \otimes Y)(e_i \otimes f_j) = \sum_{i_1} (-1)^{|e_{i_1}| + |f_j|} e_{i_1} \otimes f_j \otimes d( d_{X,i_1,i}) + \sum_{j_1} (-1)^{|f_{j_1}|} e_i \otimes f_{j_1} \otimes d( d_{Y, j_1,j} )\,.
\]
Iterating, we see that $\At(X \otimes Y)^m(e_i \otimes f_j)$ is a sum over all indices of terms
\[
e_{i_{m-p}} \otimes f_{j_p} \otimes \sigma_\bullet( \underbrace{d(d_{X,i_{m-p}i_{m-p-1}}), \ldots, d(d_{X,i_1i})}_{m-p}, \underbrace{d(d_{Y,j_pj_{p-1}}), \ldots, d(d_{Y,j_1j})}_p )
\]
where $\sigma$ is a $(m-p,p)$ shuffle and the sign that is attached to such a term is $(-1)^q$ where
\[
q = |e_{i_{m-p}}| + \cdots + |e_{i_1}| + |f_{j_p}| + \cdots + |f_{j_1}| + (m-p)|f_{j_p}| + |\sigma|\,.
\]
But considering \eqref{eq:powerofatiyah} it is straightforward to check that the right hand side of \eqref{eq:atshufat} is a sum over the same collection of terms, and we leave it to the reader to verify that the signs match.
\end{proof}

\subsection{Connections}

Let $k$ be a ring and $A$ a $k$-algebra, $\Omega A = \Omega_k A$ the differential graded algebra $(\Omega A, d, \cdot)$ of noncommutative differential forms explained in Section \ref{??}. A \emph{connection} on a $\mathbb{Z}_2$-graded $A$-module $X$ is a $k$-linear map
\[
\nabla: X \lto X \otimes_A \Omega^1 A\,,
\]
which sends $X^i$ into $X^i \otimes_A \Omega^1_A$ and satisfies the graded Leibniz rule for $x \in X, a \in A$
\[
\nabla( x a ) = \nabla( x ) a + (-1)^{|x|} x da\,.
\]
Notice that by left and right multiplication $\Omega A$ is an $A$-bimodule, and so $X \otimes_A \Omega^1 A$ is naturally an $A$-bimodule and in particular for $W \in A$ it makes sense to consider the operator $[W, -]$ on $X \otimes_A \Omega^1 A$ which sends an element $\xi$ to $W \xi - \xi W$.

\begin{lemma} Let $(X,D)$ be a linear factorisation of $W \in A$. If $\nabla$ is a connection on $X$ then
\[
[ \nabla, D ] = \nabla D + D \nabla: X \lto X \otimes_A \Omega^1 A
\]
is right $A$-linear and satisfies
\[
[ D, [ \nabla, D ] ] = [ W, - ] \nabla - (-1)^F ( dW \cdot - )\,.
\]
\end{lemma}

\begin{lemma} If in the previous lemma $W \in k$ and 
\end{lemma}

\section{Perturbation to the stabilised diagonal}\label{section:pertandhtpy}

The fundamental technical results in this paper are constructions, using the perturbation lemma, of explicit homotopy inverses to morphisms involving the stabilised diagonal. Generically the results are geometric series in the associative Atiyah classes of the previous section. To give a specific example, recall that as part of the structure of the bicategory $\LG$ we have specified for any $1$-morphism $X \in \LG(W,V)$ a pair of isomorphisms
\begin{equation}\label{eq:pertandhtpy1}
\lambda: \Delta_V \otimes X \lto X, \qquad \rho: X \otimes \Delta_W \lto X
\end{equation}
which we call the \textsl{unit actions}. A representing chain map for the inverses of these morphisms is not specified as part of the defining data of the bicategory, and finding such representatives is nontrivial. It turns out to be difficult to invert $\rho$ directly, so we proceed by identifying $\rho$ as the shadow of a similar canonical map $\rho'$ on the Bar model for the diagonal via a commutative diagram
\begin{equation}\label{eq:pertdia1}
\xymatrix{
X \,\widehat{\otimes}\, \Bar \ar[dr]_-{\rho'}\ar[rr]^{1 \otimes \Psi} & & X \otimes \Delta_W \ar[dl]^-{\rho}\\
& X
}
\end{equation}
where $\Psi$ is the canonical map given in (\ref{intro_psi}). Roughly speaking the inverse of $\rho'$ is the geometric series in powers of the Atiyah class of $X$ and by postcomposing with $\Psi$ we obtain the desired inverse to $\rho$. A completion of $X \otimes \Bar$ is used in order to guarantee that the geometric series converges. We return to this example in Proposition \ref{prop:inverses_unitact} below.

Another important example is the following: given an object $(k[x],W) \in \LG$ and a $1$-morphism $X \in \LG(W,W)$ we can consider the problem of lifting a $k[x]$-bilinear morphism of linear factorisations $X \lto k[x]$ to a morphism $X \lto \Delta_W$ along the stabilisation map $\pi_{\Delta}: \Delta_W \lto k[x]$
\[
\xymatrix{
X \ar[dr] \ar@{.>}[rr] & & \Delta_W \ar[dl]^-{\pi_{\Delta}} \\
& k[x]\,.
}
\]
The solution to this lifting problem is given in Proposition \ref{prop:liftingresult}. In order to address these examples and others at the same time, we work in the following general setting: $k$ is a ring, $R, S$ are $k$-algebras and $R^e = R_1 \otimes_k R_2$ where $R_i = R$ for $i = 1,2$. We assume
\[
X \in \HMF(S \otimes_k \Re, U)
\]
is given together with a homogeneous basis $\{ e_i \}_{i \in I}$. The reader should keep in mind the special case where $S = k[z], R = k[x]$ and $X$ the extension of scalars from $S \otimes_k R$ to $S \otimes_k \Re$ of some factorisation of $V - W$ over $k[x,z]$. Let $D$ denote the differential on $X$ and unless specified otherwise in this section $\otimes$ denotes the tensor product $\otimes_{\Re}$. Consider the module
\[
X \,\widehat{\otimes}\, \Bar := \prod_{m \ge 0} X \otimes \Bar_m
\]
with the $\mathbb{Z}_2$-grading
\[
\big( X \,\widehat{\otimes}\, \Bar \big)^i = \left( \prod_{m \in \mathbb{Z}} X^i \otimes \Bar_{2m} \right) \oplus \left( \prod_{m \in \mathbb{Z}} X^{i+1} \otimes \Bar_{2m+1} \right) . 
\]
It is sometimes helpful to view $X \,\widehat{\otimes}\, \Bar$ as the inverse limit of the system
\[
\cdots \lto X \otimes \Bar/\Bar_{\ge 2} \lto X \otimes \Bar/\Bar_{\ge 1}
\]
where $\Bar_{\ge m} = \bigoplus_{i \ge m} \Bar_i \subseteq \Bar$ and the maps are the obvious quotients $\Bar/\Bar_{\ge m+1} \lto \Bar/\Bar_{\ge m}$. Since $\Bar$ is an $R^e$-bimodule via left and right multiplication there are natural left and right $R^e$-actions on $X \,\widehat{\otimes}\, \Bar$. Since the left and right actions of $R_2$ on $\Bar$ agree, this amounts to an $R_2$ action on $X \,\widehat{\otimes}\, \Bar$ together with the structure of an $R_1$-bimodule. There is of course an $S$-module structure as well, which is preserved by all maps in this section and which we will henceforth not emphasise.

Let $W \in R$ be arbitrary and set $\widetilde{W} = W \otimes 1 - 1 \otimes W \in \Re$. Our first observation is that $X \,\widehat{\otimes}\, \Bar$ can be equipped as a linear factorisation of $U + \widetilde{W}$. One checks that there are well-defined operators
\begin{align*}
D(x_0, x_1, \ldots) &= (D(x_0), D(x_1), \ldots) \, , \\
b'(x_0, x_1, \ldots) &= (b'(x_1),b'(x_2),\ldots) \, , \\
d(x_0,x_1,\ldots) &= (0, d(x_0), d(x_1),\ldots) \, , \\
s(x_0,x_1,\ldots) &= (0, s(x_0), s(x_1), \ldots) \, , \\
d \widetilde{W} \times (x_0,x_1,\ldots) &= (0, d \widetilde{W} \times x_0, d \widetilde{W} \times x_1, \ldots)
\end{align*}
on $X \,\widehat{\otimes}\, \Bar$, where $d$ and $s$ are extended to $X \otimes \Bar$ as in Section \ref{section:atiyahclasses} using the chosen basis. 

For the next result assume that $U + \widetilde{W}$ belongs to the image of $S \otimes_k R_i$ in $S \otimes_k R^e$ for some $i = 1,2$ so that it makes sense to talk about linear factorisations of $U + \widetilde{W}$ over $S \otimes_k R_i$.

\begin{lemma} $( X \, \widehat{\otimes}_R\, \Bar, d_X + b' + d\widetilde{W} \times (-) )$ is a linear factorisation of $U + \widetilde{W}$.
\end{lemma}
\begin{proof}
This can be checked on the inverse system, where it follows from Lemma \ref{lemma:barisafactorisation}.
\end{proof}

There is a morphism of linear factorisations
\begin{equation}\label{eq:pibar}
\pi: X \, \widehat{\otimes}\, \Bar = \prod_{m \ge 0} X \otimes \Bar_m \lto X \otimes \Bar_0 \lto X \otimes R
\end{equation}
where the first map is the projection and the second is the product $\Re \lto R$. Next we show using the perturbation lemma that this map is a homotopy equivalence, and we give an explicit homotopy inverse in terms of Atiyah classes. In fact we give two homotopy inverses, one which is $R_2$-linear and the other left $R_1$-linear. We begin with the deformation retract arising from the fact that~$s$ and~$d$ are contracting homotopies for the differential $b'$.

All deformation retract datums in the following are at least $S$-linear.

\begin{lemma}\label{lemma:firstdefo} There are deformation retract data of $\mathbb{Z}_2$-graded complexes
\begin{equation}\label{eq:firstdefo1}
\xymatrix@C+2pc{
(X \otimes R, 0) \ar@<-1ex>[r]_-{\sigma_d} & (X \, \widehat{\otimes} \, \Bar, b') \ar@<-1ex>[l]_-{\pi}
}%
\!\!\!\xymatrix{%
{}\ar@(ur,dr)[]^{-d}
}%
\end{equation}
and
\begin{equation}\label{eq:firstdefo2}
\xymatrix@C+2pc{
(X \otimes R, 0) \ar@<-1ex>[r]_-{\sigma_s} & (X \, \widehat{\otimes} \, \Bar, b') \ar@<-1ex>[l]_-{\pi}
}%
\!\!\!\xymatrix{%
{}\ar@(ur,dr)[]^{-s}
}%
\end{equation}
where
\begin{equation}\label{eq:sigmsandd}
\sigma_d(e_i \otimes a ) = e_i \otimes (1 \otimes a), \qquad \sigma_s(e_i \otimes a ) = e_i \otimes (a \otimes 1)\,.
\end{equation}
Moreover, in \eqref{eq:firstdefo1} every map is $R_2$-linear and in \eqref{eq:firstdefo2} every map is left $R_1$-linear.
\end{lemma}
\begin{proof}
The required identities $b' d + d b' = 1 - \sigma \pi$ and $b' s + s b' = 1 - \sigma \pi$ are given in (\ref{b'd+db'}).
\end{proof}

\begin{lemma}\label{lemma:smallpertde} The perturbation $\delta = D + d\widetilde{W} \times (-)$ is small on $X\,\widehat{\otimes} \, \Bar$ with respect to both of the above deformation retract data. That is, both $1 + \delta d$ and $1 + \delta s$ are invertible.
\end{lemma}
\begin{proof}
Let $h$ be $-d$ or $-s$. Because we are working with $\prod_{m \ge 0} X \otimes \Bar_m$ it is clear that the sum $\sum_{m \ge 0} (\delta h)^m$ converges as an operator on $X \, \widehat{\otimes}\, \Bar$ and this gives the desired inverse to $1 - \delta h$.
\end{proof}

In the notation of Section \ref{section:atiyahclasses} we can describe the homotopy inverses of $\pi$ using Atiyah classes.
%The $R_2$-linear inverse to $\pi$ is given in terms of the Atiyah class $\At_{R^e/R_2}(X) = [d,d_X]$.

\begin{proposition}\label{prop:finalpertdefo} The morphism $\pi$ is an $R_2$-linear homotopy equivalence with inverse
\[
\sigma_\infty = \sum_{m \ge 0} (-1)^m \At_{R^e/R_2}(X)^m \sigma_d\,.
\]
More precisely, there is an $R_2$-linear deformation retract datum
\[
\xymatrix@C+2pc{
(X \otimes R, D \otimes 1) \ar@<-1ex>[r]_-{\sigma_\infty} & (X \, \widehat{\otimes} \, \Bar, D + b' + d\widetilde{W} \times (-)) \ar@<-1ex>[l]_-{\pi}
}\,.
\]
\end{proposition}
\begin{proof}
It follows from the perturbation lemma (Proposition \ref{prop:pertlemma}) with Lemmas~\ref{lemma:firstdefo} and~\ref{lemma:smallpertde} that
\[
\xymatrix@C+2pc{
(X \otimes R, b_\infty) \ar@<-1ex>[r]_-{\sigma_\infty} & (X \, \widehat{\otimes} \, \Bar, D + b' + d\widetilde{W} \times (-)) \ar@<-1ex>[l]_-{\pi_\infty}
}
\]
is a deformation retract datum, where with $\tau = \sum_{m \ge 0} (-1)^m (\delta d) \delta$ we have (writing $\sigma = \sigma_d$)
\begin{align*}
\sigma_\infty = \sum_{m \ge 0} (-1)^m (d \delta)^m \sigma \, , \qquad
\pi_\infty = \pi + \pi \tau h\, , \qquad
b_\infty = \pi \tau \sigma\,.
\end{align*}
Clearly $\pi \delta = \pi D$ and $\pi$ vanishes on $\delta d$, so $\pi \tau = \pi D$. It follows that $b_\infty = D \otimes 1$ and $\pi_\infty = \pi - \pi D d = \pi$. So there is a deformation retract datum of the stated form, where we may use $d^2 = 0$ and $d \sigma = 0$ to write
\[
\sigma_\infty = \sum_{m \ge 0} (-1)^m \big[ d, \delta \big]^m \sigma = \sum_{m \ge 0} (-1)^m [d, D + d\widetilde{W} \times (-)]^m \sigma\,.
\]
Expanding this yields $\sum_{m \ge 0} [d, D]^m \sigma$ plus terms involving factors of the form
\begin{equation}\label{eq:finalpertdefo2}
[d, d\widetilde{W} \times (-)] [d,D]^i \sigma
\end{equation}
for some $i \ge 0$. Applying $[d,D]^i \sigma$ to an element of $X \otimes R$ produces a tensor whose form component is of the type $da_0 \ldots da_n \otimes a_{n+1}$. By Lemma \ref{lemma:shortobs} below applying $[d, d\widetilde{W} \times (-)]$ to such a tensor yields zero, so all terms (\ref{eq:finalpertdefo2}) must vanish and $\sigma_\infty$ is as given in the statement of the proposition.
\end{proof}

\begin{lemma}\label{lemma:shortobs} On $\Bar$ we have $[d, d\widetilde{W} \times (-)] = d \widetilde{W} \cdot d(-)$.
\end{lemma}
\begin{proof}
\textbf{todo}
\end{proof}

%The left $R$-linear inverse to $\pi$ is given in terms of the Atiyah class $\At_{R^e/R_1}(X) = [s,d_X]$.

\begin{proposition}\label{prop:finalpertdefo} The morphism $\pi$ is a left $R_1$-linear homotopy equivalence with inverse
\[
\sigma_\infty = \sum_{m \ge 0} (-1)^m \At_{R^e/R_1}(X)^m \sigma_s\,.
\]
More precisely, there is a left $R_1$-linear deformation retract datum
\[
\xymatrix@C+2pc{
(X \otimes R, D \otimes 1) \ar@<-1ex>[r]_-{\sigma_\infty} & (X \, \widehat{\otimes} \, \Bar, D + b' + d\widetilde{W} \times (-)) \ar@<-1ex>[l]_-{\pi}
}\,.
\]
\end{proposition}
\begin{proof}
\textbf{todo}.
\end{proof}

Now we turn to the Koszul stabilisation of the diagonal. Assume that $R = k[x_1,\ldots,x_n]$ with $k$ noetherian and let $(\Delta, d_{\Delta})$ be the finite rank matrix factorisation of $\widetilde{W}$ given in Section~\ref{subsec:bicatLG} where $d_{\Delta} = \delta_{+} + \delta_{-}$. Denoting by $\pi_{\Delta}: \Delta \lto R$ the stabilisation morphism of \eqref{DeltaWstabmap} there is a morphism
\begin{equation}\label{eq:koszulpi}
\pi_{\Delta} = 1 \otimes \pi_{\Delta}: X \otimes \Delta \lto X \otimes R\,.
\end{equation}
This is compatible with the map $\pi$ of \eqref{eq:pibar} in the sense that there is a commutative diagram
\[
\xymatrix{
X \,\widehat{\otimes}\, \Bar \ar[dr]_-{\pi}\ar[rr]^{1 \otimes \Psi} & & X \otimes \Delta \ar[dl]^-{\pi_\Delta}\\
& X \otimes R
}
\]
in which every side is a homotopy equivalence: 

\begin{lemma}\label{lemma:koszulstab1} The morphism $\pi_\Delta$ is both an $R_2$-linear homotopy equivalence and a left $R_1$-linear homotopy equivalence.
\end{lemma}
\begin{proof}
There is a split exact sequence
\[
0 \lto \Delta_n \lto \cdots \lto \Delta_0 \lto R \lto 0
\]
and the splittings provide the $R_2$-linear (resp. left $R_1$-linear) $\sigma: R \lto \Delta$ and homotopy $h$ making
\[
\xymatrix@C+2pc{
(X \otimes R, 0) \ar@<-1ex>[r]_-{\sigma} & (X \otimes \Delta, 1 \otimes \delta_{-}) \ar@<-1ex>[l]_-{\pi_\Delta}
}%
\!\!\!\xymatrix{%
{}\ar@(ur,dr)[]^{-h}
}%
\]
into an $R_2$-linear deformation retract datum (resp. left $R_1$-linear). Moreover $\delta = D \otimes 1 + 1 \otimes \delta_{+}$ is a small perturbation and the perturbation lemma shows that $\pi_\Delta$ is a homotopy equivalence.
\end{proof}

\begin{corollary}\label{corollary:koszulstab2} An $R_2$-linear homotopy inverse to $\pi_\Delta$ is given by
\begin{equation}
\pi^{-1}_d = \sum_{m \ge 0} (-1)^m \Psi \At_{R^e/R_2}(X)^m \sigma_d\,,
\end{equation}
while a left $R_1$-linear homotopy inverse is given by
\begin{equation}
\pi^{-1}_s = \sum_{m \ge 0} (-1)^m \Psi \At_{R^e/R_1}(X)^m \sigma_s\,.
\end{equation}
where $\sigma_s, \sigma_d$ are as in \eqref{eq:sigmsandd}.
\end{corollary}

Equipped with these formulas we return to the lifting problem discussed at the beginning of this section. We will show that, given a finite rank matrix factorisation $Y$ of $\widetilde{W}$ over $R^e$, there is a $k$-linear homotopy equivalence
\[
\Hom_{R^e}(Y, \Delta) \lto \Hom_{R^e}(Y, R)\,.
\]
In particular given an $R^e$-linear morphism of linear factorisations $\varphi: Y \lto R$ there is a unique (up to homotopy) $R^e$-linear morphism $\varphi_{\textup{lift}}$ making the following diagram commute up to homotopy
\[
\xymatrix{
Y \ar[dr]_-{\varphi} \ar@{.>}[rr]^-{\varphi_{\textup{lift}}} & & \Delta \ar[dl]^-{\pi_\Delta} \\
& R
}\,.
\]
To produce a formula for $\varphi_{\textup{lift}}$ we choose a homogeneous basis $\{ e_i \}_{i \in I}$ for $Y$.

\begin{proposition}\label{prop:liftingresult} In the above notation, the morphism $\varphi_{\textup{lift}}$ is given by
\begin{equation}\label{eq:liftingresult}
\varphi_{\textup{lift}} = \sum_{m \ge 0} (-1)^m \Psi \circ \varphi' \circ \lAt_{R^e/R_2}(Y)^m\,.
\end{equation}
where $\varphi': Y \lto R^e$ is the $R^e$-linear map defined by $\varphi'(e_i) = 1 \otimes \varphi(e_i)$.
\end{proposition}

\begin{remark}
For each $m \ge 0$ the summand of $\varphi_{\textup{lift}}$ is $(-1)^m$ times the composite
\[
\xymatrix@C+2pc{
Y \ar[r]^-{[d, d_Y]^m} & \Bar \otimes_{R^e} Y \ar[r]^-{1 \otimes \varphi'} & \Bar \otimes_{R^e} R^e \cong \Bar \ar[r]^-{\Psi} & \Delta
}\,.
\]
\end{remark}
% see lipert3
\begin{proof}[Proof of the Proposition]
We apply Corollary \ref{corollary:koszulstab2} with $X = Y^{\vee}$ to see that the composite
\[
\xymatrix@C+2pc{
\Hom_{R^e}(Y, \Delta) \ar[r]^-{\cong}_-{\xi^{-1}} & Y^{\vee} \otimes_{R^e} \Delta \ar[r]^-{\pi_{\Delta}} & Y^{\vee} \otimes_{R^e} R \ar[r]^-{\cong}_-{\xi} & \Hom_{R^e}(Y, R)
}
\]
is a homotopy equivalence, with $\xi$ denoting the canonical isomorphisms. Evaluating the homotopy inverse $\xi \circ \pi_d^{-1} \circ \xi^{-1}$ on the cohomology class of $\varphi$ yields the map $\varphi_{\textup{lift}}$ defined by
\[
\varphi_{\textup{lift}} = \sum_i \sum_{m \ge 0} (-1)^m \xi \Psi [d, d_X]^m \sigma_d( e_i^* \otimes \varphi(e_i) )\,.
\]
A straightforward computation yields (with $D = d_Y$)
\[
\varphi_{\textup{lift}}(e_j) = \sum_{m \ge 0}\sum_{i_0, i_1, \ldots, i_{m-1}} (-1)^{m|e_{i_0}| + m} \Psi d( D_{i_{m-1},j}) d( D_{i_{m-2},i_{m-1}} ) \cdots d( D_{i_0, i_1} ) \cdot (1 \otimes \varphi(e_{i_0}) )
\]
which by \eqref{eq:leftatiyahexp} agrees with the right hand side of \eqref{eq:liftingresult}.
\end{proof}

\begin{remark} As the proof makes clear, we could have made use of $\pi^{-1}_s$ instead of $\pi^{-1}_d$ in the construction of $\varphi_{\textup{lift}}$, so that an alternative chain level representative of this homotopy class could be given using $\lAt_{R^e/R_1}$ instead of $\lAt_{R^e/R_2}$.
\end{remark}

Since all tensor products are over $\Re$ everything that we have said above can be restated with $\Bar$ on the left, for example with $\Bar \,\widehat{\otimes} \, X = \prod_{m \ge 0} \Bar_m \,\widehat{\otimes}\, X$ (\textbf{todo} modify this).

For future reference, let us conclude by stating the special case of inverses for the unit actions in \eqref{eq:pertandhtpy1}. So we take $S = k[z]$, $R = k[x]$, and a finite rank matrix factorisation~$X$ of $U = V - W$ over $k[x,z]$. Applying Corollary~\ref{corollary:koszulstab2} to $X \otimes_R \Re$ or $\Re \otimes_R X$ (\textbf{todo} to which component does $R$ map?) we deduce: 

\begin{proposition}\label{prop:inverses_unitact} $k[z]$-$k[x]$-bilinear homotopy inverses for $\lambda_X$ and $\rho_X$ are given by
\[
\lambda_X^{-1} = \sum_{m \ge 0} (-1)^m \Psi \At_{R^e/R_1}(X)^m \sigma_s\,, \qquad \rho_X^{-1} = \sum_{m \ge 0} (-1)^m \Psi \At_{R^e/R_2}(X)^m \sigma_d\,.
\]
\end{proposition}

\section{Derivation of the evaluation and coevaluation}\label{sec:derivcoeval}
% TODO independence of choice of lambdas and ordering

In this section we derive formulas for the evaluation and coevaluation $2$-morphisms in the bicategory $\LG$ of Landau-Ginzburg models over a noetherian $\nQ$-algebra $k$. We fix two potentials $W\in k[x] = k[x_1,\ldots,x_n]$ and $V\in k[z] = k[z_1,\ldots,z_m]$ and a matrix factorisation $X\in \hmf(k[x,z], V-W)$. We also fix a homogeneous basis $\{ e_i \}_{i \in I}$ for $X$ with dual basis $\{ e_i^* \}_{i \in I}$. 

\begin{definition}
For $X\in \hmf(k[x,z], V-W)$ we set $X^\dual = X^\vee[n] \in \hmf(k[x,z], W-V)$ with  
$$
d_{X^\dual} = \begin{pmatrix} 0 & (d_X^0)^\vee \\ -(d_X^1)^\vee & 0\end{pmatrix}[n] 
$$ 
where $(-)^\vee$ denotes taking the dual in the category of $k[x,z]$-modules.
\end{definition}


As recalled in Section~\ref{subsec:bicatLG} there are two kinds of evaluation and coevaluation $2$-morphisms associated with~$X$. The derivation is very similar in both cases, so we give the full details for 
\[
\widetilde\coev_X: \Delta_W \lto X^\dual \otimes_{k[z]} X
\, , \qquad
\widetilde\eval_X: X \otimes_{k[x]} X^\dual \lto \Delta_V
\]
while simply stating the formulas for $\coev_X$ and $\eval_X$, with the details left to the reader. Recall that $\Delta_W$ and $X^\dual \otimes X$ are $k[x]$-bimodules and the coevaluation is $k[x]$-bilinear, while $\Delta_V$ and $X \otimes X^\dual$ are $k[z]$-bimodules and the evaluation is $k[z]$-bilinear. The differentials on the matrix factorisations $\Delta_V, \Delta_W$ is given by \eqref{DeltaW}.

At this point the evaluation and coevaluation morphisms we construct would be more accurately described as a \textsl{candidates}, as it is only later in Section~\ref{sec:Zorro} that we show that our candidates are actually the counit and unit of an adjunction by proving the Zorro moves.

\subsection{Coevaluation}\label{subsec:derivcoeval}

In this section $\Delta$ denotes $\Delta_W$.

\begin{proposition}\label{prop:isogivescoev} There is a canonical homotopy equivalence of $\mathbb{Z}_2$-graded $k$-complexes
\begin{equation}
\Hom_{k[x]\textup{-Bimod}}( \Delta, X^\dual \otimes_{k[z]} X ) \lto \Hom_{k[x,z]}(X,X)\,. \label{eq:isogivescoev}
\end{equation}
\end{proposition}
\begin{proof}
Let $\Delta'$ denote the matrix factorisation of $- \widetilde{W}$ with the same underlying graded free module as $\Delta$ but with the modified differential $d_{\Delta'} = - \delta_{+} + \delta_{-}$. This approximates the diagonal as a matrix factorisation of $- \widetilde{W}$ in just the same way that $\Delta$ approximates it as a factorisation of $\widetilde{W}$. Also let~$K$ denote the $\mathbb{Z}_2$-graded complex with the same underlying graded module as $\Delta$, but the differential~$\delta_{-}$, so~$K$ is the usual Koszul complex of $x_1 - x'_1, \ldots, x_n - x'_n$.

The product in the exterior algebra gives rise to a morphism of $\mathbb{Z}_2$-graded complexes $(R = k[x])$
\[
\Delta' \otimes_{\Re} \Delta \lto K\,.
\]
Composing with the natural morphism $\varepsilon: K \lto \Re[n]$ and taking the adjoint, we obtain the map
\[
\zeta: \Delta' \lto \Delta^\vee [n]\, , \qquad \omega \lmt \varepsilon( \omega \wedge - )
\]
which is an isomorphism of matrix factorisations. Combining this with various canonical maps and the morphism $\pi: \Delta' \lto \Delta'_0 = \Re \lto R$ we have the following diagram of \textsl{right} $R$-linear morphisms of complexes: 
\begin{equation}
\xymatrix{
\Hom_{\Re}( \Delta, X^\vee[n] \otimes_{k[z]} X)\\
\Delta^\vee \otimes_{\Re} \left( X^\vee[n] \otimes_{k[z]} X \right) \ar[u]^-{\cong}_-{\xi}\\
\left( X^\vee[n] \otimes_{k[z]} X \right) \otimes_{\Re} \Delta^\vee \ar[u]^-{\cong}_-{\textup{swap}}\\
\left( X^\vee \otimes_{k[z]} X \right) \otimes_{\Re} \Delta^\vee[n] \ar[u]^-{\cong}\\
\left( X^\vee \otimes_{k[z]} X \right) \otimes_{\Re} \Delta' \ar[u]^-{\cong}_-{\zeta} \ar[d]^-{\pi}\\
\left( X^\vee \otimes_{k[z]} X \right) \otimes_{\Re} R \ar[d]_-{\cong}\ar[d]^-{\kappa}\\
\Hom_{k[x,z]}(X,X)
}\label{eq:isogivescoev2}
\end{equation}
where for $\eta \in \Delta^\vee, f \in X^\vee \otimes_{k[z]} X$ and $\tau \in \Delta$ we have
\[
\xi( \eta \otimes x )( f ) = (-1)^{|\eta||x|} \eta(f) \cdot x\,,
\]
and for $f \in X^\vee$ and $g,g' \in X$: 
\[
\kappa( f \otimes g )(g') = (-1)^{|f||g|} f(g') \cdot g\,.
\]
So to complete the proof we need only to show that the step marked $\pi$ is a right $R$-linear homotopy equivalence. But this is a consequence of Lemma \ref{lemma:koszulstab1} with $A = k[x], R = \Ae$ and $\theta$ the identity.
\end{proof}

\begin{definition}\label{def:coeval}
The \textsl{coevaluation} is the morphism $\widetilde\coev_X: \Delta \lto X^\dual \otimes X$ in the homotopy category $\hmf(\Re, \widetilde{W})$ mapping to $1_X$ under~\eqref{eq:isogivescoev}.
\end{definition}

To give a representative chain map for the coevaluation we begin with $1_X$ at the bottom of (\ref{eq:isogivescoev2}) and apply the various maps in turn; the only nontrivial step will be to apply the homotopy inverse for $\pi$ found in Section \ref{section:pertandhtpy}. The two different choices of inverse provided there will lead to two different (but homotopic) chain level representatives for the coevaluation.

With $\reprod$ as in (\ref{eq:attau}) we consider on the tensor product
\[
\reprod_*(\Bar) \otimes_{\Re} ( X^\dual \otimes_{k[z]} X)\,
\]
the operator
\[
\Atlarrow_{R^e/R_2}(X^\dual \otimes X) = [d, d_{X^\dual \otimes X}] = [d, d_{X^\dual} \otimes 1_X]
\]
with the second equality holding because $d$ is $R_2$-linear. For this reason we abuse notation and write $\Atlarrow(X^\dual)$ for the operator in the previous equation. If we apply $\Psi: \Bar \lto K$ after a power of the Atiyah class, we end up with maps
\[
\xymatrix@C+1pc{
X^\dual \otimes_{k[z]} X \ar[rr]^-{\Atlarrow(X^\dual)^m} & & \reprod_*(\Bar) \otimes_{\Re} ( X^\dual \otimes_{k[z]} X ) \ar[r]^-{\Psi} & K \otimes_{\Re} (X^\dual \otimes_{k[z]} X)
}
\]
which we can apply to the tensor $\iota_X = \sum_{j} (-1)^{|e_j|} e_j^* \otimes e_j$.

\begin{theorem}\label{theorem:coev1} A representative for the coevaluation morphism is the chain map
\begin{equation}\label{eq:coev10}
\widetilde\coev^L_X(\gamma) = \varepsilon \left( \gamma \wedge \sum_{m \ge 0} (-1)^m \Psi \Atlarrow(X^\dual)^m( \iota_X ) \right)\
\end{equation}
where the Atiyah class sends forms to the left, as explained above.
\end{theorem}
\begin{proof}
Let us chase $1_X$ upwards through (\ref{eq:isogivescoev2}), noting that $\iota_X = \kappa^{-1}(1_X)$. With $A = k[x], R = \Ae$ and $\theta$ the identity we may apply Corollary \ref{corollary:koszulstab2} to describe a homotopy inverse to $\pi$ in terms of the Atiyah class $[d, d_{X^\dual \otimes X}]$. In light of the observations preceeding the statement of the theorem we have
\begin{equation}\label{eq:coev11}
\pi^{-1} \kappa^{-1}(1_X) = \sum_{m \ge 0} (-1)^m \Psi \big[d, d_{X^\dual}\big]^m( \iota_X )\,.
\end{equation}
A summand $f \otimes \theta_{\bs{i}}$ in (\ref{eq:coev11}), with $f \in X^\dual \otimes X$ and $\theta_{\bs{i}} = \theta_{i_1} \ldots \theta_{i_p}$ for $i_1 < \ldots < i_p$, maps under $\zeta$ to
\[
f \otimes \zeta( \theta_{i_1} \ldots \theta_{i_p} ) = f \otimes \varepsilon\big( \theta_{\bs{i}} \wedge - \big)
\]
and then to the function $\Delta \lto X^\dagger \otimes X$ defined by $\gamma \lmt (-1)^{|\omega||f|} \varepsilon\big( \gamma \wedge \omega \otimes f \big)$, and so (\ref{eq:coev10}) follows from (\ref{eq:coev11}).
\end{proof}

There is an alternative presentation which we will also need. On the tensor product
\[
( X^\dual \otimes X) \otimes_{R^e} \Bar
\]
we consider the operator
\[
\At_{R^e/R_1}(X^\dual \otimes X) = [s, d_{X^\dual \otimes X}] = [s, d_X]
\]
with the second equality holding because $s$ is $k[x]$-linear. We write $\At_{R^e/R_1}(X)$ for this operator. 

%If we apply $\Psi: \Bar \lto K$ after a power of the Atiyah class, we end up with maps
%\[
%\xymatrix{
%X^\dual \otimes X \ar[r]^-{\At^m_{X, k[x,y]/k[x]}} & ( X^\dual \otimes X ) \otimes_{k[x,y]} \Bar \ar[r]^-{\Psi} & (X^\dual \otimes X)\otimes_{k[x,y]} K\,.
%}
%\]

\begin{theorem} A representative for the coevaluation morphism is the chain map
\[
\widetilde\coev^R_X(\gamma) = \varepsilon \left( \sum_{m \ge 0} (-1)^m \Psi \At_{R^e/R_1}(X)^m( \iota_X ) \wedge \gamma \right)\,.
\]
\end{theorem}

\begin{example} Give an example for say $n = 3$ to explain how the coevaluation picks out the ``curvature'' in the orthogonal to infinitesimal element $\gamma$.
\end{example}

\subsection{Evaluation}\label{subsec:eval}

In this section we write $B = k[z]$ [TODO: better always use either $R,S$ or $A,B$] and $\Be = B \otimes_k B$ so that $\widetilde\eval_X$ is a morphism of (infinite rank) matrix factorisations of $\widetilde{V} = V \otimes 1 - 1 \otimes V$ over $\Be$. The polynomials $\partial_{x_i} W$ act null-homotopically on $X$ and we let $\lambda_i \in \Hom_{k[x,z]}(X,X)$ denote a degree-one map with $[d_X, \lambda_i] = f_i \cdot 1_X$. For example $\lambda_i = \partial_{x_i} d_X$ would do, but it will be important to allow other choices.

The evaluation map will be produced by a perturbation whose initial data is the morphism $\eval_0$ of the next proposition. As its main ingredient is the residue symbol, we briefly recall some of its basic properties; see~\cite{TODO} for more details. Given a regular sequence $(f_1,\ldots,f_n)$ in $k[x]$ it is the $k[y]$-linear map that sends a polynomial $g\in k[x,y]$ to the expression
$$
\Res_{k[x,y]/k[y]} \left[ \frac{g \, \underline{\operatorname{d}\! x}}{f_1 \ldots f_n} \right] 
\in k[y]
$$
where $\underline{\operatorname{d}\!x}=\operatorname{d}\!x_1\ldots \operatorname{d}\!x_n$. In practice the residue is computed by the transformation rule
$$
\Res_{k[x,y]/k[y]} \left[ \frac{g \, \underline{\operatorname{d}\! x}}{f_1 \ldots f_n} \right] 
= 
\Res_{k[x,y]/k[y]} \left[ \frac{\det(C) g \, \underline{\operatorname{d}\! x}}{f'_1 \ldots f'_n} \right] 
\, , \qquad
f'_i = \sum_{j=1}^n C_{ij} f_j 
\, , \qquad
C_{ij} \in k[x,y] \, ,
$$
together with the defining property $\Res_{k[x,y]/k[y]} \left[ \underline{\operatorname{d}\! x}/(x_1^{a_1} \ldots x_n^{a_n}) \right] = \delta_{a_1,1}\ldots \delta_{a_n,1}$. 

\begin{proposition} There is a morphism of linear factorisations of $\widetilde{V}$ over $\Be$, 
\[
\eval_0: X \otimes_{k[x]} X^\dual \lto B\,,
\]
defined by
\[
\eval_0( f \otimes \nu ) = (-1)^{\binom{n}{2} + n|f|} \Res_{k[x,z]/k[z]} \left[ \frac{ \str( \lambda_1 \cdots \lambda_n \circ f \circ \nu) \underline{\operatorname{d}\!x}}{\partial_{x_1}W \ldots \partial_{x_n} W} \right]
\]
\end{proposition}
\begin{proof}
To describe this map we set
\[
\Hom_{k[x,z]}(\bar{X}, \bar{X}) = \Hom_{k[x,z]}(X, X) \otimes_{k[x]} k[x]/(\partial_{x_1}W, \ldots, \partial_{x_n}W)\,.
\]
Then for each $1 \le i \le n$ we have a closed, odd $k[x,z]$-linear operator $\lambda_i^\bullet$ on $\Hom_{k[x,z]}(\bar{X}, \bar{X})$
\[
\lambda_i^\bullet(\alpha) = \lambda_i \circ \alpha\,.
\]
There is a chain of $\Be$-linear morphisms of linear factorisations of $\widetilde{V}$
\begin{equation}
\xymatrix{
X \otimes_{k[x]} (X^\vee [n]) \ar[d]_-{\cong}\\
(X \otimes_{k[x]} X^\vee)[n] \ar[d]^-{\textup{quotient}} \ar[d]_-{\cong}\\
\big( B \otimes_{B^e} (X \otimes_{k[x]} X^\vee)\big)[n] \ar[d]^-{\kappa} \ar[d]_-{\cong}\\
\Hom_{k[x,z]}(X,X)[n] \ar[d]^-{\lambda_1^\bullet \cdots \lambda_n^\bullet}\\
\Hom_{k[x,z]}(\bar{X},\bar{X})[n]
}
\end{equation}
which composed with the supertrace and residue gives the desired morphism. Here $\kappa$ is defined by
\[
\kappa(1 \otimes f \otimes \nu)(s) = \nu(s) \cdot t\,.
\]
\end{proof}

TODO: $\coev_\Delta= \lambda^{-1}_\Delta$ and $\eval_\Delta = \lambda_\Delta$

\section{Zorro moves}\label{sec:Zorro}

In this section we will show that the bicategory $\LG$ of Landau-Ginzburg models has adjoints for any noetherian $\mathbb{Q}$-algebra $k$. Let us fix two arbitrary potentials $W\in k[x] = k[x_1,\ldots,x_n]$ and $V\in k[z] = k[z_1,\ldots,z_m]$. Then we want to prove that for any matrix factorisation $X\in \hmf(k[x,z], V-W)$ and its adjoint $X^\dual = X^\vee[n]\in \hmf(k[x,z], W-V)$ the Zorro moves~\eqref{Zorros} and~\eqref{otherZorros} are satisfied. Let $\{ e_i \}_{i \in I}$ denote a homogeneous $k[x,z]$-basis of $X$ and $\{ e_i^* \}_{i \in I}$ the dual basis of $X^\vee$.

Let us consider the first identity of~\eqref{otherZorros} in more detail: 
\be\label{Zorro1detail}
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]

\fill (0.2,1.6) circle (0pt) node {{\small $\Delta_V$}};
\fill (-0.2,-1.6) circle (0pt) node {{\small $\Delta_W$}};

\fill (1,1.8) circle (2.5pt) node[right] {{\small $\lambda$}};
\fill (-1,-1.8) circle (2.5pt) node[left] {{\small $\rho^{-1}$}};

\fill (-1.25,-2.25) circle (0pt) node {{\footnotesize $z$}};
\fill (-0.75,-2.25) circle (0pt) node {{\footnotesize $x$}};

\fill (-1.25,0) circle (0pt) node {{\footnotesize $z\vphantom{z'}$}};
\fill (-0.5,0) circle (0pt) node {{\footnotesize $x\vphantom{x'}$}};
\fill (0.5,0) circle (0pt) node {{\footnotesize $z\vphantom{x'}$}};
\fill (1.25,0) circle (0pt) node {{\footnotesize $x'\vphantom{z'}$}};

\fill (1.25,2.25) circle (0pt) node {{\footnotesize $x'$}};
\fill (0.75,2.25) circle (0pt) node {{\footnotesize $z\vphantom{x'}$}};

\draw[dashed] (-0.5,0.75) .. controls +(0,0.75) and +(-0.25,-0.75) .. (1,1.8);
\draw[dashed] (0.5,-0.75) .. controls +(0,-0.75) and +(0.25,0.75) .. (-1,-1.8);

\draw[line width=0] 
(1,2.7) node[line width=0pt] (A) {{\small $X$}}
(-1,-2.7) node[line width=0pt] (A2) {{\small $X$}}; 
\draw[redirected] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[redirected] (1,0) .. controls +(0,-1) and +(0,-1) .. (0,0);
\draw (-1,0) -- (A2); 
\draw (1,0) -- (A); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,2.7) node[line width=0pt] (A) {{\small $X$}}
(0,-2.7) node[line width=0pt] (A2) {{\small $X$}}; 
\draw (A2) -- (A); 
\end{tikzpicture}
\ee
Here we also label the two domains to the left and right of the 1-morphism~$X$ by the variables pertaining to the objects $(k[x],W), (k[z],V) \in \LG$; where opportune we use primes to distinguish between different copies of the same variable sets, i.\,e.~between between different actions of the same ring. We call the left-hand side of (\ref{Zorro1detail}) the \textsl{Zorro map} and denote it $\mathcal Z$. It is the composite
\be\label{eq:zorro1a1}
\xymatrix@C+2pc{
X \ar[r]^-{\rho^{-1}} & X \otimes \Delta_W \ar[r]^-{1 \otimes\,\widetilde{\coev}} & X \otimes X^{\dagger} \otimes X \ar[r]^-{\widetilde{\eval}\, \otimes 1} & \Delta_V \otimes X \ar[r]^-{\lambda} & X\,,
}
\ee
which we prove is homotopic to the identity on $X$. Note that we continue to discard subscripts that are clear from the context, e.\,g.~$\widetilde\eval = \widetilde\eval_X$. 

We keep in mind that there are two distinct $\Delta$'s which appear: if we write $R = k[x]$ and $S = k[z]$ then one of the $\Delta$'s is an $R$-$R$-bimodule, and the other is an $S$-$S$-bimodule. It is sometimes convenient to identify $\Re$ with $k[x,x']$ so that the right $R$-action is via polynomials in the $x'$-variables.

Let us introduce the notation
$$
\langle\!\langle-\rangle\!\rangle = (-1)^{n+1\choose 2} \Res_{k[x,x',z]/k[x',z]} \left[ \frac{ \varepsilon\Psi(-) \underline{\operatorname{d}\!x}}{\partial_{x_1}W \ldots \partial_{x_n} W} \right]
$$
for the map $S \otimes_k \Bar \lto S \otimes_k R = k[x',z]$ defined using the map $\varepsilon\Psi: \Bar \lto S \otimes_k R$ of Section \ref{??} and $\underline{\operatorname{d}\!x}=\operatorname{d}\!x_1\ldots \operatorname{d}\!x_n$ as before. Here $\Bar$ is the bar complex of $R$ over $k$, and the two copies of $R$ play very different roles in $\langle\!\langle - \rangle\!\rangle$. The left copy (i.\,e.~$k[x]$) is integrated out, and the map is linear with respect to the right action, so that overall $\langle\!\langle - \rangle\!\rangle$ is $k[x,z]$-linear.

Let $\At$ denote the Atiyah class of $\End(X)$, which is an operator on $\End(X) \otimes_{k[x]} \Bar$. Let $\lambda_i$ be a null-homotopy on $X$ for the action of $\partial_{x_i} W$, for example $\lambda_i=\partial_{x_i}d_X(x,z)$, and set 
$$
\Lambda = \lambda_1\ldots \lambda_n \, . 
$$
Our first order of business is to establish the following expression for the Zorro map.

\begin{lemma}\label{lemma:Zorrointermediate} We have
\be\label{Zorrointermediate}
\mathcal Z = \sum_j (-1)^{|e_j| + n} \big\langle\!\big\langle \str \big( \Lambda \circ \At^n (-\circ e_j^*) \big) \big\rangle\!\big\rangle \cdot e_j
\ee
where for $f \in X$, the endomorphism $f \circ e_j^*$ sends $g$ to $e_j^*(g) \cdot f$.
\end{lemma}

Before giving the proof of the lemma, let us sketch the argument that $\mathcal Z$ is homotopic to the identity. In outline, the Atiyah class is ``anti-self-adjoint'' with respect to $\langle\!\langle \str( - ) \rangle\!\rangle$: 
\begin{equation}\label{eq:trueproofeq}
\big\langle\!\big\langle \str \big( \Lambda \circ \At^n (-)\big) \big\rangle\!\big\rangle \simeq (-1)^n \big\langle\!\big\langle \str \big( \At^n( \Lambda ) \circ -\big) \big\rangle\!\big\rangle\,.
\end{equation}
We will see that $\At^n( \Lambda )$ is a transition determinant in the sense of the calculus of residues, so that the right-hand side of~(\ref{eq:trueproofeq}) can be identified with $\str(-)$. Hence
\begin{equation}\label{eq:trueproofeq2}
\mathcal{Z} \simeq \sum_j (-1)^{|e_j|} \str(-\circ e_j^*) \cdot e_j = \sum_j \str(e_j^* \circ -) \cdot e_j = 1_X\,.
\end{equation}
The reader will appreciate the parallel with the argument for duality in the monoidal category of vector spaces, with the new feature here being the Atiyah class and its anti-self-adjointness.

There are two subtleties which complicate the proof. The first is that we must deal throughout with associative Atiyah classes and thus non-commutative differential forms (compare with the proof of non-degeneracy in Section~\ref{section:dualityadjointop} where only ordinary Atiyah classes are involved). The second is that the identites above only hold, in general, up to homotopy ``$\simeq$''.

For the proof of Lemma \ref{lemma:Zorrointermediate} let us recall the explicit formulas for the maps involved: 
\begin{align*}
\rho^{-1}: X \lto X \otimes \Delta \, , \qquad \rho^{-1}(a) &= \sum_{m \ge 0}(-1)^m \Psi\! \At^m_X(a)\,,\\
\widetilde{\coev}: \Delta \lto X^{\dagger} \otimes X \, , \qquad \widetilde{\coev}(\gamma) &= \varepsilon\Big( \gamma \wedge \sum_{i \ge 0}(-1)^i (\Psi\!\At^i_{X^{\dagger}} \otimes 1)(\iota_X) \Big)\,,\\
&= \sum_{i,j} (-1)^{i+|e_j|} \varepsilon \Big( \gamma \wedge \Psi\!\At^i_{X^{\dagger}}( e_j^* ) \otimes e_j \Big)\\
\widetilde{\eval}: X \otimes X^{\dagger} \lto \Delta \, , \qquad \widetilde{\eval}(\alpha) &= (-1)^{\binom{n+1}{2}}\Res_{k[x,y',z]/k[y',z]}\! \left[ \frac{\str ( \alpha
%|_{z=z'}
 \Lambda) \underline{\operatorname{d}\! x}}{\partial_{x_1}W \ldots \partial_{x_n} W} \right] + \mathcal{O}(\theta)\,.
\end{align*}
%Note that tensoring with the diagonal defines a map $(-)|_{z=z'}: X \otimes X^{\dagger} \lto \Hom_{k[x,z]}(X,X)$ (\textbf{more} there is no longer a $z'$ -- so there's no need to mention it!) 
Here $\mathcal{O}(\theta)$ denotes higher order terms which do not survive the map $\lambda$ in~\eqref{Zorro1detail} and therefore may be ignored for present purposes. Also define $\nabla$ and Atiyah classes (\textbf{todo}).

\begin{proof}[Proof of Lemma \ref{lemma:Zorrointermediate}]
Consider the image of a basis element $e_q$ under the first two maps of (\ref{eq:zorro1a1}): 
\begin{align}
(1 \otimes \widetilde{\coev}) \circ \rho^{-1}( e_q ) &= \textup{another line of explanation}\\
&= \sum_{i,k,j} (-1)^{i+k} \varepsilon\Big( \Psi\! \At^i_X( e_q ) \wedge \Psi \!\At^k_{X^{\dagger}}( e_j^* ) \otimes e_j \Big) \nonumber\\
&= \sum_{j} \sum_{i+k = n} (-1)^n \varepsilon\Psi\Big( \At^i_X( e_q ) \times \At^k_{X^{\dagger}}( e_j^* ) \otimes e_j \Big) \nonumber\\
&= \sum_{j} (-1)^n \varepsilon\Psi\Big( \At^n_{X \otimes X^{\dagger}}( e_q \otimes e_j^* ) \otimes e_j \Big)\,. \label{firstzorromaps}
\end{align} 
In the first step we use that $\Psi$ intertwines the shuffle product on $\Bar$ with the exterior product on~$\Delta$, and in the last step we use Lemma \ref{lemma:atshufat}. Applying $\widetilde\eval$ in the first two components of $X \otimes X^{\dagger} \otimes X$ to the expression in (\ref{firstzorromaps}) has the effect of changing the associative Atiyah class of $X \otimes X^{\dagger}$ to the associative Atiyah class of $\End(X)$ and so
\begin{align}
\mathcal{Z}(e_q) &= \lambda \circ (\widetilde\eval \otimes 1) \circ (1 \otimes \widetilde\coev) \circ \rho^{-1}( e_q )\\
&= \sum_j (-1)^{|e_j|+n+\binom{n+1}{2}}\Res_{k[x]/k}\! \left[ \frac{ \varepsilon\Psi \str\Big( \At^n( e_q \circ e_j^* ) \Lambda \Big) \underline{\operatorname{d}\! x} }{\partial_{x_1}W \ldots \partial_{x_n} W} \right] \cdot e_j
\end{align}
Since the Zorro map~$\mathcal Z$ is $k[x,z]$-linear it is fixed by its action on basis elements~$e_q$, which proves that $\mathcal{Z}$ is given by (\ref{Zorrointermediate}).
\end{proof}

The form of self-adjointness of the Atiyah class that we will use is contained in the next result. The $p = 0$ case is the statement that for $\varphi \in \End(X) \otimes_{k[x]} \Bar$ we have
\[
\big\langle\!\big\langle \str( \lambda_1 \ldots \lambda_n \circ \At(\varphi) ) \big\rangle\!\big\rangle = \sum_{i=1}^n (-1)^{i-1} \Big\langle\!\Big\langle \nabla \left\{ f_i \str( \lambda_1 \ldots \widehat{\lambda_i} \ldots \lambda_n \circ \varphi ) \right\} \Big\rangle\!\Big\rangle + h_0( D(\varphi))
\]
for some function $h_0$, where as usual $\widehat{\lambda_i}$ means that $\lambda_i$ is omitted. Applying the lemma inductively will interpolate between the left- and right-hand sides of (\ref{eq:trueproofeq}). For the general statement we will need some notation: given a sequence $\bs{i} = (i_1,\ldots,i_p)$ in $\{1, \ldots, n\}$ (not necessarily in ascending order) let
\[
\ell(\bs{i}) = p, \qquad w(\bs{i}) = i_1 + \ldots + i_p, \qquad |\bs{i}| = \sum_{1 \le a < b \le n} \delta_{i_a > i_b}\, \qquad \gamma(\bs{i}) = w(\bs{i}) + |\bs{i}| + \binom{p+1}{2}\,.
\]
The empty sequence $\emptyset$ is the unique sequence of length $\ell(\emptyset) = 0$. We write $\Lambda_{i_1,\ldots,i_p}$ for the product $\Lambda = \lambda_1 \cdots \lambda_n$ with the $\lambda_{i_1},\ldots,\lambda_{i_p}$ omitted. We deliberately confuse an endomorphism of $X$ with the operator on $\End(X) \otimes_{k[x]} \Bar$ which acts by post-composition with the endomorphism. 
%Let $D$ denote the differential on $\End(X)$, i.\,e.~the commutator with~$d_X$.

\begin{lemma}\label{lemma:zorromain} For $\varphi \in \End(X) \otimes_{k[x]} \Bar$ and $0 \le p < n$ we have
\begin{align*}
\sum_{\ell(\bs{i}) = p} (-1)^{\gamma(\bs{i}) + p} & \Big\langle\!\Big\langle \nabla f_{i_1} \nabla f_{i_2} \cdots \nabla f_{i_p} \str\big( \Lambda_{i_1,\ldots,i_p} \circ \At(\varphi) \big) \Big\rangle\!\Big\rangle\\
&= \sum_{\ell(\bs{i}) = p+1} (-1)^{\gamma(\bs{i}) + p+1} \Big\langle\!\Big\langle \nabla f_{i_1} \nabla f_{i_2} \cdots \nabla f_{i_{p+1}} \str\big( \Lambda_{i_1,\ldots,i_p,i_{p+1}} \circ \varphi \big) \Big\rangle\!\Big\rangle + h_p( D( \varphi ) )
\end{align*}
where $f_i = \partial_{x_i} W$, $D=[d_X,-]$ is the differential on $\End(X)$, and the sums are over all sequences of length $p, p+1$, respectively, and
\[
h_p( \psi ) = \sum_{\ell(\bs{i}) = p} (-1)^{\gamma(\bs{i}) +p} \Big\langle\!\Big\langle \nabla f_{i_1} \cdots \nabla f_{i_p} \str\big( [ \Lambda_{i_1,\ldots,i_p}, \nabla](\psi) \big) \Big\rangle\!\Big\rangle\,.
\]
\end{lemma}
\begin{proof}
Fix a sequence $\bs{i}$ of length $p$. The super Jacobi identity for operators on $\End(X) \otimes \Bar$ gives
\be\label{superJacobi}
\big[ \Lambda_{i_1,\ldots,i_p}, \At \big] = (-1)^{n-p} \big[ D, \big[ \Lambda_{i_1,\ldots,i_p}, \nabla \big] \big] - \big[ \nabla, \big[ D, \Lambda_{i_1,\ldots,i_p} \big] \big]\,.
\ee
It is easy to see that $\str \circ \nabla = \nabla \circ \str$ and hence $\str \circ \At = 0$ so if we apply~\eqref{superJacobi} to~$\varphi$ and then apply $\dlangle \eta \str( - ) \drangle$ with $\eta = \nabla \circ f_{i_1} \circ \cdots \circ \nabla \circ f_{i_p}$, we have
\begin{align}
\dlangle \eta \str\big( \Lambda_{i_1,\ldots,i_p} \circ \At(\varphi) \big) \drangle &= (-1)^{n-p} \dlangle \eta \str\big( \big[ D, \big[ \Lambda_{i_1,\ldots,i_p}, \nabla \big] \big] \varphi \big) \drangle \nonumber\\
&\qquad - \dlangle \eta \str\big( \big[ \nabla, \big[ D, \Lambda_{i_1,\ldots,i_p} \big] \big] \varphi \big) \drangle \nonumber\\
&= \dlangle \eta \str\big( \big[ \Lambda_{i_1,\ldots,i_p}, \nabla \big] ( D\varphi ) \big) \drangle \label{eq:hutch1}\\
&\qquad- \dlangle \eta \nabla \str\big( \big[ D, \Lambda_{i_1,\ldots,i_p} \big] \varphi \big) \drangle \label{eq:hutch2}\\
&\qquad+ (-1)^{n-p+1} \bigdlangle \eta \str\big( \big[ D, \Lambda_{i_1,\ldots,i_p} \big]( \nabla \varphi ) \big) \drangle \, . \label{eq:hutch3}
\end{align}
Since $[d_X, \lambda_i] = f_i$ we have
\[
\big[ D, \Lambda_{i_1,\ldots,i_p} \big] = \sum_{a \notin \{ i_1, \ldots, i_p \} } (-1)^{a-1 + \#\{ b \l i_b < a \}} f_{a} \cdot \Lambda_{i_1,\ldots,i_p,a}
\]
where the sign counts the number of $\lambda$'s to the left of $\lambda_a$ in $\Lambda_{i_1,\ldots,i_p}$. Substituting, the last summand (\ref{eq:hutch3}) in the above is, up to a sign, 
\[
\sum_{a \notin \{ i_1,\ldots, i_p \}} (-1)^{a-1 + \#\{ b \l i_b < a \}} \bigdlangle \nabla f_{i_1} \cdots \nabla f_{i_p} f_a \str\big( \big[ D, \Lambda_{i_1,\ldots,i_p,a} \big]( \nabla \varphi ) \big) \bigdrangle \, .
\]
If we sum over all sequences $\bs{i}$ with the signs given in the statement of the lemma it is straightforward to check that the above term vanishes, because $f_{i_p} f_a$ and $f_a f_{i_p}$ appear in the sum with opposite signs. This completes the proof, since the sum over $\bs{i}$ of (\ref{eq:hutch1}) and (\ref{eq:hutch2}) gives us the right-hand side of the equation in the statement of the lemma.
\end{proof}

\begin{lemma}\label{lemma:langlecalc1} For $\varphi \in \End(X)$ we have
\[
\big\langle\!\big\langle \str \big( \Lambda \At^n (\varphi)\big) \big\rangle\!\big\rangle = \str(\varphi)\big|_{x \lmt y} + \sum_{p=0}^{n-1} h_i( D \At^{n-p-1}(\varphi) )\,.
\]
\end{lemma}
\begin{proof}
Applying Lemma \ref{lemma:zorromain} repeatedly yields
\begin{align*}
\big\langle\!\big\langle \str \big( \Lambda \At^n (\varphi)\big) \big\rangle\!\big\rangle = (-1)^n \sum_{\sigma \in S_n} (-1)^{|\sigma|} \big\langle\!\big\langle \nabla f_{\sigma(1)} \cdots \nabla f_{\sigma(n)} \str(\varphi) \big\rangle\!\big\rangle + \sum_{p=0}^{n-1} h_i( D \At^{n-p-1}(\varphi) )\,.
\end{align*}
%where 
%$$
%\delta = 
%\det 
%\begin{pmatrix}
%df_1 & df_2 & \cdots & df_n \\
%\vdots & \vdots & & \vdots \\
%df_1 & df_2 & \cdots & df_n 
%\end{pmatrix} .
%$$
%This concludes the proof that the Zorro map~\eqref{Zorro1superdetail} is homotopic to the identity. 
But by a small argument involving transition determinants (\textbf{todo}) this equals 
\[
= \str( \varphi )|_{x \lmt x'} + \sum_{p=0}^{n-1} h_i( D \At^{n-p-1}(\varphi) ) \, .
\]
\end{proof}

The upshot is that, by the previous lemma and Lemma \ref{lemma:Zorrointermediate},
\begin{align*}
\mathcal{Z} &= \sum_j (-1)^{|e_j| + n} \big\langle\!\big\langle \str \big( \Lambda \circ \At^n (-\circ e_j^*) \big) \big\rangle\!\big\rangle \cdot e_j\\
&= \sum_j (-1)^{|e_j|} \str(-\circ e_j^*) \cdot e_j + H\\
&= \sum_j \str(e_j^* \circ -) \cdot e_j + H\\
&= 1_X + H
\end{align*}
where
\[
H = \sum_j \sum_{p=0}^{n-1} (-1)^{|e_j|} h_i( D \At^{n-p-1}(- \circ e_j^*) ) \cdot e_j\,.
\]
As the difference of two closed maps $H = \mathcal{Z} - 1_X$ is a closed endomorphism of $X$, and to complete the proof that $\mathcal{Z} \simeq 1_X$ it remains to prove that $H$ is null-homotopic. 

The idea is to use the non-degenerate pairing on the morphism spaces of $\hmf(k[x,z], V-W)$. If~$k$ is a field this is the Kapustin-Li pairing of \cite{??,??} but in general we use the contents of Section \ref{??} (\textbf{more}). The precise statement (Theorem \ref{??}) is that there is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes over $k$
\be
\Hom_{k[x,z]}(X,X) \lto \Hom_k( \Hom_{k[x,z]}(X,X), k )[m+n]\,, \qquad \varphi \lmt \langle \varphi, - \rangle_X\,.
\ee
induced by the pairing
\begin{equation}\label{eq:bracketkl}
\langle -, - \rangle_X = \frac{1}{n!} \sum_{\sigma \in S_n} (-1)^{|\sigma|} \Res_{k[x,z]/k} \left[ \frac{ \str( - \circ - \circ \Lambda^{(x)} \Lambda^{(z)}) \underline{\operatorname{d}\!x} \underline{\operatorname{d}\!z}}{\partial_{x_1}W \ldots \partial_{x_n} W \partial_{z_1} V \ldots \partial_{z_m} V} \right]
\end{equation}
where $\Lambda^{(x)}=\Lambda$ is the product of homotopies for the action of $\partial_{x_i}W$ introduced earlier, and $\Lambda^{(z)}$ is the product of homotopies for the action of $\partial_{z_j}V$ on~$X$. To prove that $\mathcal{Z} \simeq 1_X$ it is therefore enough to prove that the functionals $\langle \mathcal{Z}, - \rangle_X$ and $\langle 1_X, - \rangle_X$ on $\Hom_{k[x,z]}(X,X)$ are homotopic, or what is the same, that $\langle H, \varphi \rangle_X$ can be written as a function of $D(\varphi)=[d_X,\varphi]$. This will follow from a careful study of the map $\str( H \circ - )$.

We compute for a homogeneous element $\varphi \in \End(X)$ that
\begin{align}
\str(H \varphi) &= \str( \mathcal{Z} \varphi ) - \str(\varphi) \nonumber\\
&= \sum_i (-1)^{|e_i|} e^*_i \big( \mathcal Z(\varphi(e_i)) \big) - \str(\varphi)\nonumber \\
& = \sum_{i,j} (-1)^{|e_i| + |e_j| + n} e^*_i \Big( \big\langle\!\big\langle \str( \Lambda \At^n (\varphi(e_i)\otimes e^*_j \otimes e_j)) \big\rangle\!\big\rangle \Big) - \str(\varphi)\nonumber \\
& = \sum_{i,j} (-1)^{|e_i| + |e_j| + n + n|e_j|} e^*_i \Big( \big\langle\!\big\langle \str( \Lambda \At^n (\varphi(e_i)\otimes e^*_j )) \big\rangle\!\big\rangle e_j \Big) - \str(\varphi)\nonumber \\
& = \big\langle\!\big\langle \str \big( \Lambda \At^n \big(\sum_i \varphi(e_i)\otimes e^*_j \big)\big) \big\rangle\!\big\rangle - \str(\varphi)\nonumber \\
& = \big\langle\!\big\langle \str \big( \Lambda \At^n (\varphi)\big) \big\rangle\!\big\rangle - \str(\varphi) \nonumber\\
&= \sum_{p=0}^{n-1} h_i( D \At^{n-p-1}(\varphi) ) \label{strlambdaAtn}
\end{align}
where in the last step we use Lemma \ref{lemma:langlecalc1}. For the final steps in the argument we will need the following lemma.

\begin{lemma}\label{lem:PsiToTheRight}
Let $\omega\in\Omega(k[x_1,\ldots,x_n])$ be an $n$-form. Then $\Psi(\omega f)=\Psi(\omega) f(y)$ for any $f\in k[x]$. 
\end{lemma}

\begin{proof}
We may assume that $\omega$ is of the form $da_1\ldots da_n$ for some $a_i\in k[x]$. Then
\begin{align*}
\Psi(\omega f) & = \Psi \Big( \sum_{i=1}^n (-1)^{n-i} da_1\ldots da_{i-1} d(a_i a_{i+1}) da_{i+2}\ldots da_n df + (-1)^n a_1 da_2\ldots da_n df \Big) \\
& = \sum_{i=1}^n (-1)^{n-i} \partial_{[1]} a_1\ldots \partial_{[i-1]} a_{i-1} \partial_{[i]} (a_i a_{i+1}) \partial_{[i+1]} a_{i+2} \ldots \partial_{[n-1]} a_n \partial_{[n]} f \\
& \qquad + (-1)^n a_1 \partial_{[1]} a_2 \ldots \partial_{[n-1]} a_n \partial_{[n]} f \\
& = \sum_{i=1}^n (-1)^{n-i} \partial_{[1]} a_1\ldots \partial_{[i-1]} a_{i-1} \Big(\partial_{[i]} a_i {}	^{t_1\ldots t_i}a_{i+1} + {}^{t_1\ldots t_{i-1}} a_i \partial_{[i]} a_{i+1} \Big) \\
& \qquad \cdot  \partial_{[i+1]} a_{i+2} \ldots \partial_{[n-1]} a_n \partial_{[n]} f + (-1)^n a_1 \partial_{[1]} a_2 \ldots \partial_{[n-1]} a_n \partial_{[n]} f \\
& = \partial_{[1]} a_1 \ldots \partial_{[n]} a_n f(y) \\
& = \Psi(\omega) f(y) \, ,
\end{align*}
where we used Lemma~\ref{lem:LeibnizForDQO} in the third step. 
\end{proof}

\begin{theorem}\label{theorem:mainzorro} The Zorro map $\mathcal{Z}$ is homotopic to $1_X$.
\end{theorem}
\begin{proof}
As we have already mentioned, it suffices by non-degeneracy of \eqref{eq:bracketkl} to prove that $\langle H, - \rangle_X$ is a null-homotopic function $\Hom_{k[x,z]}(X,X) \lto k$. For $\varphi' \in \End(X)$ the numerator in the residue which computes $\langle H, \varphi' \rangle_X$ is, using \eqref{strlambdaAtn}, a differential form multiplied by
\[
\str( H \varphi' \Lambda^{(x)} \Lambda^{(z)}) = \sum_{p=0}^{n-1} h_p( D \At^{n-p-1}(\varphi' \Lambda^{(x)} \Lambda^{(z)}) )
\]
But given $\varphi' \in \End(X)$ if we set $\varphi = \varphi' \circ \Lambda^{(x)} \Lambda^{(z)}$ and substitute in (\ref{??}) we find that the two functionals $\langle \mathcal{Z}, - \rangle_X$ and $\langle 1_X, - \rangle_X$ differ by a term which is an expression in residues of
\begin{equation}\label{eq:mainzorro1}
h_p( D \At^{n-p-1}(\varphi) ) = h_p( D \At^{n-p-1}(\varphi' \Lambda^{(x)} \Lambda^{(z)}) )\,.
\end{equation}
But $\At$ is closed, so 
\begin{align}
h_p( D \At^{n-p-1}(\varphi' \Lambda^{(x)} \Lambda^{(z)}) ) &= h_p \At^{n-p-1}D(\varphi' \Lambda^{(x)} \Lambda^{(z)}) ) \nonumber\\
&= h_p \At^{n-p-1}\big( D(\varphi') \Lambda^{(x)} \Lambda^{(z)} )\\
&\qquad + (-1)^{|\phi'|} h_p \At^{n-p-1}\big( \varphi' D(\Lambda^{(x)}) \Lambda^{(z)} ) \label{eq:mainzorro4}\\
&\qquad + (-1)^{|\phi'| + n} h_p \At^{n-p-1}\big( \varphi' \Lambda^{(x)} D(\Lambda^{(z)}) ) \, . \label{eq:mainzorro5}
\end{align}
Now $D(\Lambda^{(z)})$ is a linear combination of terms divisible by the $\partial_{z_j} V$, and since $h_p$ and $\At$ are $k[z]$-linear these coefficients pass through to annihilate with the denominator in the residue in  (\ref{eq:bracketkl}). 

Similarly $\varphi' D(\Lambda^{(x)}) \Lambda^{(z)}$ is a sum of terms of the form $f_j \alpha$ for various $j$. But the Atiyah class and the commutator $[\Lambda_{i_1,\ldots,i_p}, \nabla]$ are right linear (TODO: explain right action on $\Bar$?) so
\begin{align*}
h_p \At^{n-p-1}\big( \alpha f_j ) &= h_p\left( \At^{n-p-1}(\alpha) \cdot f_j \right)\\
&= \sum_{\ell(\bs{i}) = p} (-1)^{\gamma(\bs{i}) +p} \Big\langle\!\Big\langle \nabla \left\{ f_{i_1} \cdots \nabla f_{i_p} \str\big( [ \Lambda_{i_1,\ldots,i_p}, \nabla]\At^{n-p-1}(\alpha) \big) \cdot f_j \right\} \Big\rangle\!\Big\rangle\,.
\end{align*}
But $\nabla( f_{i_1} \beta f_j ) = f_{i_1} \nabla( \beta f_j ) + df_{i_1} \beta f_j$. The first summand vanishes in the residue for obvious reasons, and the second vanishes since by Lemma~\ref{lem:PsiToTheRight}
\[
\dlangle - \cdot f_j \drangle = \dlangle - \drangle \cdot f_j(x')
\]
which vanishes in the residue.

The upshot is that (\ref{eq:mainzorro4}) and (\ref{eq:mainzorro5}) do not contribute under the residue, so that
\[
\langle H, - \rangle_X = 
\frac{1}{n!} \sum_{\sigma \in S_n}\sum_{p=0}^{n-1} (-1)^{|\sigma|} \Res_{k[x,z]/k} \left[ \frac{ h_p \At^{n-p-1}( D(-) \Lambda^{(x)} \Lambda^{(z)} ) \underline{\operatorname{d}\!x} \underline{\operatorname{d}\!z}}{\partial_{x_1}W \ldots \partial_{x_n} W \partial_{z_1} V \ldots \partial_{z_m} V} \right]\,.
\]
This proves that $\langle H, - \rangle_X$ is null-homotopic, and thus $\langle \mathcal{Z}, - \rangle_X$ and $\langle 1_X, - \rangle_X$ are homotopic functionals. Hence by the non-degeneracy of Theorem~\ref{theorem:generalkl} we conclude that $\mathcal{Z}$ and $1_X$ are homotopic.
\end{proof}

The three other Zorro moves are proven analogously (\textbf{todo}).

\begin{theorem}
The bicategory $\LG$ has left and right adjoints. Explicit expressions for the evaluation and coevaluation maps are given by~\eqref{TODO}. 
\end{theorem}


\begin{remark}
The same result also holds for the graded bicategory $\LG^{\mathrm{gr}}$ of Remark~\ref{remark:gradedbicategory}. To see this all we have to check is that the evaluation and coevaluation 2-morphisms have $\nZ$-degree~0. For a potential~$W$ of degree $2c$ we fix the $\nZ$-grading of the unit $\Delta_W$ by assigning degree $-c$ to the~$\theta_i$ in~\eqref{DeltaW}; similarly an $n$-form in the bar complex~\eqref{BarComplex} has degree $-nc$. In this way both the left and right unit actions $\lambda, \rho$ as well as their homotopy inverses manifestly have degree~0. Furthermore, by Definition~\ref{def:coeval} the coevaluation is the image of the (degree~0) identity under the sequence of (degree~0) maps~\eqref{eq:isogivescoev2} and thus has degree~0. That the evaluation also has degree~0 then follows from the Zorro move. 
\end{remark}



\subsection{Pivotality}

We end this section by clarifying the relation between the adjunctions given by $\eval_X, \coev_X$ and $\widetilde\eval_X, \widetilde\coev_X$. They describe~$X^\dual$ as the right and left adjoint to~$X$, respectively. So far we have trated these maps independently, but of course they are closely related. The precise connection is via a pivotal structure, which is the answer to the natural question about the relation between~$X$ and~$X^{\dual\dual}$: pivotality means that there is a tensor structure preserving isomorphism between every 1-morphism and its double adjoint. 

In order to establish pivotality for the bicategory $\LG$ we start be listing a few properties of the adjunction maps. Of particular importance is the identity~\eqref{eq:monoidalproperty} which we will later need for applications in Sections~\ref{sec:defectaction} and~\ref{sec:CardyCondition}, e.\,g.~to prove the Cardy condition. 

For a map $\varphi: X \lra Y$ between matrix factorisations 
\begin{align*}
X & \in \hmf(k[x_1,\ldots,x_n,y_1,\ldots,y_m], W_2(y)-W_1(x)) \, , \\
Y & \in \hmf(k[y_1,\ldots,y_m,z_1,\ldots,z_p], W_3(z)-W_2(y))
\end{align*}
we define its adjoint to be
$$
\varphi^\dual = \varphi^\vee[m] : Y^\dual \lra X^\dual \, .
$$

\begin{proposition}\label{prop.morphismmigration}
For a 2-morphism $\varphi: X \lra Y$ in $\LG$ we have
\begin{enumerate}
\item $\eval_Y \circ (1_{Y^\dual} \otimes \varphi) = \eval_X \circ (\varphi^\dual \otimes 1_X)$, 
\item $(\varphi \otimes 1_{X^\dual}) \circ \coev_X = (1_Y \otimes \varphi^\dual) \circ \coev_Y$, 
\item $\varphi^\dual = \lambda_{X^\dual} \circ (\eval_Y \otimes 1_{X^\dual}) \circ (1_{Y^\dual} \otimes \varphi \otimes 1_{X^\dual}) \circ (1_{Y^\dual} \otimes \coev_X) \circ \rho^{-1}_{Y^\dual}$
\end{enumerate}
and similarly for $\widetilde\eval$ and $\widetilde\coev$. Diagramatically the above identities read
$$
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\fill (3,0.5) circle (2.5pt) node[right] {{\small $\varphi$}};
\draw (3,0.65) -- (3,0)
node[below] {{{\small$X\vphantom{Y^\dual}$}}};
\draw (2,0.65) -- (2,0)
node[below] {{{\small$Y^\dual$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\fill (2,0.5) circle (2.5pt) node[left] {{\small $\varphi^\dual$}};
\draw (3,0.65) -- (3,0)
node[below] {{{\small$X\vphantom{Y^\dual}$}}};
\draw (2,0.65) -- (2,0)
node[below] {{{\small$Y^\dual$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
\, , \qquad
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (2,0.5) circle (2.5pt) node[left] {{\small $\varphi$}};
\draw (3,0.35) -- (3,1)
node[above] {{{\small$X^\dual$}}};
\draw (2,0.35) -- (2,1)
node[above] {{{\small$Y$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (3,0.5) circle (2.5pt) node[right] {{\small $\varphi^\dual$}};
\draw (3,0.35) -- (3,1)
node[above] {{{\small$X^\dual$}}};
\draw (2,0.35) -- (2,1)
node[above] {{{\small$Y$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
\, , \qquad
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\fill (3,0.5) circle (2.5pt) node[right] {{\small $\varphi^\dual$}};
\draw (3,0) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (3,0) -- (3,-0.5)
node[below] {{{\small$Y^\dual$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (2,0.5) circle (2.5pt) node[right] {{\small $\varphi$}};
\draw (2,0.32) -- (2,0.68);
\draw[line width=0pt] 
(2,0.5) node[line width=0pt] (D) {}
(1,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,+1) and +(0,+1) .. (s);
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (1,0.65) -- (1,-0.5)
node[below] {{{\small$Y^\dual$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
\, . 
$$
\end{proposition}

\begin{proof}
The first identity follows immediately from the explicit expression for the evaluation in terms of the supertrace. To prove the third identity we only have to apply the Zorro move and use part~(i), and then the third identity follows by appending another upwards-oriented $Y$-line to the left and another Zorro move: 
$$
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\fill (3,0.5) circle (2.5pt) node[right] {{\small $\varphi^\dual$}};
\draw (3,0) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (3,0) -- (3,-0.5)
node[below] {{{\small$Y^\dual$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (1,0.5) circle (2.5pt) node[right] {{\small $\varphi^\dual$}};
\draw (2,0.32) -- (2,0.68);
\draw[line width=0pt] 
(2,0.5) node[line width=0pt] (D) {}
(1,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,+1) and +(0,+1) .. (s);
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (1,0.65) -- (1,-0.5)
node[below] {{{\small$Y^\dual$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (2,0.5) circle (2.5pt) node[right] {{\small $\varphi$}};
\draw (2,0.32) -- (2,0.68);
\draw[line width=0pt] 
(2,0.5) node[line width=0pt] (D) {}
(1,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,+1) and +(0,+1) .. (s);
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (1,0.65) -- (1,-0.5)
node[below] {{{\small$Y^\dual$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
\Rightarrow
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (3,0.5) circle (2.5pt) node[left] {{\small $\varphi^\dual$}};
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (2,0.35) -- (2,1.5)
node[above] {{{\small$Y$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (2,0.5) circle (2.5pt) node[right] {{\small $\varphi$}};
\draw (2,0.32) -- (2,0.68);
\draw[line width=0pt] 
(2,0.5) node[line width=0pt] (D) {}
(1,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,+1) and +(0,+1) .. (s);
\draw[line width=0pt] 
(1,0.5) node[line width=0pt] (D) {}
(0,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\draw (1,0.32) -- (1,0.68);
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (0,0.32) -- (0,1.5)
node[above] {{{\small$Y$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (2,0.5) circle (2.5pt) node[right] {{\small $\varphi$}};
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X^\dual$}}};
\draw (2,0.35) -- (2,1.5)
node[above] {{{\small$Y$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
\, . 
$$
The obvious analogous identities for $\widetilde\eval$ and $\widetilde\coev$ follow in the same way. 
\end{proof}


\begin{proposition}\label{prop:monoidalproperty}
For two matrix factorisations $X\in \hmf(k[x_1,\ldots,x_n,y_1,\ldots,y_m], W_2(y)-W_1(x))$ and $Y\in \hmf(k[y_1,\ldots,y_m,z_1,\ldots,z_p], W_3(z)-W_2(y))$ we have
\be\label{eq:monoidalproperty}
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]
\draw[line width=1pt] 
(-2,-1) node[line width=0pt] (X) {{\small $Y^\dual$}}
(-1,-1) node[line width=0pt] (Y) {{\small $X^\dual$}}
(2,2) node[line width=0pt] (XY) {{\small $(X\otimes Y)^\dual$}}; 
\draw[directed] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,2) and +(0,2) .. (-2,0);
\draw[directed] (2,0) .. controls +(0,-1) and +(0,-1) .. (0.5,0);
\draw (-1,0) -- (Y);
\draw (-2,0) -- (X);
\draw[dotted] (0,0) -- (1,0);
\draw (2,0) -- (XY);
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]
\draw[line width=1pt] 
(2,-1) node[line width=0pt] (Y) {{\small $Y^\dual$}}
(3,-1) node[line width=0pt] (X) {{\small $X^\dual$}}
(-1,2) node[line width=0pt] (XY) {{\small $(X\otimes Y)^\dual$}}; 
\draw[directed] (1,0) .. controls +(0,1) and +(0,1) .. (2,0);
\draw[directed] (0,0) .. controls +(0,2) and +(0,2) .. (3,0);
\draw[directed] (-1,0) .. controls +(0,-1) and +(0,-1) .. (0.5,0);
\draw (2,0) -- (Y);
\draw (3,0) -- (X);
\draw[dotted] (0,0) -- (1,0);
\draw (-1,0) -- (XY);
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
\, . 
\ee
\end{proposition}

\begin{proof}
TODO: include signs!

We start by computing the left-hand side of~\eqref{eq:monoidalproperty}. As explained in the previous section one may choose a representative for $\coev_{Y\otimes X}$ where all Atiyah classes act only on the single factor~$Y$ in the tensor product $Y\otimes X \otimes (Y\otimes X)^\dual$. Hence the Zorro move for the $Y^\dual$-line can be performed, after which the only contribution left from $\coev_{Y\otimes X}$ is the sum $\sum_i e_i \otimes e_i^*$ for a basis $\{e_i\}$ of~$X$. Applying the remaining map $\lambda_{(Y\otimes X)^\dual} \circ (\eval_X \otimes 1_{(Y\otimes X)^\dual})$ we compute that the left-hand side of~\eqref{eq:monoidalproperty} maps $\alpha\otimes \beta \in X^\dual \otimes Y^\dual$ to 
$$
\sum_i \Res_{k[x,y,z]/k[x,z]} \left[ \frac{\str \big( (e_i \circ \alpha \circ \Lambda^{(y)}_X \big)\cdot e_i^* \otimes \beta \, \underline{\operatorname{d}\!y}}{\partial_{y_1} W_2 \ldots \partial_{y_m} W_2} \right]
= 
\Res_{k[x,y,z]/k[x,z]} \left[ \frac{\str ( \alpha \circ \Lambda^{(y)}_X)(\alpha) \otimes \beta \, \underline{\operatorname{d}\!y}}{\partial_{y_1} W_2 \ldots \partial_{y_m} W_2} \right] . 
$$
The argument for the right-hand side of~\eqref{eq:monoidalproperty} is analogous and we find 
\begin{align*}
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]
\draw[line width=1pt] 
(-2,-1) node[line width=0pt] (X) {{\small $Y^\dual$}}
(-1,-1) node[line width=0pt] (Y) {{\small $X^\dual$}}
(2,2) node[line width=0pt] (XY) {{\small $(X\otimes Y)^\dual$}}; 
\draw[directed] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,2) and +(0,2) .. (-2,0);
\draw[directed] (2,0) .. controls +(0,-1) and +(0,-1) .. (0.5,0);
\draw (-1,0) -- (Y);
\draw (-2,0) -- (X);
\draw[dotted] (0,0) -- (1,0);
\draw (2,0) -- (XY);
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
& =
\Res_{k[x,y,z]/k[x,z]} \left[ \frac{\str ( \Lambda^{(y)}_{X^\dual} \otimes 1) \, \underline{\operatorname{d}\!y}}{\partial_{y_1} W_2 \ldots \partial_{y_m} W_2} \right] ,
\\
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]
\draw[line width=1pt] 
(2,-1) node[line width=0pt] (Y) {{\small $Y^\dual$}}
(3,-1) node[line width=0pt] (X) {{\small $X^\dual$}}
(-1,2) node[line width=0pt] (XY) {{\small $(X\otimes Y)^\dual$}}; 
\draw[directed] (1,0) .. controls +(0,1) and +(0,1) .. (2,0);
\draw[directed] (0,0) .. controls +(0,2) and +(0,2) .. (3,0);
\draw[directed] (-1,0) .. controls +(0,-1) and +(0,-1) .. (0.5,0);
\draw (2,0) -- (Y);
\draw (3,0) -- (X);
\draw[dotted] (0,0) -- (1,0);
\draw (-1,0) -- (XY);
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
& = 
\Res_{k[x,y,z]/k[x,z]} \left[ \frac{\str ( 1 \otimes \Lambda^{(y)}_{Y^\dual}) \, \underline{\operatorname{d}\!y}}{\partial_{y_1} W_2 \ldots \partial_{y_m} W_2} \right] .
\end{align*}

To show that the above two expressions are equal up to homotopy we again make use of the non-degeneracy of the Kapustin-Li pairing. To wit, we have to show that the difference~$\delta$ of the two maps paired with any closed map $\Phi\in \Hom((Y\otimes X)^\dual, X^\dual \otimes Y^\dual)$ gives zero, i.\,e.~$\langle \Phi, \delta \rangle_{X^\dual \otimes Y^\dual} = 0$. Evaluating this pairing gives
$$
\Res_{k[x,y,z]/k} \left[ \frac{\str \big( \Phi \circ (\Lambda^{(y)}_{X^\dual} \otimes 1 - 1 \otimes \Lambda^{(y)}_{Y^\dual})) \circ (\Lambda^{(x)}_{X^\dual} \otimes \Lambda^{(z)}_{Y^\dual}) \big) \,\underline{\operatorname{d}\!x} \underline{\operatorname{d}\!y} \underline{\operatorname{d}\!z}}{(\prod_{i=1}^n \partial_{x_i} W_1) (\prod_{j=1}^m \partial_{y_j} W_2) (\prod_{l=1}^p \partial_{z_l} W_3)} \right] , 
$$
but since $\partial_{y_j} d_{X^\dual} \otimes 1$ is as good a homotopy for the action of $\partial_{y_j} W_2$ on $X^\dual \otimes Y^\dual$ as $1\otimes \partial_{y_j} d_{X^\dual}$, the above residue indeed vanishes. 
\end{proof}


\begin{definition}\label{def.pivotal}
We call a bicategory with right adjoints \textsl{pivotal} if for each 1-morphism~$X$ there is a natural monoidal 2-isomorphism $\delta_X: X\lra X^{\dual\dual}$. It then follows that~$X^\dual$ is also left adjoint to~$X$, with adjunction maps $\widetilde\eval_X = \eval_{X^\dual}\circ (\delta_X \otimes 1_{X^\dual})$ and $\widetilde\coev_X = (1_{X^\dual} \otimes \delta_X^{-1} ) \circ \coev_{X^\dual}$. 
\end{definition}

As explained e.\,g.~in~\cite[Lemma~2.12]{cr1006.5609} for a 2-isomorphism $\delta_X: X\lra X^{\dual\dual}$ to be natural and monoidal is equivalent to the identities
\be\label{eq:diagrammaticDefinitionPivotal}
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(-1,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(1,-1.25) node[line width=0pt] (A2) {{\small $Y^\dual$}}; 
\fill (0,0) circle (2.5pt) node[left] {{\small $\varphi$}};
\draw[redirected] (0,0) .. controls +(0,-1) and +(0,-1) .. (-1,0);
\draw[redirected] (1,0) .. controls +(0,1) and +(0,1) .. (0,0);
\draw (-1,0) -- (A); 
\draw (1,0) -- (A2); 
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(1,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(-1,-1.25) node[line width=0pt] (A2) {{\small $Y^\dual$}}; 
\draw[directed] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,-1) and +(0,-1) .. (0,0);
\fill (0,0) circle (2.5pt) node[right] {{\small $\varphi$}};
\draw (-1,0) -- (A2); 
\draw (1,0) -- (A); 
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
\, , \qquad 
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline=0.45cm]
\draw[line width=1pt] 
(-2,-1) node[line width=0pt] (X) {{\small $Y^\dual$}}
(-1,-1) node[line width=0pt] (Y) {{\small $X^\dual$}}
(2,2) node[line width=0pt] (XY) {{\small $(X\otimes Y)^\dual$}}; 
\draw[directed] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,2) and +(0,2) .. (-2,0);
\draw[directed] (2,0) .. controls +(0,-1) and +(0,-1) .. (0.5,0);
\draw (-1,0) -- (Y);
\draw (-2,0) -- (X);
\draw[dotted] (0,0) -- (1,0);
\draw (2,0) -- (XY);
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
=
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline=0.45cm]
\draw[line width=1pt] 
(2,-1) node[line width=0pt] (Y) {{\small $Y^\dual$}}
(3,-1) node[line width=0pt] (X) {{\small $X^\dual$}}
(-1,2) node[line width=0pt] (XY) {{\small $(X\otimes Y)^\dual$}}; 
\draw[directed] (1,0) .. controls +(0,1) and +(0,1) .. (2,0);
\draw[directed] (0,0) .. controls +(0,2) and +(0,2) .. (3,0);
\draw[directed] (-1,0) .. controls +(0,-1) and +(0,-1) .. (0.5,0);
\draw (2,0) -- (Y);
\draw (3,0) -- (X);
\draw[dotted] (0,0) -- (1,0);
\draw (-1,0) -- (XY);
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%
\ee
to hold for every 2-morphism $\varphi: X \lra Y$.  

In the case of the bicategory $\LG$ we claim that a pivotal structure is given by 
\be\label{delta}
\delta_X = 
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (2.6,-0.3) circle (0pt) node[below] {{\small $\coev_{X^\dual}$}};
\draw (2,0.32) -- (2,0.68);
\draw[line width=0pt] 
(1,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,+1) and +(0,+1) .. (s);
\fill (1.6,1.23) circle (0pt) node[above] {{\small $\widetilde\eval_{X}$}};
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X^{\dual\dual}$}}};
\draw (1,0.65) -- (1,-0.5)
node[below] {{{\small$X$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
\, , \qquad 
\delta_X^{-1} = 
%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.4cm]
\draw[line width=0pt] 
(3,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,-1) and +(0,-1) .. (s);
\fill (2.6,-0.28) circle (0pt) node[below] {{\small $\widetilde\coev_{X}$}};
\draw (2,0.32) -- (2,0.68);
\draw[line width=0pt] 
(1,0.5) node[line width=0pt] (D) {}
(2,0.5) node[line width=0pt] (s) {}; 
\draw[directed] (D) .. controls +(0,+1) and +(0,+1) .. (s);
\fill (1.6,1.23) circle (0pt) node[above] {{\small $\eval_{X^\dual}$}};
\draw (3,0.35) -- (3,1.5)
node[above] {{{\small$X$}}};
\draw (1,0.65) -- (1,-0.5)
node[below] {{{\small$X^{\dual\dual}$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%
\ee
in terms of our maps $\eval, \coev, \widetilde\eval, \widetilde\coev$ from Section~\ref{sec:derivcoeval}. As a consistency check the Zorro moves immediately imply that in any bicategory with coinciding left and right adjoints the map~$\delta_X$ defined in~\eqref{delta} satisfies $\widetilde\eval_X = \eval_{X^\dual}\circ (\delta_X \otimes 1_{X^\dual})$ and $\widetilde\coev_X = (1_{X^\dual} \otimes \delta_X^{-1} ) \circ \coev_{X^\dual}$ as in Definition~\ref{def.pivotal}. Furthermore, $\delta$ is natural as $\eval, \coev, \widetilde\eval, \widetilde\coev$ satisfy the ``morphism migration properties''~(i) and~(ii) of Proposition~\ref{prop.morphismmigration}: naturality is equivalent to the first condition in~\eqref{eq:diagrammaticDefinitionPivotal}, which is easily seen to hold using the morphism mirgration properties together with another application of Zorro moves. 

\begin{theorem}
$\LG$ is pivotal. The pivotal structure~$\delta$ is the canonical one given by $(\delta_X(a))(\Phi) = \sigma(\Phi(a))$ for all $a\in X\in \hmf(R\otimes_k S, V-W), \Phi\in X^\dual \in \hmf(S\otimes_k R, W-V)$, where $\sigma: R\otimes_k S \lra S\otimes_k R$ is the linear map that swaps tensor factors. 
\end{theorem}

\begin{proof}
The fact that~\eqref{delta} is the canonical map given in the statement of the theorem follows from the explicit expressions for the adjunction maps: $\delta_X$ is simply the Zorro map~\eqref{eq:trueproofeq2} with $e_j$ replaced by $e_j^{**}$. 

It remains to be shown that~$\delta$ is monoidal in the case of $\LG$. This is equivalent to the statement of Proposition~\ref{prop:monoidalproperty}. 
\end{proof}


\section{Defect action on bulk fields}\label{sec:defectaction}

In any bicategory with adjoints there are natural maps between the endomorphism spaces of unit 1-morphisms. Roughly, these maps are constructed by capturing a 2-morphism of a unit 1-morphism inside a loop labelled by an arbitrary 1-morphism (and its adjoint). Below we present the details for the case of the bicategory $\LG$. We will also give the interpretation in terms of defect actions on bulk fields in Landau-Ginzburg models. 

Let $X\in \hmf(k[x,z], V-W)$ as before. In this section when we write $\End$ we mean the spaces of 2-endomorphisms in $\LG$. We define maps 
$$
\mathcal D_l(X): \End(\Delta_V) \longrightarrow \End(\Delta_W) \, , \qquad
\mathcal D_r(X): \End(\Delta_W) \longrightarrow \End(\Delta_V)
$$
in terms of the morphisms encoding the monoidal and adjunction structures as follows. For $\phi\in \End(\Delta_V)$ and $\psi\in \End(\Delta_W)$ we set
\begin{align*}
\mathcal D_l(X)(\phi) & = \eval_X \circ (1_{X^\dual}\otimes (\lambda_X \circ (\phi\otimes 1_X)\circ \lambda_X^{-1})) \circ \widetilde\coev_X \, , \\ 
\mathcal D_r(X)(\psi) & = \widetilde\eval_X \circ (1_{X}\otimes (\lambda_{X^\dual} \circ (\phi\otimes 1_{X^\dual})\circ \lambda_{X^\dual}^{-1})) \circ \coev_X \, .
\end{align*}
In the special case $\phi=1$ and $\psi=1$ we obtain the left and right \textsl{quantum dimensions} $\operatorname{qdim}_l(X) = \mathcal D_l(X)(1)$ and $\operatorname{qdim}_r(X) = \mathcal D_r(X)(1)$. 

Diagrammatically these definitions read
\be\label{defectaction}
\mathcal D_l(X)(\phi) =
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\nicepalecolourscheme (0,0) circle (3.5);
\fill (-2.2,-2.2) circle (0pt) node[white] {{\small$W$}};
\nicecolourscheme (0,0) circle (2);
\fill (-1.1,-1.1) circle (0pt) node[white] {{\small$V$}};
%
\fill (180:2) circle (0pt) node[left] {{\small$x\vphantom{z'}$}};
\fill (180:2) circle (0pt) node[right] {{\small$z\vphantom{z'}$}};
\fill (0:2) circle (0pt) node[left] {{\small$z'\vphantom{z'}$}};
\fill (0:2) circle (0pt) node[right] {{\small$x'\vphantom{z'}$}};
\draw (0,0) circle (2);
\draw[<-, very thick] (0.100,-2) -- (-0.101,-2) node[above] {}; 
\draw[<-, very thick] (-0.100,2) -- (0.101,2) node[below] {}; 
\fill (135:0) circle (3.3pt) node[left] {{\small$\psi$}};
\fill (50:2) circle (3.3pt) node[right] {{\small$\lambda_{X}$}};
\fill (-50:2) circle (3.3pt) node[right] {{\small$\lambda^{-1}_{X}$}};
\draw[dashed] (135:0) .. controls +(0,1) and +(-0.5,-1) .. (50:2);
\fill (0.41,1.15) circle (0pt) node {{\small $\Delta_V$}};
\fill (0.41,-1.15) circle (0pt) node {{\small $\Delta_V$}};
\draw[dashed] (135:0) .. controls +(0,-1) and +(-0.5,1) .. (-50:2);
\draw[dashed] (270:2) -- (270:3.3)
node[near end,right] {{{\small$\Delta_W$}}};
\draw[dashed] (90:2) -- (90:3.3)
node[near end,right] {{{\small$\Delta_W$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]
%
%\fill (1.5,1.3) circle (2.5pt) node[right] {{\small $\lambda_X$}};
%\fill (1.5,-1.3) circle (2.5pt) node[right] {{\small $\lambda^{-1}_X$}};
%\fill (0,0) circle (2.5pt) node[left] {{\small $\phi$}};
%
%\fill (0.6,1) circle (0pt) node {{\small $\Delta_V$}};
%\fill (0.6,-0.95) circle (0pt) node {{\small $\Delta_V$}};
%
%\draw[directed] (1.5,1.3) .. controls +(0,1.5) and +(0,1.5) .. (-1.5,1.3);
%\draw[directed] (-1.5,-1.3) .. controls +(0,-1.5) and +(0,-1.5) .. (1.5,-1.3);
%\draw (1.5,-1.3) -- (1.5,1.3)
%node[midway,left] {{{\footnotesize$z'\vphantom{y}$}}}
%node[midway,right] {{{\footnotesize$y\vphantom{yz'}$}}};
%\draw (-1.5,-1.3) -- (-1.5,1.3)
%node[midway,left] {{{\footnotesize$x\vphantom{yz'}$}}}
%node[midway,right] {{{\footnotesize$z\vphantom{yz'}$}}};
%\draw[dashed] (0,0) .. controls +(0,1) and +(-0.5,-1) .. (1.5,1.3);
%\draw[dashed] (0,0) .. controls +(0,-1) and +(-0.5,1) .. (1.5,-1.3);
%\draw[dashed] (0,-2.5) -- (0,-3.5)
%node[near end,right] {{{\small$\Delta_W$}}};
%\draw[dashed] (0,2.47) -- (0,3.5)
%node[near end,right] {{{\small$\Delta_W$}}};
%\end{tikzpicture}
\, , \qquad 
\mathcal D_r(X)(\psi) = 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\nicepalecolourscheme (0,0) circle (3.5);
\fill (-2.2,-2.2) circle (0pt) node[white] {{\small$V$}};
\nicecolourscheme (0,0) circle (2);
\fill (-1.1,-1.1) circle (0pt) node[white] {{\small$W$}};
%
\fill (180:2) circle (0pt) node[left] {{\small$z\vphantom{z'}$}};
\fill (180:2) circle (0pt) node[right] {{\small$x\vphantom{z'}$}};
\fill (0:2) circle (0pt) node[left] {{\small$x'\vphantom{z'}$}};
\fill (0:2) circle (0pt) node[right] {{\small$z'\vphantom{z'}$}};
\draw (0,0) circle (2);
\draw[<-, very thick] (0.100,2) -- (-0.101,2) node[above] {}; 
\draw[<-, very thick] (-0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (135:0) circle (3.3pt) node[left] {{\small$\psi$}};
\fill (50:2) circle (3.3pt) node[right] {{\small$\lambda_{X^\dual}$}};
\fill (-50:2) circle (3.3pt) node[right] {{\small$\lambda^{-1}_{X^\dual}$}};
\draw[dashed] (135:0) .. controls +(0,1) and +(-0.5,-1) .. (50:2);
\fill (0.4,1.15) circle (0pt) node {{\small $\Delta_W$}};
\fill (0.4,-1.15) circle (0pt) node {{\small $\Delta_W$}};
\draw[dashed] (135:0) .. controls +(0,-1) and +(-0.5,1) .. (-50:2);
\draw[dashed] (270:2) -- (270:3.3)
node[near end,right] {{{\small$\Delta_V$}}};
\draw[dashed] (90:2) -- (90:3.3)
node[near end,right] {{{\small$\Delta_V$}}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]
%
%\fill (1.5,1.3) circle (2.5pt) node[right] {{\small $\lambda_{X^\dual}$}};
%\fill (1.5,-1.3) circle (2.5pt) node[right] {{\small $\lambda^{-1}_{X^\dual}$}};
%\fill (0,0) circle (2.5pt) node[left] {{\small $\psi$}};
%
%\fill (0.6,1) circle (0pt) node {{\small $\Delta_W$}};
%\fill (0.6,-0.95) circle (0pt) node {{\small $\Delta_W$}};
%
%\draw[redirected] (1.5,1.3) .. controls +(0,1.5) and +(0,1.5) .. (-1.5,1.3);
%\draw[redirected] (-1.5,-1.3) .. controls +(0,-1.5) and +(0,-1.5) .. (1.5,-1.3);
%\draw (1.5,-1.3) -- (1.5,1.3)
%node[midway,left] {{{\footnotesize$y\vphantom{yz'}$}}}
%node[midway,right] {{{\footnotesize$z'\vphantom{yz'}$}}};
%\draw (-1.5,-1.3) -- (-1.5,1.3)
%node[midway,left] {{{\footnotesize$z\vphantom{yz'}$}}}
%node[midway,right] {{{\footnotesize$x\vphantom{yz'}$}}};
%\draw[dashed] (0,0) .. controls +(0,1) and +(-0.5,-1) .. (1.5,1.3);
%\draw[dashed] (0,0) .. controls +(0,-1) and +(-0.5,1) .. (1.5,-1.3);
%\draw[dashed] (0,-2.5) -- (0,-3.5)
%node[near end,right] {{{\small$\Delta_V$}}};
%\draw[dashed] (0,2.47) -- (0,3.5)
%node[near end,right] {{{\small$\Delta_V$}}};
%\end{tikzpicture}
\ee
where again we indicated our choice of variable names in the four domains, and both loops are labelled by~$X$. 

\begin{remark}
$\End(\Delta_W) = k[x]/(\partial_{x_i}W)$ is the Hochschild cohomology of $\hmf(k[x], W)$~\cite{d0904.4713}. This space also precisely describes bulk fields of Landau-Ginzburg models with potential~$W$, it is a commutative Frobenius algebra whose non-degenerate pairing
\be\label{bulktopmet}
\langle \phi, \psi \rangle_W = (-1)^n \Res_{k[x]/k} \left[ \frac{\phi \psi \, \underline{\operatorname{d}\!x}}{\partial_{x_1}W\ldots\partial_{x_n} W}\right]
\ee
describes two-point correlators on the sphere. Furthermore, matrix factorisations of $V-W$ describe defect conditions between different Landau-Ginzburg models. Hence the maps~\eqref{defectaction} have the natural interpretations in terms of defect operators on bulk fields: for example, a bulk field~$\phi$ in the theory with potential~$V$ is mapped to the bulk field $\mathcal D_l(X)(\phi)$ in the theory with potential~$W$ by wrapping around its insertion on the worldsheet a defect line labelled by~$X$, and then collapsing this loop onto the insertion point. This limiting process is non-singular as the bicategory $\LG$ describes the purely topological sector of Landau-Ginzburg models. 

As already observed in Section~\ref{sec:Introduction}, for the special case $V=0$ the right defect action in~\eqref{defectaction} is precisely the disk correlator of the bulk field~$\psi$ in the presence of the boundary condition~$X$. If we allow for boundary field insertions on the $X$-line we naturally recover the general disk correlator as a 2-morphism in our setting, as follows from the proof of Proposition~\ref{prop:defectaction}. This is another example of the general fact that string diagrams in the bicategory $\LG$ exactly compute the correlators of worldsheets with insertions that they intuitively depict. 
\end{remark}

Using the ``folding trick'' (which relates defects to boundary conditions in a product theory) one can argue for explicit expressions for $\mathcal D_l(X)$ and $\mathcal D_r(X)$. This was done in~\cite{cr1006.5609} for the case $V=W$. Here we use our adjunction formulas to directly prove it for the general case: 

\begin{proposition}\label{prop:defectaction}
For any $X\in \hmf(k[x_1,\ldots,x_n,z_1,\ldots,z_m], V-W)$, $\phi\in \End(\Delta_V)$ and $\psi\in \End(\Delta_W)$ we have
\begin{align*}
\mathcal D_l(X)(\phi) & = (-1)^{{m+1\choose 2} + {n\choose 2}} \Res_{k[x,z]/k[x]} \left[ \frac{\phi(z) \str\big( \partial_{z_1} d_{X}\ldots \partial_{z_m} d_{X} \partial_{x_1} d_{X}\ldots \partial_{x_n} d_{X} \big) \underline{\operatorname{d}\! z}}{\partial_{z_1} V \ldots \partial_{z_m} V} \right] \, , \\
\mathcal D_r(X)(\psi) & = (-1)^{{m\choose 2} + {n+1\choose 2}} \Res_{k[x,z]/k[z]} \left[ \frac{\psi(x) \str\big( \partial_{z_1} d_{X}\ldots \partial_{z_m} d_{X} \partial_{x_1} d_{X}\ldots \partial_{x_n} d_{X} \big) \underline{\operatorname{d}\! x}}{\partial_{x_1} W \ldots \partial_{x_n} W} \right] \, . 
\end{align*}
\end{proposition}

\begin{proof}
We treat the case of $\mathcal D_l(X)$ in detail, the argument for $\mathcal D_r(X)$ works analogously. Since $\End(\Delta_W) = k[x]/(\partial_{x_i}W)$ and $\End(\Delta_V) = k[z]/(\partial_{z_i}V)$ we are free to set $x=y$ and $z=z'$ at appropriate places, cf.~\eqref{defectaction}. Furthermore, $\lambda_X$ will project out all non-zero degree contributions coming from the action of $\lambda_X^{-1}$, so $\lambda_X\circ (\phi \otimes 1_X)\circ \lambda_X^{-1}$ is simply multiplication by the polynomial $\phi(z)$. 

In the lower part of the expression for $\mathcal D_l(X)(\phi)$ in~\eqref{defectaction} we have 
\begin{align}
\widetilde\coev (1) & = \sum_j (-1)^{|e_j|} (\varepsilon\Psi) \left( (-\At_{X})^n (e_j^*\otimes e_j) \right) \nonumber \\
& = \sum_j (-1)^{|e_j| + n} (-1)^{(|e_j| + 1)+\ldots +(|e_j| + n) + n|e_j|} e^*_{j} \otimes e_{k_n} \otimes (\varepsilon\Psi) \left( d(d_{X})_{k_n k_{n-1}} \ldots d(d_{X})_{k_1 j} \right) \nonumber \\
& = \sum_j (-1)^{|e_j|(|e_j| + n) + {n+1\choose 2} + n} e_j^* \otimes e_{k_n}\big( \partial_{[1]} d_{X} \ldots \partial_{[n]} d_{X} \big)_{k_n j} \nonumber \\
& = \sum_j (-1)^{|e_j|(|e_j| + n) + {n\choose 2}} e_j^* \otimes \big( \partial_{x_1} d_{X} \ldots \partial_{x_n} d_{X} \big) (e_{j}) \label{coevtilde1}
\end{align}
which we identify with $(-1)^{{n\choose 2}} \partial_{x_1} d_{X} \ldots \partial_{x_n} d_{X}$ in $\End(X)$. Note that in the last step leading to~\eqref{coevtilde1} we set $\partial_{[i]} d_{X}(x,z) = \partial_{x_i} d_{X}(x,z)$ since $x=x'$ in $\End(\Delta_W)$. 

Next we apply the upper part of $\mathcal D_l(X)(\phi)$ in~\eqref{defectaction} to~\eqref{coevtilde1} to get
$$
\mathcal D_l(X)(\phi) = (-1)^{{m+1\choose 2} + {n\choose 2}} \Res_{k[x,z]/k[x]} \left[ \frac{\phi(z) \str\big( \partial_{z_1} d_{X}\ldots \partial_{z_m} d_{X} \partial_{x_1} d_{X}\ldots \partial_{x_n} d_{X} \big) \underline{\operatorname{d}\! z}}{\partial_{z_1} V \ldots \partial_{z_m} V} \right] + \mathcal O(\theta) \, . 
$$
Here we collectively denote the contributions from $\eval_X$ of non-zero degree in the Koszul complex $\Delta_W$ by $\mathcal O(\theta)$. Since we know that $\mathcal D_l(X)(\phi)$ is a morphism in $\End(\Delta_W) = k[x]/(\partial_{x_i}W)$ it follows that $\mathcal O(\theta)$ must be null-homotopic, thus concluding the proof. 
\end{proof}

\begin{corollary}
For any $X\in \hmf(k[x,z], V-W)$ the operators $\mathcal D_l(X)$ and $\mathcal D_r(X)$ are adjoint with respect to the pairings~\eqref{bulktopmet}, i.\,e.~we have
\be\label{Dadjoint}
\big\langle \mathcal D_l(X)(\phi), \psi \big\rangle_W = \big\langle \phi , \mathcal D_r(X)(\psi) \big\rangle_V
\ee
for all $\phi\in \End(\Delta_V)$ and $\psi\in \End(\Delta_W)$. 
\end{corollary}

\begin{proof}
This directly follows from the explicit expressions for $\mathcal D_l(X)$, $\mathcal D_r(X)$ and $\big\langle -, -\big\rangle_W$, $\big\langle -, -\big\rangle_V$, together with the transitivity rule for residues. 
\end{proof}


\begin{remark}
We recall the physical interpretation of the relation~\eqref{Dadjoint}. Both sides of this equation are two-point correlators on the Riemann sphere, with a defect line labelled by~$X$ wrapped around counterclockwise the bulk field~$\phi$, or wrapped around~$\psi$ in clockwise fashion. That both correlators should be equal follows from the fact that the topological defect can be moved around the sphere at no cost: 
$$
\left\langle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[baseline=-0.1cm]
\def\R{1.85}
\def\angEl{45}
\filldraw[ball color= white!77!blue,draw=white] (0,0) circle (\R);
\DrawLatitudeCircleU[\R,rotate=130,very thick, blue]{65}
\fill (-0.95,-0.83) circle (1.3pt) node[above] {{\small$\phi$}}; 
\fill (0.95,-0.83) circle (1.3pt) node[above] {{\small$\psi$}}; 
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\right\rangle
=
\left\langle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[baseline=-0.1cm]
\def\R{1.85}
\def\angEl{45}
\filldraw[ball color= white!77!blue,draw=white] (0,0) circle (\R);
\DrawLongitudeCircle[\R]{80}
\fill (-0.95,-0.83) circle (1.3pt) node[above] {{\small$\phi$}}; 
\fill (0.95,-0.83) circle (1.3pt) node[above] {{\small$\psi$}}; 
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\right\rangle
=
\left\langle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[baseline=-0.1cm]
\def\R{1.85}
\def\angEl{45}
\filldraw[ball color= white!77!blue,draw=white] (0,0) circle (\R);
\DrawLatitudeCircle[\R,rotate=-130, very thick, blue]{65}
\fill (-0.95,-0.83) circle (1.3pt) node[above] {{\small$\phi$}}; 
\fill (0.95,-0.83) circle (1.3pt) node[above] {{\small$\psi$}}; 
\end{tikzpicture}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\right\rangle .
$$
\end{remark}

\begin{proposition}
\begin{enumerate}
\item $\mathcal D_l(\Delta) = 1 = \mathcal D_r(\Delta)$, 
\item $\mathcal D_l(X) = \mathcal D_r(X^\dual)$, 
\item $\mathcal D_l(Y \otimes X) = \mathcal D_l(X) \circ \mathcal D_l(Y)$, 
\item $\mathcal D_r(Y \otimes X) = \mathcal D_r(Y) \circ \mathcal D_r(X)$. 
\end{enumerate}
\label{prop:defectactionproperties}
\end{proposition}

\begin{proof}
(i) TODO: either cite Polishchuk-Vaintrob and/or use $\coev_\Delta= \lambda^{-1}_\Delta$ etc.

(ii): In the proof of the explicit formula for $\mathcal D_l(X)$ in Proposition~\ref{prop:defectaction} we could also have used the alternative representations for $\eval_X$ and $\widetilde\coev_X$ in terms of $d_{X^\dual}$. Then the assertion immediately follows. 

(iii) \& (iv): These relations follow from Proposition~\ref{prop:monoidalproperty} and a straightforward calculation with string diagrams, see e.\,g.~the proof of~\cite[Lemma~3.1]{cr1006.5609}. 
\end{proof}



\section{Shadows}\label{sec:shadows}

The adjunctions in $\LG$ afford us the construction of a bicategorical trace in terms of shadow functors~\cite{p0807.1471}. We will also see that shadows allow to recover and generalise the boundary-bulk and bulk-boundary maps of the two-dimensional topological field theories based on Landau-Ginzburg models. 

\begin{definition}
A bicategory~$\mathcal B$ \textsl{has shadows} if there is a category~$\mathcal C$ together with functors
$$
\langle\!\langle - \rangle\!\rangle : \mathcal B(A,A) \lra \mathcal C 
$$
for every object $A\in \mathcal B$ such that there are natural isomorphisms $\theta : \langle\!\langle X \otimes Y \rangle\!\rangle \lra \langle\!\langle Y \otimes X \rangle\!\rangle$ for every pair of composable 1-morphisms $X,Y$, and the diagrams
$$
\xymatrix{%
\langle\!\langle (X \otimes Y) \otimes Z \rangle\!\rangle \ar[r]^-{\theta} \ar[d]_-{\langle\!\langle \alpha \rangle\!\rangle} & 
\langle\!\langle Z \otimes (X \otimes Y) \rangle\!\rangle \ar[r]^-{\langle\!\langle \alpha^{-1} \rangle\!\rangle} & 
\langle\!\langle (Z \otimes X) \otimes Y \rangle\!\rangle \\
\langle\!\langle X \otimes (Y \otimes Z) \rangle\!\rangle \ar[r]^-{\theta} & 
\langle\!\langle (Y \otimes Z) \otimes X \rangle\!\rangle \ar[r]^-{\langle\!\langle \alpha \rangle\!\rangle} & 
\langle\!\langle Y \otimes (Z \otimes X) \rangle\!\rangle \ar[u]_-{\theta}
}%
$$
and
$$
\xymatrix{%
\langle\!\langle X \otimes 1_A \rangle\!\rangle \ar[r]^-{\theta} \ar[dr]_-{\langle\!\langle \rho \rangle\!\rangle} & 
\langle\!\langle 1_A \otimes X \rangle\!\rangle \ar[r]^-{\theta} \ar[d]^-{\langle\!\langle \lambda \rangle\!\rangle} & 
\langle\!\langle X \otimes 1_A \rangle\!\rangle \ar[dl]^-{\langle\!\langle \rho \rangle\!\rangle}  \\
 & 
\langle\!\langle X \rangle\!\rangle & 
}%
$$
commute whenever they make sense. 
\end{definition}

\begin{proposition}
The bicategory $\LG$ has shadows given by 
\begin{align*}
\langle\!\langle - \rangle\!\rangle : \LG \big( (R,W), (R,W) \big) & \lra \hmf(k,0) \, , \\
Z & \lmt Z\otimes_{\Re} R
\end{align*}
with the isomorphism $\theta: \langle\!\langle X \otimes Y \rangle\!\rangle \lra \langle\!\langle Y\otimes X  \rangle\!\rangle$ induced by the graded swap map $X \otimes Y \lra Y \otimes X$. 
\end{proposition}

The proof is a straightforward check of the axioms, made especially easy by the fact that $\langle\!\langle - \rangle\!\rangle$ is simply defined as tensoring with the actual diagonal~$R$. Note however that this is homotopy equivalent to tensoring with the unit matrix factorisation $\Delta_W$. 

Since $\LG$ is a bicategory with adjoints and shadows it is automatically equipped with a 2-categorical trace operation as introduced and discussed at length in~\cite{p0807.1471, ps0910.1306}. We only quote the definition: 

\begin{definition}
Let~$\mathcal B$ be a bicategory with shadows and 1-morphism~$Y$ with adjoint~$Y^\dual$. Then the \textsl{trace} of a 2-morphism $\psi: X\otimes Y \lra Y \otimes Z$ is the map 
$$
\xymatrix{%
\langle\!\langle X \rangle\!\rangle \ar[rr]^-{\langle\!\langle1\otimes \coev_Y\rangle\!\rangle} && 
\langle\!\langle X \otimes Y \otimes Y^\dual \rangle\!\rangle \ar[r]^-{\langle\!\langle\psi \otimes 1\rangle\!\rangle} & 
\langle\!\langle Y \otimes Z \otimes Y^\dual \rangle\!\rangle \ar[r]^-{\theta} &
\langle\!\langle Y^\dual \otimes Y \otimes Z \rangle\!\rangle \ar[rr]^-{\langle\!\langle\eval_Y \otimes 1\rangle\!\rangle} && 
\langle\!\langle Z \rangle\!\rangle 
}%
\, . 
$$
\end{definition}

Next we wish to point out a connection between shadows and the structure of two-dimensional open/closed topological field theory (TFT) for Landau-Ginzburg models. Recall that a TFT is the data of a commutative Frobenius algebra~$C$, a Calabi-Yau category~$\mathcal O$, bulk-boundary maps $\beta_A: C \lra \End_{\mathcal O}(A)$, and boundary-bulk maps $\beta^A: \End_{\mathcal O}(A) \lra C$ for all $A\in\mathcal O$. These data are subject to several consistency conditions, see e.\,g.~\cite{TODO: Lazaroiu and Moore-Segal}. 

Every Landau-Ginzburg model with potential $W\in R = k[x_1,\ldots,x_n]$ gives rise to a TFT with $C=R/(\partial W)$, $\mathcal O = \hmf(R,W)$ and
\be\label{betaQ}
\beta_Q : \phi \lmt \phi \cdot 1_Q \, , \qquad 
\beta^Q : \psi \lmt (-1)^{n\choose 2} \str(\psi \, \partial_{x_1} d_Q \ldots \partial_{x_n} d_Q) \, . 
\ee
The hardest part in establishing this result is to prove the non-degeneracy of the Kapustin-Li pairing and that the Cardy condition holds; this was first done in~\cite{m0912.1629} and~\cite{pv1002.2116}, respectively, in the case where~$k$ is a field. In Sections~\ref{section:dualityadjointop} and~\ref{sec:CardyCondition} we will give new proofs for the general case. 

We note that the maps~\eqref{betaQ} can be recovered from the adjunction and shadow structure of $\LG$ as follows. On the one hand we have 
$$
\langle\!\langle \Delta_W \rangle\!\rangle = R/(\partial W)[n]
$$
since $\langle\!\langle \Delta_W \rangle\!\rangle = \Delta_W \otimes_{\Re} R = (\bigwedge (\bigoplus_{i=1}^n R \theta_i), \sum_{i=1}^n \partial_{x_i}W \theta_i)$ which is homotopy equivalent (and therefore equal in $\hmf(k,0)$) to $R/(\partial W)[n]$. On the other hand $\langle\!\langle Q^\dual \otimes Q \rangle\!\rangle = Q^\vee \otimes_k Q \otimes_{\Re} R = \End_R(Q)$. Thus from the explicit expressions~\eqref{TODO} and~\eqref{TODO} we find that $\beta_Q = \langle\!\langle \widetilde\coev_Q \rangle\!\rangle$ and $\beta^Q = \langle\!\langle \eval_Q \rangle\!\rangle$ (up to a sign, TODO?). 

Motivated by the above this construction can be extended to any 1-morphism in $\LG$: for $X \in \hmf(k[x_1,\ldots,x_n,z_1,\ldots,z_m], V-W)$ we define the \textsl{generalised bulk-boundary} and \textsl{boundary-bulk maps} to be
$$
\beta_X= \langle\!\langle \widetilde\coev_X \rangle\!\rangle : \langle\!\langle \Delta_{W} \rangle\!\rangle \lra \langle\!\langle X^\dual \otimes X \rangle\!\rangle
\, , \qquad 
\beta^X= \langle\!\langle \eval_X \rangle\!\rangle : \langle\!\langle X^\dual \otimes X \rangle\!\rangle \lra \langle\!\langle \Delta_{W} \rangle\!\rangle \, , 
$$
respectively. Substituting the expressions~\eqref{TODO} and~\eqref{TODO} we find that the form of $\beta_X$ stays the same while for $m\neq 0$ the generalised boundary-bulk map $\beta^X$  involves a residue and additional derivatives $\partial_{z_i} d_X$: 
\begin{align*}
\beta_X : k[x]/(\partial V)[n] & \lra \End_{k[x,z]}(X)[m] \, , \\
\phi & \lmt \phi \cdot 1_{X}[m] \, , \\
\beta^X : \End_{k[x,z]}(X)[m] & \lra k[x]/(\partial V)[n] \, , \\
\psi & \lmt (-1)^{m+1\choose 2} \Res_{k[x,z]/k[x]} \left[ \frac{\str\left( \psi\, \partial_{z_1} d_X \ldots \partial_{z_m} d_X \partial_{x_1} d_X \ldots \partial_{x_n} d_X \right) \underline{\operatorname{d}\!z}}{\partial_{z_1} W \ldots \partial_{z_m} W} \right] \, . 
\end{align*}

[TODO: comment on relation to defect action??]


\section{Cardy condition}\label{sec:CardyCondition}

As another application of our explicit expressions for adjunctions in $\LG$ in this section we present a new proof of the Cardy condition. This deep result long eluded rigorous proofs, which were only recently given in~\cite{pv1002.2116, dm1102.2957} using rather heavy machinery. With our expressions for evaluations and coevaluations in $\LG$ it will follow effortlessly for arbitrary commutative noetherian $\nQ$-algebras~$k$, such as $k=\nC[t_1,\ldots,t_d]$, simply from considerations of one single diagram. 

Let us again fix a potential $W\in k[x] = k[x_1,\ldots,x_n]$, two matrix factorisations $X,Y \in \hmf(k[x], W)$, and also two maps $\varphi: X\lra X$, $\psi: Y\lra Y$. We interpret~$X$ and~$Y$ as 1-morphisms $(k,0)\lra (k[x],W)$ in $\LG$, and in this way we obtain the 2-morphism (where here and below we do no longer display dashed lines for unit 1-endomorphisms)
\be\label{annulus}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline,>=stealth]
\nicecolourscheme (0,0) circle (2);
\nicereallynocolourscheme (0,0) circle (1);
\fill (1.5,0) circle (0pt) node[white] {{\small$W$}};
\draw (0,0) circle (2);
\draw[->, very thick] (-0.100,2) -- (-0.101,2) node[above] {{\small$\eval_Y$}}; 
\draw[->, very thick] (0.100,-2) -- (0.101,-2) node[below] {{\small$\widetilde\coev_Y$}}; 
\fill (45:2) circle (2.5pt) node[right] {{\small$\psi$}};
%
\draw (0,0) circle (1);
\draw[->, very thick] (0.100,1) -- (0.101,1) node[above] {{\small$\widetilde\eval_X$}}; 
\draw[->, very thick] (-0.100,-1) -- (-0.101,-1) node[below] {{\small$\coev_X$}}; 
\fill (135:1) circle (2.5pt) node[left] {{\small$\varphi$}};
\end{tikzpicture} 
%%%%%%%%%%%%%%%%%%%%%%%%%%
\ee
which is a map $k\lra k$ that we call~$C$. Note that we colour-code the domain representing the non-trivial object $(k[x],W)$ in $\LG$. This in not only a visual aid for interpreting the components of the map~$C$, but~\eqref{annulus} can also be interpreted as an annulus correlator with ``boundary conditions'' $X,Y$ and ``field insertions'' $\varphi, \psi$. 

To put ourselves in a position to better understand and manipulate~\eqref{annulus} let us spell out its constituents. From the general expressions~\eqref{TODO} for evaluations and coevaluations we find \begin{align}
& \widetilde\eval_X = \str(-) + \mathcal O(\theta) \, , \qquad \eval_Y = (-1)^{n+1\choose 2} \Res_{k[x]/k} \left[ \frac{\str( \, - \circ \Lambda_Y) \underline{\operatorname{d}\! x}}{\partial_1 W\ldots \partial_n W} \right] \, , \nonumber \\
& \coev_X: 1 \lmt \Lambda_X \, , \qquad  \widetilde\coev_Y: 1\lmt 1_Y \label{evcoeveasy}
\end{align}
where $\Lambda_X = \partial_1 d_X\ldots \partial_n d_X$ and $\Lambda_Y = \partial_1 d_Y\ldots \partial_n d_Y$. 

We will now compute the diagram~\eqref{annulus} in two different ways and then compare the results. One possibility is to first collapse the $X$-loop to obtain a ``$(k[x],W)$-bubble'', and then collapse its boundary loop~$Y$ in turn to arrive at an expression for $C:k \lra k$. It follows from the general results of Section~\ref{sec:defectaction} or directly from~\eqref{evcoeveasy} that the first step of collapsing~$X$ produces the 2-morphism $\str(\varphi \Lambda_X)\in\End(\Delta_W)$. Similarly, the second step of collapsing~$Y$ produces a residue: 
$$
C 
= 
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\nicecolourscheme (0,0) circle (2);
\nicereallynocolourscheme (0,0) circle (1);
\fill (1.5,0) circle (0pt) node[white] {{\small$W$}};
\draw (0,0) circle (2);
\draw[->, very thick] (-0.100,2) -- (-0.101,2) node[above] {}; 
\draw[->, very thick] (0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (45:2) circle (2.5pt) node[right] {{\small$\psi$}};
%
\draw (0,0) circle (1);
\draw[->, very thick] (0.100,1) -- (0.101,1) node[above] {}; 
\draw[->, very thick] (-0.100,-1) -- (-0.101,-1) node[below] {}; 
\fill (135:1) circle (2.5pt) node[left] {{\small$\varphi$}};
\end{tikzpicture} 
= 
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\nicecolourscheme (0,0) circle (2);
\fill (1.5,0) circle (0pt) node[white] {{\small$W$}};
\draw (0,0) circle (2);
\draw[->, very thick] (-0.100,2) -- (-0.101,2) node[above] {}; 
\draw[->, very thick] (0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (45:2) circle (2.5pt) node[right] {{\small$\psi$}};
%
\fill (45:0) circle (2.5pt) node[below] {{\small$\str(\varphi\Lambda_X)$}};
\end{tikzpicture} 
= 
(-1)^{n+1\choose 2} \Res_{k[x]/k} \left[ \frac{\str\! \big( \str( \varphi \Lambda_X) \psi \Lambda_Y \big) \underline{\operatorname{d}\! x}}{\partial_1 W \ldots \partial_n W} \right] \, .
$$
Using the expressions $\beta^X(\varphi) = (-1)^{n\choose 2} \str(\varphi \Lambda_X)$ and $\beta^Y(\psi) = (-1)^{n\choose 2} \str(\psi \Lambda_Y)$ for the boundary-bulk maps from Section~\ref{sec:shadows} we thus find from the above that
\be\label{C1}
C = 
(-1)^{n+1\choose 2} \Res_{k[x]/k} \left[ \frac{\beta^X(\varphi) \, \beta^Y (\psi) \underline{\operatorname{d}\! x}}{\partial_1 W \ldots \partial_n W} \right] \, .
\ee

On the other hand, we may compute~$C$ by first fusing the two loops in~\eqref{annulus} together to obtain a single loop labelled by $X^\dual\otimes Y = \Hom(X,Y) \in \End_{\LG}( (k,0) )$. Then we use
$$
\eval_{X^\dual \otimes Y} = \str(-) \, , \qquad \widetilde\coev_{X^\dual \otimes Y} : 1 \lmt 1_{X^\dual \otimes Y}
$$
to arrive at
\be\label{C2}
C 
= 
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\nicecolourscheme (0,0) circle (2);
\nicereallynocolourscheme (0,0) circle (1);
\fill (1.5,0) circle (0pt) node[white] {{\small$W$}};
\draw (0,0) circle (2);
\draw[->, very thick] (-0.100,2) -- (-0.101,2) node[above] {}; 
\draw[->, very thick] (0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (45:2) circle (2.5pt) node[right] {{\small$\psi$}};
%
\draw (0,0) circle (1);
\draw[->, very thick] (0.100,1) -- (0.101,1) node[above] {}; 
\draw[->, very thick] (-0.100,-1) -- (-0.101,-1) node[below] {}; 
\fill (135:1) circle (2.5pt) node[left] {{\small$\varphi$}};
\end{tikzpicture} 
= 
\begin{tikzpicture}[very thick,scale=0.6,color=blue!50!black, baseline,>=stealth]
\draw (0,0) circle (2);
\draw[->, very thick] (-0.100,2) -- (-0.101,2) node[above] {}; 
\draw[->, very thick] (0.100,-2) -- (0.101,-2) node[below] {}; 
\fill (45:2) circle (2.5pt) node[right] {{\small$1\otimes\psi$}};
\fill (135:2) circle (2.5pt) node[left] {{\small$1\otimes\varphi$}};
\end{tikzpicture} 
= 
\str (\psi \circ (-) \circ \varphi ) \, .
\ee
Here the second step follows from Proposition~\ref{prop:defectactionproperties}(iii). Comparing~\eqref{C1} and~\eqref{C2} we thus observe: 

\begin{theorem}
The Cardy condition holds in $\LG$: for 1-morphisms $X,Y \in \hmf( k[x_1,\ldots,x_n], W)$ and 2-morphisms $\varphi: X\lra X$, $\psi: Y\lra Y$ we have
$$
\str (\psi \circ (-) \circ \varphi )
= 
(-1)^{n+1\choose 2} \Res_{k[k]/k} \left[ \frac{\beta^X(\varphi) \, \beta^Y (\psi) \underline{\operatorname{d}\! x}}{\partial_1 W \ldots \partial_n W} \right] \, .
$$
\end{theorem}

TODO: Fix the sign, it should only be $(-1)^n$. 

TODO: Mention HRR as special example, more discussion needed? 

\appendix

\section{Duality via adjoint operators}\label{section:dualityadjointop}
% All rings are commutative by default unless they are called "associative"
% TODO match generality to dviat5

Let $k$ be a noetherian $\mathbb{Q}$-algebra and $R = k[x_1,\ldots,x_n]$. If $k$ is a field then we know from \cite{??,??} that for any polynomial $W$ with an isolated singularity, the Kapustin-Li formula gives a non-degenerate pairing on the mapping spaces of the triangulated category of matrix factorisations of $W$ over $R$. In this section we prove the analogue of this result for an arbitrary base $k$. In particular, the mapping spaces of the triangulated category will not be flat over $k$, so we work instead with dg-categories.

Given $W \in R$ and two finite rank matrix factorisations $X,Y$ of $W$ let $\Hom(X,Y) = \Hom_R(X,Y)$ denote the $\mathbb{Z}_2$-graded Hom-complex. We define a natural $k$-bilinear pairing
\[
\langle -, - \rangle: \Hom(X,Y) \otimes_k \Hom(Y,X) \lto k[n]
\]
by the following formula, where $\lambda_i = \partial_{x_i}d_Y, \omega = \ud x_1 \ldots \ud x_n$ and $f_i = \partial_{x_i} W$: [TODO: always use commas in residue-denominator or never]
\begin{equation}\label{eq:generalklpairing}
\langle \varphi, \psi \rangle = \frac{1}{n!} \sum_{\sigma \in S_n} (-1)^{|\sigma|} \Ress{R/k}\Bigg[ \frac{ \str( \varphi \circ \psi \circ \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} )\, \omega }{ f_1,\ldots,f_n } \Bigg]\,.
\end{equation}
Such a pairing is \textsl{homotopically non-degenerate} if the adjoint morphism of $\mathbb{Z}_2$-graded complexes
\begin{align*}
\Hom(X,Y) & \lto \Hom_k( \Hom(Y,X), k )[n]\,,\\
\varphi & \lmt \langle \varphi, - \rangle
\end{align*}
is a homotopy equivalence over $k$. The main theorem here is that under some reasonable hypotheses the pairing $\langle -, - \rangle$ is homotopically non-degenerate. This non-degeneracy is used in Section~\ref{sec:Zorro} to prove that specified evaluation and coevaluation morphisms give rise to adjoint $1$-morphisms in the bicategory of Landau-Ginzburg models over $k$.

\begin{theorem}\label{theorem:generalkl} Suppose that the following conditions are satisfied
\begin{itemize}
\item[(H1)] The partial derivatives $f_i = \partial_{x_i} W$ form a regular sequence $f = \{f_1,\ldots,f_n\}$ in $R$.
\item[(H2)] $\bar{R} = R/(f_1,\ldots,f_n)R$ is a finitely generated projective $k$-module.
\item[(H3)] The $R$-linear map
\begin{align*}
\bar{R} & \lto \Hom_k( \bar{R}, k)\, , \\
r & \lmt \Ress{R/k}\Bigg[ \frac{r \cdot (-) \, \underline{\ud x}}{ f_1, \ldots, f_n} \Bigg]
\end{align*}
is an isomorphism.
\end{itemize}
Then the pairing $\langle -, - \rangle$ is homotopically non-degenerate.
\end{theorem}

There is also version when $X,Y$ are graded matrix factorisations; see Section \ref{section:gradedduality}. The proof of the theorem takes up the rest of this section. We argue that $\Hom(X,Y)[n]$ and $\Hom_k(\Hom(Y,X),k)$ are homotopy equivalent by showing that they respectively split idempotents on
\[
\Hom(\bar{X},\bar{Y}) = \Hom(X,Y) \otimes_R \bar{R}
\]
and
\[
\Hom_k( \Hom(\bar{Y}, \bar{X}), k) = \Hom_k( \Hom(Y,X) \otimes_R \bar{R}, k )
\]
in the homotopy category of $\mathbb{Z}_2$-graded $k$-complexes. There is an isomorphism
\begin{equation}\label{eq:frobnondeg}
\Hom(\bar{X}, \bar{Y}) \cong \Hom_k( \Hom(\bar{Y}, \bar{X}), k)
\end{equation}
of complexes which identify these idempotents, and from this the theorem will follow. The existence of the isomorphism (\ref{eq:frobnondeg}) is an easy consequence of the fact that $\bar{R}$ is Frobenius over $k$. The hard work lies in showing that this isomorphism identifies the two idempotents, and for this we need to carefully study adjointness between operators on dg-categories. Thus the first part of the proof, in Section \ref{section:adjointopdg}, consists in formalising this kind of adjointness.

In fact it will be convenient to prove the theorem slightly more generally, since in order to equip~$R$ with a connection we may need to pass to the $fR$-adic completion. Consequently, for the rest of this section $R$ is an arbitrary noetherian $k$-algebra, $W \in R$, and our actual hypotheses are:
\begin{itemize}
\item[(H1$'$)] $f = \{ f_1,\ldots,f_n \}$ is any regular sequence in $R$ with the property that multiplication by $f_i$ is a null-homotopic endomorphism of $X,Y \in \hmf(R,W)$ for $1 \le i \le n$.
\item[(H2$'$)] $\bar{R} = R/(f_1,\ldots,f_n)R$ is a finitely generated projective $k$-module.
\item[(H3$'$)] $R$ admits a flat $k$-linear connection
\[
\nabla: R \lto R \otimes_{k[f]} \Omega^1_{k[f]/k}
\]
as a $k[f]$-module, which is standard in the sense of \cite[Definition 8.6]{dm1102.2957}.
\item[(H4$'$)] There is an $n$-form $\omega \in \Omega^n_{R/k}$ such that the $R$-linear map
\begin{align*}
\bar{R} & \lto \Hom_k( \bar{R}, k)\, , \\
r & \lmt \Ress{R/k}\Bigg[ \frac{r \cdot (-) \cdot \omega}{ f_1, \ldots, f_n} \Bigg]
\end{align*}
is an isomorphism.
\end{itemize}
In this situation one can still write down the pairing (\ref{eq:generalklpairing}) and we prove that this is homotopically non-degenerate (Proposition \ref{prop:almostkltheorem}). The theorem follows by passing from $k[x_1,\ldots,x_n]$ to a completion, which satisfies (H3$'$) above even if the polynomial ring does not.

\subsection{Adjoint operators on dg-categories}\label{section:adjointopdg}
% TODO: Point out that these Atiyah classes are from connections over k[f], not k like in the associative case.

In this section $\otimes$ denotes $\otimes_k$. Let $\cat{C}$ be a $\mathbb{Z}_2$-graded dg-category over $k$ equipped with the data of a $k$-linear morphism of complexes 
\[
c_{XY}: \cat{C}(X,Y) \otimes \cat{C}(Y,X) \lto k
\]
for each pair of objects $X,Y$ in $\cat{C}$. 
When it is convenient we write $\langle \alpha, \beta \rangle$ for $c_{XY}(\alpha \otimes \beta)$. Throughout the differentials on the $\cat{C}(X,Y)$ and their tensor products are denoted $D$, with additional subscripts if necessary.

\begin{definition}\label{defn:nondegpair} We say that the pairing $\{ c_{XY} \}_{X,Y \in \cat{C}}$ is
\begin{itemize}
\item[(i)] \textsl{cyclic} if for all $X,Y$ the diagram
\[
\xymatrix{
\cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[dr]_{c_{XY}}\ar[rr]^\tau & & \cat{C}(Y,X) \otimes \cat{C}(X,Y) \ar[dl]^{c_{YX}}\\
& k
}
\]
commutes, where $\tau$ is the graded twist $\tau( \varphi \otimes \psi) = (-1)^{|\varphi||\psi|} \psi \circ \varphi$; 
\item[(ii)] \textsl{non-degenerate} if for all $X,Y$ the morphism
\begin{align*}
\zeta_{XY}: \cat{C}(X,Y) & \lto \Hom_k( \cat{C}(Y,X), k)\,,\\
\varphi & \lmt c_{XY}( \varphi \otimes - )
\end{align*}
is an isomorphism of complexes.
\end{itemize}
\end{definition}

%\begin{remark} \textbf{todo}. Probably this all works for a weaker form of non-degeneracy, where $\zeta$ is just a homotopy equivalence, but we don't need this. In what generality should we state things, then? Maybe we also only need cyclicity up to homotopy.
%\end{remark}

From now on we assume $\cat{C}$ is equipped with a cyclic non-degenerate pairing. In this section an \textsl{operator} is a closed homogeneous $k$-linear operator on some mapping complex $\cat{C}(X,Y)$ in $\cat{C}$, that is, a closed homogeneous element of the complex $\Hom_k( \cat{C}(X,Y), \cat{C}(X,Y) )$. We are interested in linear operators on the $\cat{C}(X,Y)$ and adjunctions between them, with respect to the pairing.

Recall that if $\Psi$ is homogeneous then $1 \otimes \Psi$ acts on tensors with Koszul signs.

\begin{definition}\label{defn:adjointop} An operator $\Phi$ on $\cat{C}(X,Y)$ is \textsl{adjoint} to an operator $\Psi$ on $\cat{C}(Y,X)$ if both~$\Phi$ and~$\Psi$ are homogeneous of the same degree and the diagram
\[
\xymatrix@C+1pc@R+0.5pc{
\cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[d]_{\Phi \otimes 1} \ar[r]^{1 \otimes \Psi} & \cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[d]^{c_{XY}}\\
\cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[r]_-{c_{XY}} & k
}
\]
commutes up to homotopy. Equivalently, there is a $k$-linear degree $|\Phi|+1$ morphism
\[
\mu: \cat{C}(X,Y) \otimes \cat{C}(Y,X) \lto k
\]
with the property that $[D, \mu] = c_{XY} \circ (1 \otimes \Psi) - c_{XY} \circ ( \Phi \otimes 1)$. Evaluated on homogeneous morphisms $\alpha, \beta$ this identity reads
\begin{equation}\label{eq:adjointopeq}
(-1)^{|\Phi|} \mu D(\alpha \otimes \beta) = (-1)^{|\alpha||\Psi|}\langle \alpha, \Psi(\beta) \rangle - \langle \Phi(\alpha) , \beta \rangle \, .
\end{equation}
\end{definition}

We will show in a moment that this type of adjointness is symmetric in $\Phi, \Psi$ so there is no need to distinguish between left and right adjoints. If $\Psi$ is a homogeneous operator on $\cat{C}(Y,X)$ then $\Psi^*$ is the operator on $\Hom_k(\cat{C}(Y,X),k)$ defined by $\Psi^*(f) = (-1)^{|f||\Psi|} f \circ \Psi$. 
%It is easy to see that: 

\begin{lemma} An operator $\Phi$ is adjoint to $\Psi$ if and only if the diagram
\begin{equation}\label{eq:lemadjointdia}
\xymatrix@C+2pc{
\cat{C}(X,Y) \ar[d]_\Phi \ar[r]^-{\zeta} & \Hom_k( \cat{C}(Y,X), k ) \ar[d]^{\Psi^*}\\
\cat{C}(X,Y) \ar[r]_-{\zeta} & \Hom_k( \cat{C}(Y,X), k)
}
\end{equation}
commutes up to homotopy.
\end{lemma}

\begin{lemma} An operator $\Phi$ is adjoint to $\Psi$ if and only if $\Psi$ is adjoint to $\Phi$.
\end{lemma}
\begin{proof}
By naturality of the graded twist $\tau$ and the cyclicity axiom for $c_{XY}$.
\end{proof}

\begin{lemma} Any operator $\Phi$ admits an adjoint, which is unique up to homotopy. 
\end{lemma}
\begin{proof}
This follows from commutativity of (\ref{eq:lemadjointdia}).
%If $\Phi$ is adjoint to $\Psi$ then from the previous lemma and (\ref{eq:lemadjointdia}) we deduce that $\Psi$ is homotopic to $\zeta^{-1} \circ \Phi^* \circ \zeta$ and from this both claims are clear.
\end{proof}

\begin{definition} Given an operator $\Phi$ we denote by $\Phi^{\dagger}$ the adjoint of $\Phi$.
\end{definition}

Since the adjoint is only well-defined up to homotopy it is implicit that in any identities involving the dagger notation we are working in the homotopy category of $\mathbb{Z}_2$-graded complexes. The following basic properties of adjoints are easily checked.

\begin{lemma} 
\begin{enumerate}
\item Let $\Phi_1, \Phi_2$ be operators on $\cat{C}(X,Y)$ and $\cat{C}(Y,Z)$ respectively. Then
\[
(\Phi_2 \circ \Phi_1)^{\dagger} = (-1)^{|\Phi_1||\Phi_2|} \Phi_1^{\dagger} \circ \Phi_2^{\dagger}\,.
\]
\item If $\Phi_1, \Phi_2$ are operators on $\cat{C}(X,Y)$ of the same degree, then $(\Phi_1 + \Phi_2)^{\dagger} = \Phi_1^{\dagger} + \Phi_2^{\dagger}$.
\end{enumerate}
\end{lemma}

So much for the general theory; from now on $\cat{C}$ denotes the dg-category whose objects are finite rank matrix factorisations of $W$ and whose mapping complexes are given by the quotients
\[
\cat{C}(X,Y) = \Hom(\bar{X}, \bar{Y}) = \Hom(X,Y) \otimes_R \bar{R}\,.
\]
While the ordinary dg-category of matrix factorisations only admits a pairing which is homotopically non-degenerate, this (linear) quotient $\cat{C}$ admits a cyclic non-degenerate pairing in the stronger sense explained above. To define it, let
\[
\langle - \rangle: R \lto k
\]
denote the $k$-linear map
\[
\langle r \rangle = \Ress{R/k}\Bigg[ \frac{r \cdot \omega}{ f_1, \ldots, f_n} \Bigg]\,.
\]
This annihilates the ideal $(f_1,\ldots,f_n)R$ and therefore factors via a $k$-linear map $\bar{R} \lto k$.

\begin{proposition}\label{prop:barnondeg} The pairing on $\cat{C}$ defined by
\begin{align*}
\langle -, - \rangle: \Hom(\bar{X}, \bar{Y}) \otimes \Hom(\bar{Y}, \bar{X}) \lto k\,, \qquad
\langle \varphi, \psi \rangle = \langle \str( \varphi \circ \psi ) \rangle
\end{align*}
is cyclic and non-degenerate in the sense of Definition \ref{defn:nondegpair}.
\end{proposition}
\begin{proof}
The pairing factors as
\begin{equation}\label{eq:barnondeg}
\xymatrix@C+1pc{
\Hom(\bar{X}, \bar{Y}) \otimes \Hom(\bar{Y}, \bar{X}) \ar[r]^-{-\circ-} & \Hom(\bar{Y}, \bar{Y}) \ar[r]^-{\str} & \bar{R} \ar[r]^-{\langle - \rangle} & k
}
\end{equation}
so it is clear that it is a closed $k$-linear map, and moreover cyclicity follows from the cyclicity of the supertrace. Non-degeneracy follows from hypothesis (H4$'$) and the following calculation, in which the first step is adjoint (\textbf{todo} not really!) to the composite of the first two maps in (\ref{eq:barnondeg})
\begin{align*}
\Hom_R(\bar{X}, \bar{Y}) &\cong \Hom_R( \Hom(\bar{Y}, \bar{X}), \bar{R} )\,\\
&\cong \Hom_R( \Hom(\bar{Y}, \bar{X}), \Hom_k( \bar{R}, k) )\\
&\cong \Hom_k( \Hom(\bar{Y}, \bar{X}), k )\,.
\end{align*}
\end{proof}

We have in mind two special classes of operators on the dg-category $\cat{C}$. The first arises because the partial derivatives $f_i=\partial_{x_i}W$ act as zero on the cohomology of $\cat{C}$ but via nonzero maps on the dg-level. In what follows let $X,Y$ denote finite rank matrix factorisations of $W$.

\begin{definition} Given a null-homotopy $\lambda_i$ for the action of $f_i$ on $Y$, that is, a map $\lambda_i \in \Hom(Y,Y)$ of degree one with $[D, \lambda_i] = f_i \cdot 1_Y$, we define the odd operator $\lambda_i^\bullet$ on $\Hom(\bar{X},\bar{Y})$ by
\[
\lambda_i^\bullet(\varphi) = \lambda_i \circ \varphi\,
\]
and the odd operator ${\lambda_i}_\bullet$ on $\Hom(\bar{Y}, \bar{X})$ by
\[
{\lambda_i}_\bullet(\varphi) = (-1)^{|\varphi|} \varphi \circ \lambda_i \,.
\]
\end{definition}

Observe that composition with $\lambda_i$ is not a closed map on $\Hom(X,Y)$ but is closed as an operator on $\Hom(\bar{X}, \bar{Y})$. These operators give the simplest example of an adjoint pair: 

\begin{lemma} The operator $\lambda_i^\bullet$ is adjoint to ${\lambda_i}_\bullet$.
\end{lemma}
\begin{proof}
The identity (\ref{eq:adjointopeq}) holds with $\mu = 0$, since
\begin{align*}
\langle {\lambda_i}_\bullet(\alpha), \beta \rangle &= \langle \str( {\lambda_i}_\bullet(\alpha) \circ \beta ) \rangle\\
&= (-1)^{|\varphi|} \langle \str( \alpha \circ \lambda_i \circ \beta ) \rangle\\
&= (-1)^{|\varphi|} \langle \alpha, \lambda_i^\bullet(\beta) \rangle\,.
\end{align*}
\end{proof}

The second class of operators are the components of the Atiyah class. Recall that by hypothesis (H2$'$) the ring $R$ admits a flat $k$-linear connection $\nabla$ as a $k[f]$-module. The $n$ components of this connection define $k$-linear operators $\partial_{f_i} = (\ud f_i)^* \circ \nabla$ on $R$ with the property that $[\partial_{f_i}, f_j] = \delta_{ij}$.

Any free $R$-module admits a $k$-linear connection over $k[f]$. For convenience choose homogeneous $R$-bases $\{ e_i \}_{i \in I}$ for $X$ and $\{ e_j \}_{j \in J}$ for $Y$ respectively. Then the maps $e_{ji} = e_j \circ e_i^*$ form an $R$-basis for $\Hom(X,Y)$ and the induced $k$-linear connection over $k[f]$ is defined by
\begin{align*}
\nabla = \nabla_{XY}: \Hom(X,Y) & \lto \Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k}\,,\\
r e_{ji} & \lmt e_{ji} \otimes \nabla(r)\,.
\end{align*}
This connection has components $\partial_{f_i}$ defined by $\partial_{f_i}( r e_{ji} ) = \partial_{f_i}(r) \cdot e_{ji}$ which are $k$-linear operators on $\Hom(X,Y)$. The \textsl{Atiyah class} of $\Hom(X,Y)$ is the commutator
\[
\At = \At_{XY} = [D, \nabla] = D \circ \nabla - \nabla \circ D: \Hom(X,Y) \lto \Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k}\,.
\]
The Atiyah class is $k[f]$-linear and is easily seen to be a morphism of complexes from $\Hom(X,Y)$ to the shift $\Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k}[1]$. Moreover the homotopy class of this morphism is independent of the choice of connection, and in this sense choosing a basis for $X,Y$ is harmless. In terms of the components this means: 

\begin{definition} For $1 \le i \le n$ the components $\At_i = [D, \partial_{f_i}]$ of the Atiyah class define $k$-linear closed operators of degree one on $\Hom(\bar{X}, \bar{Y})$.
\end{definition}

(\textbf{todo} Distinguish this from the associative Atiyah class)
For each pair of objects $X,Y$ in $\cat{C}$ we have defined a family of operators $\At_i$ on $\cat{C}(X,Y)$, defined using a choice of basis but independent of this choice up to homotopy. Conceptually, duality in the dg-category of matrix factorisations rests on the fact that these operators are anti-self-adjoint. To prove this we need the following Leibniz rule for Atiyah classes.

\begin{lemma}\label{lemma:leibnizatiyah} For homogeneous $\alpha \in \Hom(Y,Z)$ and $\beta \in \Hom(X,Y)$
\begin{equation}\label{eq:leibnizcompos}
\At_i( \alpha \circ \beta ) = \At_i(\alpha) \circ \beta + (-1)^{|\alpha|} \alpha \circ \At_i(\beta) + [g,D]( \alpha \otimes \beta)
\end{equation}
where $g( \alpha \otimes \beta ) = \partial_i(\alpha) \circ \beta + \alpha \circ \partial_i(\beta) - \partial_i( \alpha \circ \beta )$.
\end{lemma}
\begin{proof}
If $\nabla_{YZ}, \nabla_{XY}$ respectively denote the connections on $\Hom(Y,Z)$ and $\Hom(X,Y)$ then
\[
\nabla_{YZ,XY}(\alpha \otimes \beta) = \nabla_{YZ}(\alpha) \otimes \beta + \alpha \otimes \nabla_{XY}(\beta)
\]
defines a connection on $\Hom(Y,Z) \otimes_{k[f]} \Hom(X,Y)$. With $\At_{YZ,XY} = [D, \nabla_{YZ,XY}]$ it follows from naturality of the Atiyah class \cite{??} that the diagram
\[
\xymatrix{
\Hom(Y,Z) \otimes_{k[f]} \Hom(X,Y) \ar[d]_{\At_{YZ,XY}}\ar[r]^-{\kappa} & \Hom(X,Z) \ar[d]^{\At_{XZ}}\\
\Hom(Y,Z) \otimes_{k[f]} \Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k} \ar[r]_-{\kappa} & \Hom(X,Z) \otimes_{k[f]} \Omega^1_{k[f]/k}
}
\]
commutes up to homotopy, where $\kappa$ is the composition map. Specifically, if $g = [\kappa, \nabla] = \kappa \circ \nabla_{YZ,XY} - \nabla_{XZ} \circ \kappa$ then a simple calculation using the graded Jacobi identity shows that
\[
\At_{XZ} \circ \kappa - \kappa \circ \At_{YZ,XY} = [g,D]\,.
\]
Applying both sides to $\alpha \otimes \beta$ and projecting to the $\ud f_i$ component yields (\ref{eq:leibnizcompos}).
\end{proof}

\begin{lemma}\label{lemma:stratiyahzero} For any $\alpha \in \Hom(X,X)$ we have $\str( \At_i( \alpha ) ) = 0$ in $R$.
\end{lemma}
\begin{proof}
Consider the diagram
\[
\xymatrix@C+1pc{
\Hom(X,X) \ar[d]_{\At_{XX}} \ar[r]^-{\str} & R \ar[d]^{\At = 0}\\
\Hom(X,X) \otimes_{k[f]} \Omega^1_{k[f]/k} \ar[r]_-{\str} & R \otimes_{k[f]} \Omega^1_{k[f]/k}\,.
}
\]
By the graded Jacobi identity $\str \circ \At_{XX} = [\str, \At] = [g,D]$ where $g: \Hom(X,X) \lto R \otimes_{k[f]} \Omega^1_{k[f]/k}$ is $g = [\str, \nabla]$. But from the way we have defined our connections, it is clear that $\str$ and $\nabla$ commute, so $g = 0$ and $\str \circ \At_{XX} = 0$.
\end{proof}

\begin{proposition} The operator $\At_i$ on $\Hom(\bar{X}, \bar{Y})$ is adjoint to $-\At_i$ on $\Hom(\bar{Y}, \bar{X})$.
\end{proposition}
\begin{proof}
If we apply $\langle \str( - ) \rangle$ to both sides of (\ref{eq:leibnizcompos}) and use Lemma \ref{lemma:stratiyahzero} we find that
\begin{align*}
\langle \At_i(\alpha), \beta \rangle = -(-1)^{|\alpha|} \langle \alpha,  \At_i(\beta) \rangle - \langle \str( gD(\alpha \otimes \beta) ) \rangle\,.
\end{align*}
So $\mu( \alpha \otimes \beta ) = \langle \str( g( \alpha \otimes \beta ) ) \rangle$ is a homotopy expressing $\At_i$ as adjoint to $-\At_i$.
\end{proof}

\subsection{Idempotents}\label{section:idempkl}

In the previous section we constructed operators $\lambda_i^\bullet, {\lambda_i}_\bullet$ and $\At_i$ on the dg-category $\cat{C}$. Now we use these operators to define idempotent endomorphisms of the complex
\[
\cat{C}(X,Y) = \Hom(\bar{X}, \bar{Y})
\]
which split in the homotopy category of $\mathbb{Z}_2$-graded $k$-complexes to give $\Hom(X,Y)$. In this way the dg-category of matrix factorisations can be recovered from the quotient $\cat{C}$ and the non-degenerate pairing defined above induces the homotopically non-degenerate pairing $\langle -, - \rangle$.

The main result of \cite{dm1102.2957} is that if $V$ is the free $k$-module on the basis $\theta_1,\ldots,\theta_n$ then there is a homotopy equivalence
\[
\Hom(\bar{X}, \bar{Y}) \cong \Hom(X,Y) \otimes_k \bigwedge V\,.
\]
There are consequently $2^n$ ways to embed $\Hom(X,Y)$ in the homotopy category of $k$-complexes as a direct summand in $\Hom(\bar{X}, \bar{Y})$. The ``top degree'' embedding, corresponding to the form $\theta_1 \ldots \theta_n$, is determined by the following idempotent endomorphism of $\Hom(\bar{X}, \bar{Y})$: 
\[
e = \frac{1}{(n!)^2} (-1)^{\binom{n+1}{2}}\sum_{\sigma,\tau \in S_n} (-1)^{|\sigma\tau|} \cdot \lambda_{\sigma(1)}^\bullet \cdots \lambda_{\sigma(n)}^\bullet \At_{\tau(1)} \cdots \At_{\tau(n)}\,.
\]
The details are recalled in Appendix \ref{section:symidem}. The embedding corresponding to the $0$-form $1$ in $\bigwedge V$ was not discussed in \cite{dm1102.2957} but we give the details in the appendix. The upshot is that by using the relation $[ \lambda_i, \At_j ] = - \delta_{ij}$ one can show (Proposition \ref{prop:otheridempotent}) that this embedding is determined by the idempotent
\[
e' = \frac{1}{(n!)^2} (-1)^{\binom{n+1}{2}}\sum_{\sigma, \tau \in S_n} (-1)^{|\sigma\tau|} \cdot \At_{\tau(1)} \cdots \At_{\tau(n)} {\lambda_{\sigma(1)}}_\bullet \cdots {\lambda_{\sigma(n)}}_\bullet\,.
\]
To be precise, there is a diagram of degree zero $k$-linear morphisms of complexes
\[
\xymatrix@C+2pc{
\Hom(\bar{X}, \bar{Y}) \ar@<-0.5ex>[r]_-{\psi} & \Hom(X,Y)[n] \ar@<-0.5ex>[l]_-{\vartheta}
}
\]
with $\psi \circ \vartheta = 1$ and $\vartheta \circ \psi = e$ (equalities meaning equal up to $k$-linear homotopy) and a diagram
\[
\xymatrix@C+2pc{
\Hom(\bar{Y}, \bar{X}) \ar@<-0.5ex>[r]_-{\psi'} & \Hom(Y,X) \ar@<-0.5ex>[l]_-{\vartheta'}
}
\]
with $\psi' \circ \vartheta' = 1$ and $\vartheta' \circ \psi' = e'$. A concrete description of $\psi, \psi'$ is not important for us, but we will need to know that $\vartheta'$ is simply the quotient map, and that
\[
\vartheta = \frac{1}{n!} \sum_{\sigma \in S_n} (-1)^{|\sigma|} \lambda_{\sigma(1)}^\bullet \cdots \lambda_{\sigma(n)}^{\bullet}\,.
\]

\begin{proposition}\label{prop:eadjointeprime} The idempotent $e$ is adjoint to $e'$. Equivalently, the diagram
\begin{equation}\label{eq:eadjointeprime}
\xymatrix@C+2pc{
\Hom(\bar{X}, \bar{Y}) \ar[d]_-{e} \ar[r]^-{\zeta}_-{\cong} & \Hom_k(\Hom(\bar{Y},\bar{X}),k) \ar[d]^-{(e')^*}\\
\Hom(\bar{X}, \bar{Y}) \ar[r]_-{\zeta}^-{\cong} & \Hom_k( \Hom(\bar{Y}, \bar{X}), k )
}
\end{equation}
commutes up to homotopy.
\end{proposition}
\begin{proof} 
Observe that by the (anti-)self-adjointness established in the previous section
\begin{align*}
\left( \lambda_{\sigma(1)}^\bullet \cdots \lambda_{\sigma(n)}^\bullet \At_{\tau(1)} \cdots \At_{\tau(n)} \right)^{\dagger} &= (-1)^n \At^\dagger_{\tau(n)} \cdots \At^\dagger_{\tau(1)} (\lambda_{\sigma(n)}^\bullet)^\dagger \cdots (\lambda_{\sigma(1)}^\bullet)^{\dagger}\\
&= \At_{\tau(n)} \cdots \At_{\tau(1)} {\lambda_{\sigma(n)}}_{\bullet} \cdots {\lambda_{\sigma(1)}}_{\bullet}\,,
\end{align*}
from which it is immediate that $e^{\dagger} = e'$.
\end{proof}

\begin{proposition}\label{prop:almostkltheorem} The pairing (\ref{eq:generalklpairing}) is homotopically non-degenerate.
\end{proposition}
\begin{proof} Consider the diagram
\[
\xymatrix@C+2pc{
\Hom(\bar{X},\bar{Y}) \ar[d]_-{\zeta}^-{\cong} \ar@<-0.5ex>[r]_-{\psi} & \Hom(X,Y)[n] \ar@<-0.5ex>[l]_-{\vartheta} \ar@{.>}[d]^{\xi}\\
\Hom_k(\Hom(\bar{Y}, \bar{X},k) \ar@<-0.5ex>[r]_-{(\vartheta')^*} & \Hom_k( \Hom(Y,X), k) \ar@<-0.5ex>[l]_-{(\psi')^*}
}
\]
where $\xi = (\vartheta')^* \circ \zeta \circ \vartheta$. It is immediate from commutativity of~\eqref{eq:eadjointeprime} up to homotopy that $\xi$ is a homotopy equivalence with inverse $(-1)^n \psi \circ \zeta^{-1} \circ (\psi')^*$. To prove the theorem it only remains to observe that $\xi(\alpha)$ is the functional $\langle \alpha, - \rangle$. But
\begin{align*}
\xi(\alpha) &= (\vartheta')^* \zeta \vartheta( \alpha )\\
&= (\vartheta')^* \zeta\left( \frac{1}{n!} \sum_{\sigma \in S_n} (-1)^{|\sigma|} \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} \circ \alpha \right)\\
&= \frac{1}{n!} (-1)^n \sum_{\sigma \in S_n} (-1)^{|\sigma|} \langle \str( \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} \circ \alpha \circ (-) ) \rangle\\
&= \frac{1}{n!} \sum_{\sigma \in S_n} (-1)^{|\sigma|} \langle \str(  \alpha \circ (-) \circ \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} ) \rangle\\
&= \langle \alpha, - \rangle
\end{align*}
which completes the proof.
\end{proof}

Let us now abandon the general setting, and return to the situation of the main theorem where $R = k[x_1,\ldots,x_n]$, and (H1)--(H3) are satisfied for $f_i = \partial_{x_i} W$ and $\omega = \ud x_1 \ldots \ud x_n$.

\begin{proof}[Proof of Theorem \ref{theorem:generalkl}] Set $I = (f_1,\ldots,f_n)R$ and let $\widehat{R}$ denote the $I$-adic completion of $R$. Then by \cite{??} this algebra admits a flat standard connection as a $k[f]$-module, and the other axioms among (H1$'$)--(H4$'$) follow for $\widehat{R}$ from our hypotheses about $R$ with $\omega = \ud x_1 \cdots \ud x_n$ (here we use that residues for $R/k$ and $\widehat{R}/k$ agree). Note that in (H1$'$) we only need that the $f_i$ act null-homotopically on the matrix factorisations
\[
\widehat{X} = X \otimes_R \widehat{R} \, , \qquad \widehat{Y} = Y \otimes_R \widehat{R}
\]
extended from $R$. Consider the diagram
\[
\xymatrix@C+2pc{
\Hom_R(X,Y) \ar[d]_{\can} \ar[r] & \Hom_k( \Hom_R(Y,X), k )[n]\\
\Hom_{\widehat{R}}(\widehat{X}, \widehat{Y}) \ar[r] & \Hom_k( \Hom_{\widehat{R}}(\widehat{X}, \widehat{Y}), k)[n] \ar[u]_{\can}
}
\]
where the columns are the canonical maps, and the rows are adjoint to the two versions of the pairing (\ref{eq:generalklpairing}). It is easy to see that this diagram commutes, and as the bottom row is a homotopy equivalence by Proposition \ref{prop:almostkltheorem}, to prove the theorem it is enough to argue that the canonical map
\[
\Hom_R(X,Y) \lto \Hom_{\widehat{R}}(\widehat{X}, \widehat{Y})
\]
is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes over $k$. But this is a consequence of the general fact that the ``pushforward commutes with flat base change'', see \cite[Remark 7.7]{??}.
\end{proof}

\subsection{Graded duality}\label{section:gradedduality}

In this section we collect together the modifications necessary in order to make Theorem \ref{theorem:generalkl} compatible with an additional $\mathbb{Z}$-grading on matrix factorisations. Our conventions for graded modules and matrix factorisations are contained in Section \ref{??}.

Let $k$ be a noetherian $\mathbb{Q}$-algebra which is graded, and let $R = k[x_1,\ldots,x_n]$ be a graded ring in such a way that the structural map $k \lto R$ has degree zero. Let $W \in R$ be given, homogeneous of degree $|W| = 2c$ and let $X,Y$ be finite rank graded matrix factorisations of $W$ over $R$. Define
\[
a = \sum_{i=1}^n |x_i| - nc \, . 
\]
Then the graded analogue of the earlier theorem is:

\begin{theorem}\label{theorem:generalklgraded} 
Under the conditions (H1)--(H3) of Theorem \ref{theorem:generalkl} the pairing $\langle -, - \rangle$ is adjoint to a homotopy equivalence of $\mathbb{Z} \times \mathbb{Z}_2$-graded complexes over $k$
\[
\Hom(X,Y) \lto \Hom^{\operatorname{gr}}_k( \Hom(Y,X), k )[n](a)\,.
\]
\end{theorem}

Note that $\Hom(Y,X)$ is unlikely to be finitely generated over $k$, so there is a need to distinguish between $\Hom_k$ and $\Hom_k^{\operatorname{gr}}$. For the proof we need the following fact about residues.

\begin{lemma}\label{lemma:residuesarehomog} If $f_1,\ldots,f_n$ is a regular sequence in $R$ of homogeneous elements, then the map
\[
\Ress{R/k}\Bigg[ \frac{(-) \, \ud \underline{x}}{ f_1, \ldots, f_n} \Bigg]: R \lto k
\]
is homogeneous of degree $\sum_{i=1}^n( |x_i| - |f_i| )$.
\end{lemma}
\begin{proof}
(\textbf{todo}) Follows from the determinantal formula for residues in Lipman's book.
\end{proof}

\begin{proof}[Proof of Theorem \ref{theorem:generalklgraded}]
Consider the following diagram of $\mathbb{Z}_2$-graded complexes
\[
\xymatrix@C+2pc{
\Hom(X,Y) \ar@{.>}[dr]_-{\zeta_{\operatorname{gr}}} \ar[r]^-{\xi} & \Hom(\Hom(Y,X),k)[n]\\
& \Hom^{gr}_k( \Hom(Y,X), k)[n](a) \ar[u]_{\iota = \inc}
}
\]
where $\xi$ is adjoint to (\ref{eq:generalklpairing}), and is therefore a homotopy equivalence by the earlier theorem. It is clear from the explicit formula for the pairing and Lemma \ref{lemma:residuesarehomog} that the image of $\xi$ lies in the subspace of homogeneous maps, and we let $\zeta_{\operatorname{gr}}$ denote this factorisation. The value of $a$ is chosen such that $\zeta_{gr}$ is homogeneous of degree zero. It is enough to prove that $\zeta_{\operatorname{gr}}$ is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes (forgetting the $\mathbb{Z}$-grading) since then by an elementary argument we can find a homotopy inverse which is degree zero, and graded homotopies.

It suffices to prove that the inclusion $\iota$ is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes. This would be a tautology if $\Hom(Y,X)$ were a finitely generated $k$-module, and in general we use the fact that $\Hom(Y,X)$ embeds up to homotopy in a finitely generated complex. That is: by \cite[Section ??]{blah} we have a diagram
\begin{equation}\label{eq:generalklgraded}
\xymatrix@C+2pc{
\Hom(\bar{Y}, \bar{X}) \ar@<-0.5ex>[r]_-{\psi} & \Hom(Y,X)[n] \ar@<-0.5ex>[l]_-{\vartheta}
}
\end{equation}
of $\mathbb{Z}_2$-graded complexes over $k$ with $\psi \circ \vartheta \simeq 1$. But if one examines the explicit expressions for $\vartheta, \psi$ given in loc.\,cit.~it is clear that $\vartheta$ has degree $-a$, $\psi$ has degree $a$, and the homotopy between $\psi \circ \vartheta$ and the identity is homogeneous. If we apply both $\Hom_k(-,k)$ and $\Hom_k^{\operatorname{gr}}(-,k)$ to (\ref{eq:generalklgraded}) we obtain a diagram
\[
\xymatrix@C+2pc{
\Hom_k( \Hom(\bar{Y}, \bar{X}), k ) \ar@<-0.5ex>[r]_-{\vartheta^*} & \Hom_k(\Hom(Y,X),k)[n] \ar@<-0.5ex>[l]_-{\psi^*}\\
\Hom_k^{\operatorname{gr}}(\Hom(\bar{Y}, \bar{X}), k) \ar[u]^{=} \ar@<-0.5ex>[r]_-{\vartheta^*} & \Hom_k^{\operatorname{gr}}(\Hom(Y,X),k)[n](a) \ar@<-0.5ex>[l]_-{\psi^*} \ar[u]_{\iota}
}
\]
in which both of the implict squares commute up to homotopy, and from this we deduce that $\iota$ is a homotopy equivalence with inverse $\vartheta^* \circ \psi^*$.
\end{proof}


\appendix

\section{Symmetrised idempotents}\label{section:symidem}

In Section \ref{section:dualityadjointop} we used the idempotent pushforward construction of \cite{dm1102.2957} to establish a relative form of duality for matrix factorisations. We needed slightly more than what is stated in \textsl{loc.cit.} and in this appendix we provide the necessary additions. With later applications in mind we work in the same generality as the original construction, but the reader should keep in mind that for Section \ref{section:dualityadjointop} we only need the case $Z = \Hom_R(X,Y)$ and $W = 0$ of the following.

Let $k$ be a $\mathbb{Q}$-algebra and $R$ a $k$-algebra with a quasi-regular sequence $\{ f_1, \ldots, f_n \}$ such that $\bar{R} = R/(f_1,\ldots,f_n)R$ is a finitely generated projective $k$-module. Let $W \in k$ be given and let $Z$ be a finite rank matrix factorisation of $W$ over $R$ with each $f_i$ acting null-homotopically on $Z$, and moreover let $\lambda_i \in \Hom_R(Z,Z)$ be odd maps with $[D, \lambda_i] = f_i \cdot 1_Z$ for each $1 \le i \le n$ where $D = d_Z$. We fix a homogeneous basis for $Z$ and, unless specified otherwise, $\otimes = \otimes_R$.

The aim is to write $Z$, up to $k$-linear homotopy equivalence, as the splitting of an idempotent on the quotient $\bar{Z} = Z \otimes \bar{R}$. Suppose that $R$ admits a flat $k$-linear connection $\nabla$ as a $k[f]$-module which is standard in the sense of \cite[Definition 8.6]{dm1102.2957}. The components of $\nabla$ are denoted $\partial_{f_i}$. If $K(f) = K(f_1,\ldots,f_n)$ denotes the usual Koszul complex then by hypothesis the map $K(f) \lto \bar{R}$ is a quasi-isomorphism and by \cite[Section 10]{dm1102.2957} the projection
\begin{equation}\label{eq:symidem1}
\pi: Z \otimes K(f) \lto Z \otimes \bar{R} = \bar{Z}
\end{equation}
is a homotopy equivalence over $k$. 

As a graded $R$-algebra $K(f)$ is the exterior algebra $\bigwedge F$ where $F$ is $R$-free on symbols $\theta_1,\ldots,\theta_n$ placed in degree $-1$. Since the $f_i$ all act null-homotopically on $Z$ it is easy to see that $Z \otimes K(f)$ is homotopy equivalent over $R$ to the tensor product $Z \otimes \bigwedge F$, with no differential placed on the exterior component. This is just a direct sum of $2^n$ copies of $Z$ and $Z[1]$. In light of (\ref{eq:symidem1}) this means that in the homotopy category of linear factorisations of $W$ over $k$, there is an isomorphism
\[
\bar{Z} \cong Z \otimes_k \bigwedge (k\theta_1 \oplus \cdots \oplus k\theta_n)
\]
between $\bar{Z}$ and a direct sum of shifted copies of $Z$, and to this direct sum decomposition corresponds $2^n$ orthogonal $k$-linear idempotents on $\bar{Z}$. Our aim is to describe the idempotents corresponding to the top degree summand $Z \theta_1 \cdots \theta_n$ and the bottom degree summand $Z \cdot 1$.

The strategy is to construct a pair of $R$-linear idempotents on $Z \otimes K(f)$, and then transfer these idempotents to $\bar{Z}$. More precisely, we will construct a diagram
\begin{equation}\label{eq:twoidempotents}
\xymatrix@C+2pc{
Z[n] \ar@<0.7ex>[r]^-{\vartheta} & Z \otimes K(f) \ar@<0.7ex>[l]^-{\varepsilon}\ar@<0.7ex>[r]^-{\rho} & Z \ar@<0.7ex>[l]^-{\kappa}
}
\end{equation}
in which the maps are $R$-linear morphisms of linear factorisations satisfying $\rho \circ \kappa = 1$ and $\varepsilon \circ \vartheta = 1$. The composites $\kappa \circ \rho$ and $\vartheta \circ \varepsilon$ will be the desired pair of idempotents on $Z \otimes K(f)$ corresponding to top and bottom degree.

To this end consider the case of a single $f_i$, so there is an exact sequence
\[
\xymatrix{
0 \ar[r] & Z \ar[r]^-{\kappa_i} & Z \otimes K(f_i) \ar[r]^-{\varepsilon_i} & Z\theta_i \ar[r] & 0
}
\]
where $Z\theta_i = Z[1]$, $\kappa_i(x) = x \otimes 1$ is the inclusion and $\varepsilon_i( x \theta_i ) = (-1)^{|x|} x$. This sequence is split exact; choosing a splitting is equivalent to choosing a null-homotopy on $X$ for the action of $f_i$. The maps
\[
\rho_i(x + y \theta_i) = x + (-1)^{|y|} \lambda_i(y), \qquad \vartheta_i(x) = (-1)^{|x|} x \theta_i - \lambda_i(x)
\]
satisfy $\kappa_i \circ \rho_i + \vartheta_i \circ \varepsilon_i = 1$ and $\rho_i \circ \kappa_i = 1, \varepsilon_i \circ \theta_i = 1$ and $\rho_i \circ \vartheta_i = 0$. That is, they equip $Z \otimes K(f_i)$ with the structure of a biproduct $Z \oplus Z\theta_i$. It will be convenient to have a more compact definition of $\vartheta_i$. Let us agree that left multiplication by $\theta_i$ on $X \otimes K(f)$ comes with signs $\theta_i \cdot (x \otimes \eta) = (-1)^{|x|} x \otimes \theta_i \eta$ so that multiplication by $\theta_i$ defines a map $\theta_i: X \lto X \otimes K(f_i)$ and $\vartheta_i = \theta_i - \lambda_i$.

To construct idempotents on $Z \otimes K(f)$ we can inductively apply either of the projections $\varepsilon$ or $\rho$ until we reach form degree zero, e.g. in the first step we can choose to ``keep'' $\theta_n$
\[
Z \otimes K(f_1,\ldots,f_n) \cong (Z \otimes K(f_1,\ldots,f_{n-1})) \otimes K(f_n) \xlto{\varepsilon} Z \otimes K(f_1,\ldots,f_{n-1})\theta_n\,,
\]
or we can choose to project out $\theta_n$ by applying $\rho$ instead. If after keeping $\theta_n$ we proceed to apply the $\varepsilon$ projections for the rest of the $\theta_i$, we obtain a split epimorphism $\varepsilon: Z \otimes K(f) \lto Z[n]$ defined by $\varepsilon(x \theta_1 \cdots \theta_n) = (-1)^{n|x|} x$ with left inverse $\vartheta$ defined by concatenating all the $\vartheta_i$. This left inverse depends on the order in which we project out the $\theta_i$, but if we symmetrise over all permutations we obtain the following left inverse to $\varepsilon$
\[
\vartheta = \frac{1}{n!} \sum_{\sigma \in S_n} (-1)^{|\sigma|} (\theta_{\sigma(1)} - \lambda_{\sigma(1)}) \circ \cdots \circ (\theta_{\sigma(n)} - \lambda_{\sigma(n)})\,.
\]
The reader may safely ignore this derivation, and instead check directly that $\vartheta$ commutes with the differentials and satisfies $\varepsilon \circ \vartheta = 1$, so that $\vartheta \circ \varepsilon$ is an idempotent on $Z \otimes K(f)$ splitting to $Z[n]$.

At the other extreme we can choose at each stage to project out the $\theta_i$ using $\rho$ to obtain a split epimorphism $Z \otimes K(f) \lto Z$ with left inverse the inclusion $\kappa(x) = x \otimes 1$. The precise formula for this epimorphism depends on the order in which we choose to project out the $\theta_i$. If we symmetrise over all permutations we arrive at the morphism
\begin{equation}\label{eq:rhoformula1}
\rho: Z \otimes K(f) \lto Z
\end{equation}
defined for $i_1 < \cdots < i_p$ by
% see syme3
\begin{equation}\label{eq:rhoformula2}
\rho( x \theta_{i_1} \cdots \theta_{i_p} ) = \frac{1}{p!} (-1)^{p|x|} \sum_{\sigma \in S_p} (-1)^{|\sigma|} \lambda_{i_{\sigma(1)}} \ldots \lambda_{i_{\sigma(p)}}(x)\,.
\end{equation}
Again one may ignore this derivation and check directly that $\rho$ commutes with the differentials and satisfies $\rho \circ \kappa = 1$, so that $\kappa \circ \rho$ is an idempotent splitting to $Z$.

Having constructed the maps in \eqref{eq:twoidempotents} we now proceed to transfer these two idempotents to $\bar{Z}$. We do this via the $k$-linear homotopy inverse $\sigma_\infty$ to $\pi$ which is described in \cite[Section 10]{dm1102.2957} (with $S = k$ and $X = Z$). In the notation given there
\[
\sigma_\infty = \sum_{m \ge 0} (-1)^m (\tau^{-1} \nabla_{gr} D)^m \sigma\,.
\]
Here $\nabla_{gr} = \sum_{j=1}^n \partial_{f_j} \circ \theta_j$ where $\theta_j$ denotes left multiplication on $Z \otimes K(f)$ with attendant Koszul sign, and $\partial_{f_j}$ is the operator extended to $Z$ using our chosen homogeneous basis. Consider now the diagram
\[
\xymatrix@C+2pc{
& & Z[n] \ar@<-0.7ex>[dl]_-{\vartheta}\\
\bar{Z} \ar@<-0.7ex>[r]_-{\sigma_\infty} & Z \otimes K(f) \ar@<-0.7ex>[ur]_-{\varepsilon}\ar@<-0.7ex>[l]_-{\pi} \ar@<-0.7ex>[dr]_-{\rho}\\
& & Z \ar@<-0.7ex>[ul]_-{\kappa}
}
\]
The $k$-linear idempotent on $\bar{Z}$ corresponding to top degree is the transfer $e = \pi \circ \vartheta \circ \varepsilon \circ \sigma_\infty$ while the bottom degree idempotent is $e' = \pi \circ \kappa \circ \rho \circ \sigma_\infty$. The former is described by symmetrising the content of \cite[Corollary 10.4]{dm1102.2957}
\begin{equation}\label{eq:ordinaryidem}
e = \frac{1}{(n!)^2} (-1)^{\binom{n+1}{2}} \sum_{\sigma, \tau \in S_n} (-1)^{|\sigma\tau|} \lambda_{\sigma(1)} \ldots \lambda_{\sigma(n)} \At_{\tau(1)} \ldots \At_{\tau(n)}
\end{equation}
where $\At_i = [D, \partial_{f_i}]$ is the $i$th component of the Atiyah class.

\begin{proposition}\label{prop:otheridempotent} There is a $k$-linear homotopy
\begin{equation}\label{eq:propotheridempotent}
e' \simeq \frac{1}{(n!)^2} (-1)^{\binom{n+1}{2}} \sum_{\sigma, \tau \in S_n} (-1)^{|\sigma\tau|} \At_{\tau(1)} \ldots \At_{\tau(n)} \lambda_{\sigma(1)} \ldots \lambda_{\sigma(n)}\,.
\end{equation}
\end{proposition}
\begin{proof}
Working modulo the $f_i$ and using the tricks in the discussion preceeding \cite[Theorem 10.1]{dm1102.2957} we have
\begin{align*}
\sigma_\infty &= \sum_{m \ge 0} (-1)^m \frac{1}{m!} \big[ D, \nabla_{gr} \big]^m \\
\end{align*}
where $\nabla_{gr}$ has odd degree for the purpose of writing commutators. Expanding each of these commutators in its components $\At_i$ yields a sum
\begin{align*}
&= \sum_{m \ge 0} \sum_{\sigma \in S_{m,n}} (-1)^{\binom{m+1}{2}} \frac{1}{m!} \At_{\sigma(1)} \cdots \At_{\sigma(m)} \theta_{\sigma(1)} \cdots \theta_{\sigma(m)}
\end{align*}
over all injective functions $S_{m,n}$ from $[1,m]$ to $[1,n]$. Using \eqref{eq:rhoformula2}
% see syme2
\begin{align*}
e' &= \pi \circ \kappa \circ \rho \circ \sigma_\infty\\
&= \sum_{m \ge 0} \frac{1}{m!} (-1)^{\binom{m+1}{2}} \sum_{\sigma \in S_{m,n}} \rho \At_{\sigma(1)} \cdots \At_{\sigma(m)} \theta_{\sigma(1)} \cdots \theta_{\sigma(m)}\\
&= \sum_{m \ge 0} \frac{1}{(m!)^2} (-1)^{\binom{m}{2}} \sum_{\sigma \in S_{m,n}} \sum_{\tau \in S_m} (-1)^{|\tau|} \lambda_{\sigma \tau(1)} \ldots \lambda_{\sigma \tau(m)} \At_{\sigma(1)} \ldots \At_{\sigma(m)}(x)\,.
\end{align*}
Using the relation $[ \lambda_i, \At_j ] = - \delta_{ij}$ up to homotopy given in the next lemma, we can commute all the Atiyah classes through to the left. Taking care of some combinatorics (and some delicate signs) the result is $e'$ is homotopic to the expression on the right hand side of \eqref{eq:propotheridempotent}.
\end{proof}
% see syme2

\begin{lemma} As operators on $\bar{Z}$ we have
\[
\lambda_i \At_j + \At_j \lambda_i = - \delta_{ij} + \big[ D, \big[ \partial_j, \lambda_i \big] \big]
\]
and in particular $[ \lambda_i, \At_j ] = - \delta_{ij}$ up to homotopy.
\end{lemma}
\begin{proof}
\textbf{todo}.
\end{proof}

\newcommand{\etalchar}[1]{$^{#1}$}
\providecommand{\href}[2]{#2}
\begin{thebibliography}{FYH{\etalchar{+}}85}

\bibitem[ABCDG]{MB2}
P.~S.~Aspinwall, T.~Bridgeland, A.~Craw, M.~R.~Douglas, and M.~Gross, \textsl{Dirichlet Branes and Mirror Symmetry}, Clay Mathematics Monographs, AMS, 2009.

%\bibitem[BN]{bnKhovanov11crossings}
%D.~Bar-Natan, \textsl{Khovanov {H}omology for {K}nots and {L}inks with up to 11
%  {C}rossings}, available at
%  \href{http://www.math.toronto.edu/drorbn/papers/KHTables/KHTables.pdf}{http:%
%//www.math.toronto.edu/drorbn/papers/KHTables/KHTables.pdf}.
%
%\bibitem[Bec]{b1105.0702}
%H.~Becker, \textsl{Khovanov-Rozansky homology via Cohen-Macaulay approximations and Soergel bimodules},
%  \href{http://arxiv.org/abs/1105.0702}{[arXiv:1105.0702]}.

\bibitem[BR07]{br0707.0922}
I.~Brunner and D.~Roggenkamp, \textsl{B-type defects in {L}andau-{G}inzburg
  models}, JHEP \textbf{0708} (2007), 093,
  \href{http://arxiv.org/abs/0707.0922}{[arXiv:0707.0922]}.

%\bibitem[CF94]{cf9405183}
%L.~Crane and I.~B. Frenkel, \textsl{Four dimensional topological quantum field
%  theory, {H}opf categories, and the canonical bases}, J. Math. Phys.
%  \textbf{35} (1994), 5136--5154,
%  \href{http://arxiv.org/abs/hep-th/9405183}{[hep-th/9405183]}.
%
%\bibitem[CK08a]{ck0701194}
%S.~Cautis and J.~Kamnitzer, \textsl{Knot homology via derived categories of
%  coherent sheaves {I}, {$sl(2)$} case}, Duke Math. J. \textbf{142} (2008),
%  511--588, \href{http://arxiv.org/abs/math/0701194}{[math.AG/0701194]}.
%
%\bibitem[CK08b]{ck0710.3216}
%S.~Cautis and J.~Kamnitzer, \textsl{Knot homology via derived categories of coherent sheaves {II},
%  {$sl(m)$} case}, Invent. Math. \textbf{174} (2008), 165--232,
%  \href{http://arxiv.org/abs/math/0710.3216}{[math.AG/0710.3216]}.
%
%\bibitem[CM]{cmWebCompileCode}
%N.~Carqueville and D.~Murfet, \textsl{Code to compute {K}hovanov-{R}ozansky
%  homology and defect fusion in {L}andau-{G}inzburg models},
%  \href{http://www.carqueville.net/nils/webCompilations}{http://www.carqueville.net/nils/webCompilations}.

\bibitem[CW10]{ct1007.2679}
A.~{C\u ald\u araru} and S.~Willerton, \textsl{The Mukai pairing, I: a categorical approach},
New York Journal of Mathematics \textbf{16} (2010) 61--98, 
  \href{http://arxiv.org/abs/0707.2052}{[arXiv:0707.2052]}.

\bibitem[CR10]{cr0909.4381}
N.~Carqueville and I.~Runkel, \textsl{On the monoidal structure of matrix bi-factorisations}, J. Phys.
  A: Math. Theor. \textbf{43} (2010), 275401,
  \href{http://arxiv.org/abs/0909.4381}{[arXiv:0909.4381]}.

\bibitem[CR12]{cr1006.5609}
N.~Carqueville and I.~Runkel, \textsl{Rigidity and defect actions in
  Landau-Ginzburg models}, Comm. Math. Phys. \textbf{310} (2012) 135--179, 
  \href{http://arxiv.org/abs/1006.5609}{[arXiv:1006.5609]}.

\bibitem[CR]{genorb}
N.~Carqueville and I.~Runkel, \textsl{Generalised orbifolds of Landau-Ginzburg models}, in preparation. 

%\bibitem[Cra]{c0403266}
%M.~Crainic, \textsl{On the perturbation lemma, and deformations},
%  \href{http://arxiv.org/abs/math/0403266}{[math.AT/0403266]}.
%
%\bibitem[DGR06]{dgr0505662}
%N.~M. Dunfield, S.~Gukov, and J.~Rasmussen, \textsl{The {S}uperpolynomial for
%  {K}not {H}omologies}, Experimental Math. \textbf{15} (2006), 129--159,
%  \href{http://arxiv.org/abs/math/0505662}{[math.GT/0505662]}.

\bibitem[DKR]{dkr1107.0495}
A.~Davydov, L.~Kong, and I.~Runkel, \textsl{Field theories with defects and the
  centre functor}, Mathematical Foundations of Quantum Field Theory and Perturbative String Theory, 
  Proceedings of Symposia in Pure Mathematics, AMS, 2011, \href{http://arxiv.org/abs/1107.0495}{[arXiv:1107.0495]}.

%\bibitem[DBM{\etalchar{+}}11]{dbmmss1106.4305}
%P.~Dunin-Barkowski, A.~Mironov, A.~Morozov, A.~Sleptsov, A.~Smirnov, \textsl{Superpolynomials for toric knots from evolution induced by cut-and-join operators},
%  \href{http://arxiv.org/abs/1106.4305}{[arXiv:1106.4305]}. 
%  
\bibitem[Dyc11]{d0904.4713}
T.~Dyckerhoff, \textsl{Compact generators in categories of matrix factorizations},
  Duke Math. J. \textbf{159} (2011), 223--274,
  \href{http://arxiv.org/abs/0904.4713}{[arXiv:0904.4713]}.

\bibitem[DM]{dm1102.2957}
T.~Dyckerhoff and D.~Murfet, \textsl{Pushing forward matrix factorisations},
  \href{http://arxiv.org/abs/1102.2957}{[arXiv:1102.2957]}.

\bibitem[FRS02]{tft1}
J.~Fuchs, I.~Runkel and C.~Schweigert,
\textsl{TFT construction of RCFT correlators. I: Partition functions},
Nucl.~Phys.~B {\bf 646} (2002), 353--497, \href{http://arxiv.org/abs/hep-th/0204148}{[hep-th/0204148]}.

\bibitem[FFRS09]{ffrs0909.5013}
J.~Fr\"ohlich, J.~Fuchs, I.~Runkel and C.~Schweigert,
\textsl{Defect lines, dualities, and generalised orbifolds},
Proceedings of the XVI International Congress on Mathematical Physics, Prague, August 3--8, 2009, \href{http://arxiv.org/abs/0909.5013}{[arXiv:0909.5013]}.

%\bibitem[FFRS07]{ffrs0607247}
%J.~Fr\"ohlich, J.~Fuchs, I.~Runkel, and C.~Schweigert, \textsl{Duality and
%  defects in rational conformal field theory}, Nucl. Phys. B \textbf{763}
%  (2007), 354--430,
%  \href{http://arxiv.org/abs/hep-th/0607247}{[hep-th/0607247]}.
%
%\bibitem[FYH{\etalchar{+}}85]{Homfly}
%P.~Freyd, D.~Yetter, J.~Hoste, W.~B.~R. Lickorish, K.~Millett, and A.~Ocneanu,
%  \textsl{A new polynomial invariant of knots and links}, Bull. Amer. Math. Soc.
%  \textbf{12} (1985), 239--246.
%
%\bibitem[GIKV10]{gikv0705.1368}
%S.~Gukov, A.~Iqbal, C.~Koz\c{c}az, and C.~Vafa, \textsl{Link {H}omologies and the
%  {R}efined {T}opological {V}ertex}, Comm. Math. Phys. \textbf{298} (2010),
%  757--785, \href{http://arxiv.org/abs/0705.1368}{[arXiv:0705.1368]}.
%
%\bibitem[GSV05]{gsv0412243}
%S.~Gukov, A.~Schwarz, and C.~Vafa, \textsl{Khovanov-{R}ozansky {H}omology and
%  {T}opological {S}trings}, Lett. Math. Phys. \textbf{74} (2005), 53--74,
%  \href{http://arxiv.org/abs/hep-th/0412243}{[hep-th/0412243]}.
%
%\bibitem[GV99]{gv9811131}
%R.~Gopakumar and C.~Vafa, \textsl{On the {G}auge {T}heory/{G}eometry
%  {C}orrespondence}, Adv. Theor. Math. Phys. \textbf{3} (1999), 1415--1443,
%  \href{http://arxiv.org/abs/hep-th/9811131}{[hep-th/9811131]}.
%
%\bibitem[GW]{gw0512298}
%S.~Gukov and J.~Walcher, \textsl{Matrix {F}actorizations and {K}auffman
%  {H}omology}, \href{http://arxiv.org/abs/hep-th/0512298}{[hep-th/0512298]}.
%
%\bibitem[Jae]{j1101.3302}
%T.~C. Jaeger, \textsl{Khovanov-{R}ozansky {H}omology and {C}onway {M}utation},
%  \href{http://arxiv.org/abs/1101.3302}{[arXiv:1101.3302]}.
%
%\bibitem[Jon85]{JonesPolynomialPaper}
%V.~F.~R. Jones, \textsl{A polynomial invariant for knots via von {N}eumann
%  algebras}, Bull. Amer. Math. Soc. \textbf{12} (1985), 103--111.

\bibitem[JS91]{JSGoTCI}
A.~Joyal and R.~Street, \textsl{The geometry of tensor calculus I}, Advances in Math. \textbf{88} (1991), 55--112.

\bibitem[JS]{JSGoTCII}
A.~Joyal and R.~Street, \textsl{The geometry of tensor calculus II}, 
draft available at 
\href{http://maths.mq.edu.au/~street/GTCII.pdf}{http://maths.mq.edu.au/\textasciitilde street/GTCII.pdf}

\bibitem[Kap]{k1004.2307}
A.~Kapustin, \textsl{Topological {F}ield {T}heory, {H}igher {C}ategories, and
  {T}heir {A}pplications},
  \href{http://arxiv.org/abs/1004.2307}{[arXiv:1004.2307]}.

%\bibitem[Kaw96]{kawauchibook}
%A.~Kawauchi, \textsl{A {S}urvey of {K}not {T}heory}, Birkh\"auser, 1996.
%
%\bibitem[Kho00]{k9908171}
%M.~Khovanov, \textsl{A categorification of the {J}ones polynomial}, Duke Math. J.
%  \textbf{101} (2000), 359--426,
%  \href{http://arxiv.org/abs/math/9908171}{[math.QA/9908171]}.
%
%\bibitem[Kho07]{k0510265}
%M.~Khovanov, \textsl{Triply-graded link homology and Hochschild homology of Soergel bimodules},
%  Int. Journal of Math. \textbf{18} (2007), 869--885,
%  \href{http://arxiv.org/abs/math/0510265}{[math.GT/0510265]}.
%
%\bibitem[KR07a]{kr0701333}
%M.~Khovanov and L.~Rozansky, \textsl{Virtual crossings, convolutions and a
%  categorification of the {$\operatorname{SO}(2N)$} {K}auffman polynomial},
%  Journal of G\"okova Geometry Topology \textbf{1} (2007), 116--214,
%  \href{http://arxiv.org/abs/math/0701333}{[math.QA/0701333]}.
%
%\bibitem[KR07b]{kr0404189}
%M.~Khovanov and L.~Rozansky, \textsl{Topological Landau-Ginzburg models on the world-sheet foam},
%  Adv. Theor. Math. Phys. \textbf{11} (2007), 233--259,
%  \href{http://arxiv.org/abs/hep-th/0404189}{[hep-th/0404189]}.
%
%\bibitem[KR08a]{kr0401268}
%M.~Khovanov and L.~Rozansky, \textsl{Matrix factorizations and link homology}, Fund. Math.
%  \textbf{199} (2008), 1--91,
%  \href{http://arxiv.org/abs/math/0401268}{[math/0401268]}.
%
%\bibitem[KR08b]{kr0505056}
%M.~Khovanov and L.~Rozansky, \textsl{Matrix factorizations and link homology {II}}, Geometry \&
%  Topology \textbf{12} (2008), 1387--1425,
%  \href{http://arxiv.org/abs/math/0505056}{[math.QA/0505056]}.
%
%\bibitem[Ko]{Kock}
%J.~Kock, \textsl{Frobenius Algebras and 2D Topological Quantum Field Theories}, Cambridge University Press, 2003.
%
%\bibitem[Lam86]{LambekRingsModules}
%J.~Lambek, \textsl{Lectures on rings and modules}, AMS Chelsea Publishing, 1986.

\bibitem[LM]{Calinetal}
C.~I. Lazaroiu and D.~McNamee, unpublished.

\bibitem[Lo]{Loday}
J.-L. Loday, \textsl{Cyclic homology}, Springer, 1997.

%\bibitem[LMnV00]{lmv0010102}
%J.~M.~F. Labastida, M.~Mari\~{n}o, and C.~Vafa, \textsl{Knot {I}nvariants and
%  {T}opological {S}trings}, JHEP \textbf{0011} (2000), 007,
%  \href{http://arxiv.org/abs/hep-th/0010102}{[hep-th/0010102]}.
%
%\bibitem[MSV09]{msv0708.2228}
%M.~Mackaay, M.~Sto\v{s}i\'{c}, and P.~Vaz, \textsl{$\mathfrak{sl}(N)$ link homology ($N\geq 4$) using foams and the Kapustin-Li formula}, Geometry \& Topology \textbf{13} (2009), 1075--1128,
%  \href{http://arxiv.org/abs/0708.2228}{[arXiv:0708.2228]}.
%
%\bibitem[Man07]{m0601629}
%C.~Manolescu, \textsl{Link homology theories from symplectic geometry}, Adv. in
%  Math. \textbf{211} (2007), 363--416,
%  \href{http://www.arxiv.org/abs/math.AG/0601629}{[math.SG/0601629]}.

\bibitem[McN09]{McNameethesis}
D.~McNamee, \textsl{On the mathematical structure of topological defects in
  {L}andau-{G}inzburg models}, MSc Thesis, Trinity College Dublin, 2009.
  
\bibitem[Mu]{m0912.1629}
D.~Murfet, \textsl{Residues and duality for singularity categories of isolated {G}orenstein singularities},
  \href{http://arxiv.org/abs/0912.1629}{[arXiv:0912.1629]}.  

%\bibitem[Mn05]{marinoknotbook}
%M.~Mari\~{n}o, \textsl{Chern-{S}imons {T}heory, {M}atrix {M}odels, and
%  {T}opological s{t}rings}, Oxford University Press, 2005.
%
%\bibitem[MOY98]{moy1998}
%H.~Murakami, T.~Ohtsuki, and S.~Yamada, \textsl{Homfly polynomial via an
%  invariant of colored plane graphs}, Enseign. Math. \textbf{44} (1998),
%  325--360.
%
%\bibitem[MS]{ms0709.1971}
%V.~Manzorchuck and C.~Stroppel, \textsl{A combinatorial approach to functorial
%  quantum {$\mathfrak{sl}_k$} knot invariants},
%  \href{http://arxiv.org/abs/0709.1971}{[arXiv:0709.1971]}.
%
%\bibitem[OV00]{ov9912123}
%H.~Ooguri and C.~Vafa, \textsl{Knot {I}nvariants and {T}opological {S}trings},
%  Nucl. Phys. B \textbf{577} (2000), 419--438,
%  \href{http://arxiv.org/abs/hep-th/9912123}{[hep-th/9912123]}.

\bibitem[P10]{p0807.1471}
K.~Ponto, \textsl{Shadows and traces in bicategories}, 
Ast\'erisque, (333), 2010, 
\href{http://arxiv.org/abs/0807.1471}{[arXiv:0807.1471]}. 

\bibitem[PS]{ps0910.1306}
K.~Ponto and M.~Shulman, \textsl{Shadows and traces in bicategories}, 
\href{http://arxiv.org/abs/0910.1306}{[arXiv:0910.1306]}. 

\bibitem[PV]{pv1002.2116}
A.~Polishchuk and A.~Vaintrob, \textsl{Chern characters and {H}irzebruch-{R}iemann-{R}och formula for matrix factorizations}, 
\href{http://arxiv.org/abs/1002.2116}{[arXiv:1002.2116]}. 


%\bibitem[PT87]{HomflyPT}
%J.~Przytycki and P.~Traczyk, \textsl{Conway algebras and skein equivalence of
%  links}, Proc. Amer. Math. Soc. \textbf{100} (1987), 744--748.
%
%\bibitem[Ras]{r0607544}
%J.~Rasmussen, \textsl{Some differentials on {K}hovanov-{R}ozansky homology},
%  \href{http://arxiv.org/abs/math/0607544}{[math.GT/0607544]}.
%
%\bibitem[Ras07]{r0508510}
%J.~Rasmussen, \textsl{Khovanov-{R}ozansky homology of two-bridge knots and links},
%  Duke Math. J. \textbf{136} (2007), 551--583,
%  \href{http://arxiv.org/abs/math/0508510}{[math.GT/0508510]}.
%  
%\bibitem[Ric94]{rickard}
%J.~Rickard, \textsl{Translation functors and equivalences of derived categories for blocks of algebraic groups}, in âFinite dimensional algebras and related topicsâ, Kluwer (1994), 255-â264.
%
%\bibitem[Rou06]{RouquierMexico}
%R.~Rouquier, \textsl{Categorification of {$\mathfrak{sl}_{2}$} and braid groups},
%  Trends in representation theory of algebras and related topics (2006),
%  137--167.
%
%\bibitem[RT90]{RT1990}
%N.~Reshetikhin and V.~Turaev, \textsl{Ribbon graphs and their invariants derived
%  from quantum groups}, Comm. Math. Phys. \textbf{127} (190), 1--26.
%
%\bibitem[RT91]{RT1991}
%N.~Reshetikhin and V.~Turaev, \textsl{Invariants of 3-manifolds via link polynomials and quantum
%  groups}, Invent. Math. \textbf{103} (1991), 547--597.
%
%\bibitem[SS06]{ss0405089}
%P.~Seidel and I.~Smith, \textsl{A link invariant from the symplectic geometry of
%  nilpotent slices}, Duke Math. J. \textbf{134} (2006), 453--514,
%  \href{http://arxiv.org/abs/math/0405089}{[math.SG/0405089]}.

\bibitem[SW11]{sw0911.0917}
C.~V.~Shepler and S.~Witherspoon, \textsl{Quantum differentiation and chain maps of bimodule complexes}, Algebra and Number Theory \textbf{5}-3 (2011), 339--360, 
\href{http://arxiv.org/abs/0911.0917}{[arXiv:0911.0917]}. 

%\bibitem[Str05]{sCatTLcTCpf}
%C.~Stroppel, \textsl{Categorification of the {T}emperley-{L}ieb category,
%  tangles, and cobordisms via projective functors}, Duke Math. J. \textbf{126}
%  (2005), 547--596.
%
%\bibitem[Sus]{s0701045}
%J.~Sussan, \textsl{Category {$\mathcal O$} and {$\mathfrak{sl}_k$} link
%  invariants}, \href{http://arxiv.org/abs/math/0701045}{[math.QA/0701045]}.
%
%\bibitem[Tur88]{t1988YB}
%V.~Turaev, \textsl{The {Y}ang-{B}axter equation and invariants of links}, Invent.
%  Math. \textbf{92} (1988), 527--553.
%
%\bibitem[Tur10]{turaevbook}
%V.~Turaev, \textsl{Quantum invariants of knots and 3-manifolds}, de Gruyter, 2010,
%  2nd edition.
%
%\bibitem[Weba]{w0610650}
%B.~Webster, \textsl{Khovanov-Rozansky homology via a canopolis formalism},
%  \href{http://arxiv.org/abs/math/0610650}{[math.GT/0610650]}.
%
%\bibitem[Webb]{w1005.4559}
%B.~Webster, \textsl{Knot invariants and higher representation theory {II}: the
%  categorification of quantum knot invariants},
%  \href{http://arxiv.org/abs/1005.4559}{[arXiv:1005.4559]}.
%
%\bibitem[Wit]{w1101.3216}
%E.~Witten, \textsl{Fivebranes and {K}nots},
%  \href{http://arxiv.org/abs/1101.3216}{[arXiv:1101.3216]}.
%
%\bibitem[Wit89]{wittenjones}
%E.~Witten, \textsl{Quantum field theory and the {J}ones polynomial}, Comm. Math.
%  Phys. \textbf{121} (1989), 351--399.
%
%\bibitem[Wit95]{w9207094}
%E.~Witten, \textsl{Chern-{S}imons {G}auge {T}heory {A}s {A} {S}tring {T}heory},
%  Prog. Math. \textbf{133} (1995), 637--678,
%  \href{http://arxiv.org/abs/hep-th/9207094}{[hep-th/9207094]}.
%
%\bibitem[Wu]{w0907.0695}
%H.~Wu, \textsl{A colored {$\mathfrak{sl}(N)$}-homology for links in {$S^3$}},
%  \href{http://arxiv.org/abs/0907.0695}{[arXiv:0907.0695]}.
%
%\bibitem[Wu08]{w0508064}
%H.~Wu, \textsl{Braids, {T}ransversal links and the {K}hovanov-{R}ozansky {T}heory},
%  \href{http://arxiv.org/abs/math/0508064}{[math.GT/0508064]}, Trans. Amer. Math. Soc. \textbf{360}
%  (2008), 3365--3389.
%
%\bibitem[Yon]{y0906.0220}
%Y.~Yonezawa, \textsl{Quantum {$(\mathfrak{sl}_n, \wedge V_n)$} link invariant and
%  matrix factorizations},
%  \href{http://arxiv.org/abs/0906.0220}{[arXiv:0906.0220]}.

\end{thebibliography}

\end{document}
