% Authors:  Nils Carqueville, Daniel Murfet
 
\documentclass{compositio}
\usepackage{stmaryrd}
\usepackage{amsmath, amscd, amssymb, mathrsfs, accents, amsfonts}
\usepackage{url}
\usepackage[all]{xy}
\usepackage{longtable}
\usepackage{dsfont}
\usepackage{tikz}
\def\nicenocolourscheme{\shadedraw[top color=gray!2, bottom color=gray!25, draw=gray!50!black, dashed]}
\definecolor{Myblue}{rgb}{0,0,0.6}
\usepackage[a4paper,colorlinks,citecolor=Myblue,linkcolor=Myblue,urlcolor=Myblue,pdfpagemode=None]{hyperref}

\SelectTips{cm}{}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem*{theoremn}{Theorem}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{s}[theorem]{}
\newtheorem*{setup}{Setup}
\newtheorem*{propositionn}{Proposition}

\numberwithin{equation}{section}

% Operators
\def\eval{\operatorname{ev}}
\def\coev{\operatorname{coev}}
\def\res{\operatorname{Res}}
\def\sg{\operatorname{sg}}
\def\Inj{\operatorname{Inj}}
\def\inc{\operatorname{inc}}
\def\Proj{\operatorname{Proj}}
\def\Coker{\operatorname{Coker}}
\def\Ker{\operatorname{Ker}}
\def\Im{\operatorname{Im}}
\def\free{\operatorname{free}}
\def\can{\operatorname{can}}
\def\ac{\operatorname{ac}}
\def\HH{\operatorname{HH}}
\def\K{\mathbf{K}}
\def\D{\mathbf{D}}
\def\N{\mathbf{N}}
\def\sing{\operatorname{Sg}}
\def\Hom{\operatorname{Hom}}
\def\uHom{\underline{\Hom}}
\def\modd{\operatorname{mod}}
\def\Modd{\operatorname{Mod}}
\def\Grmodd{\operatorname{GrMod}}
\def\CM{\operatorname{CM}}
\def\Ker{\operatorname{Ker}}
\def\Spec{\operatorname{Spec}}
\def\straightK{\operatorname{K}}
\def\straightC{\operatorname{C}}
\def\holim{\operatorname{hocolim}}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\coh}{coh}
\DeclareMathOperator{\serre}{S}
\DeclareMathOperator{\Flat}{Flat}
\DeclareMathOperator{\qc}{qc}
\DeclareMathOperator{\Perf}{Perf}
\DeclareMathOperator{\Map}{Map}
\DeclareMathOperator{\Qco}{Qco}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\tot}{Tot}
\DeclareMathOperator{\skos}{K}
\DeclareMathOperator{\hht}{ht}
\DeclareMathOperator{\depth}{depth}
\DeclareMathOperator{\STr}{STr}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\str}{str}
\DeclareMathOperator{\hmf}{hmf}
\DeclareMathOperator{\HMF}{HMF}
\DeclareMathOperator{\HF}{HF}
\DeclareMathOperator{\pr}{pr}
\DeclareMathOperator{\At}{At}
\DeclareMathOperator{\mff}{mf}
\DeclareMathOperator{\MF}{MF}
\DeclareMathOperator{\Sh}{Sh}

\begin{document}

% Commands
\def\Res{\res\!}
\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\lto}{\longrightarrow}
\newcommand{\xlto}[1]{\stackrel{#1}\lto}
\newcommand{\mf}[1]{\mathfrak{#1}}
\newcommand{\md}[1]{\mathscr{#1}}
\newcommand{\intvar}{\bs{x}_{\textup{int}}}
\newcommand{\extvar}{\bs{x}_{\textup{ext}}}
\newcommand{\qderu}[2]{\mathbf{D}^{#1}(#2)}
\newcommand{\ud}{\mathrm{d}}
\def\l{\,|\,}
\def\cf{\boldsymbol{cf}}
\def\bx{\boldsymbol{x}}
\def\by{\boldsymbol{y}}
\def\ba{\boldsymbol{a}}
\def\bb{\boldsymbol{b}}
\def\totimes{\otimes}
\def\di{Q}
\newcommand{\cotimes}[1]{\,\widehat{\otimes}_{#1}\,}
\def\QQ{\mathds{Q}}
\def\krc{C}
\def\diffm{d}
\def\diffh{d_{\chi}}
\def\redh{\overline{H}}
\def\ZZ{\mathds{Z}}
\def\bs{\boldsymbol}
\def\Ztwo{\mathds{Z}_2}
\def\mdual{^{\vee}}
\def\KR{\operatorname{KR}}
\def\I{\!\operatorname{i}\!}
\def\E{\operatorname{e}\!}
\def\sln{\mathfrak{sl}(N)}
\def\nN{\mathds{N}}
\def\nZ{\mathds{Z}}
\def\nQ{\mathds{Q}}
\def\nR{\mathds{R}}
\def\nC{\mathds{C}}
\def\Bar{\mathds{B}}
\def\cBar{\widehat{\mathds{B}}}
\def\Re{R^{\operatorname{e}}}
\def\lra{\longrightarrow}
\def\lmt{\longmapsto}
\def\LG{\mathcal{LG}_k}
\def\dual{\dagger}
\def\dlangle{\big\langle\!\big\langle}
\def\drangle{\big\rangle\!\big\rangle}
\def\bigdlangle{\Big\langle\!\Big\langle}
\def\bigdrangle{\Big\rangle\!\Big\rangle}
\newcommand{\Ress}[1]{\res_{#1}\!}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\def\Xcirc{%
\begin{tikzpicture}[inner sep=0mm]
\node (X) at (0,0) {$X$};
\node (0) at (0,0) [circle,inner sep=0.99pt, thin,draw=black,fill= white] {};
\end{tikzpicture}%
}
\def\Xbul{%
\begin{tikzpicture}[inner sep=0mm]
\node (X) at (0,0) {$X$};
\node (0) at (0,0) [circle,inner sep=0.99pt, thin,draw=black,fill= black] {};
\end{tikzpicture}%
}

\allowdisplaybreaks

\usetikzlibrary{arrows,calc,decorations.pathreplacing,decorations.markings,shapes.geometric,shadows}
\tikzset{
    string/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .51 with {\arrow[draw=#1]{>}}}},
    costring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .51 with {\arrow[draw=#1]{<}}}},
    ostring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .47 with {\arrow[draw=#1]{>}}}},
    ustring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .56 with {\arrow[draw=#1]{>}}}},
    oostring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .43 with {\arrow[draw=#1]{>}}}},
    uustring/.style={draw=#1, postaction={decorate}, decoration={markings,mark=at position .59 with {\arrow[draw=#1]{>}}}},
    directed/.style={string=blue!50!black}, 
    odirected/.style={ostring=blue!50!black}, 
    udirected/.style={ustring=blue!50!black}, 
    oodirected/.style={oostring=blue!50!black}, 
    uudirected/.style={uustring=blue!50!black},     
    redirected/.style={costring= blue!50!black},
}

\usetikzlibrary{fadings,decorations.pathreplacing}

\newcommand\pgfmathsinandcos[3]{%
  \pgfmathsetmacro#1{sin(#3)}%
  \pgfmathsetmacro#2{cos(#3)}%
}
\newcommand\LongitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % azimuth
  \tikzset{#1/.estyle={cm={\cost,\sint*\sinEl,0,\cosEl,(0,0)}}}
}
\newcommand\LatitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % latitude
  \pgfmathsetmacro\yshift{\cosEl*\sint}
  \tikzset{#1/.estyle={cm={\cost,0,0,\cost*\sinEl,(0,\yshift)}}} %
}
\newcommand\DrawLongitudeCircle[2][1]{
  \LongitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\angVis{atan(sin(#2)*cos(\angEl)/sin(\angEl))} %
  \draw[redirected,current plane,color=blue!50!black, very thick] (\angVis:1) arc (\angVis:\angVis+180:1);
  \draw[current plane,dotted,color=blue!50!gray, very thick] (\angVis-180:1) arc (\angVis-180:\angVis:1);
}
\newcommand\DrawLatitudeCircle[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[directed,current plane, color=blue!50!black] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed, color=blue!50!gray] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}
\newcommand\DrawLatitudeCircleU[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[redirected,current plane, color=blue!50!black] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed, color=blue!50!gray] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}





\title{Rise of the Planet of the Coevaluations}
\author{Nils Carqueville}
\email{nils.carqueville@physik.uni-muenchen.de}
\address{Arnold Sommerfeld Center for Theoretical Physics, LMU M\"unchen \& Excellence Cluster Universe}

\author{Daniel Murfet}
\email{daniel.murfet@math.ucla.edu}
\address{Department of Mathematics, UCLA}

\classification{TODO}

\begin{abstract}
They take over. 
\end{abstract}

\maketitle


\section{Background}\label{sec:Background}

\subsection{Bicategory of Landau-Ginzburg models}\label{subsec:bicatLG}

Let us fix the ring $R=k[x_1,\ldots,x_n]$, where~$k$ is a commutative noetherian $\nQ$-algebra; relevant examples are $k=\nC$ and $k=\nC[t_1,\ldots,t_d]$. Typically we will simply write $k[x]$ for $k[x_1,\ldots,x_n]$. We call an element $W\in R$ a \textsl{potential} if $R/(\partial_{x_i}W)$ is finitely generated projective over~$k$ and the $\partial_{x_i}W$ form a regular sequence. 

A \textsl{linear factorisation} of a potential $W\in R$ is a $\nZ_2$-graded $R$-module $X=X^0\oplus X^1$ together with an odd $R$-linear endomorphism~$d_X$ such that $d_X^2=W\cdot 1_X$. If~$X$ is a free $R$-module then the pair $(X,d_X)$ is called a \textsl{matrix factorisation}, and we often refer to it simply by~$X$ without explicitly mentioning the \textsl{differential} $d_X$. 

A \textsl{morphism} of linear factorisations $(X,d_X)$ and $(Y,d_Y)$ is an even $R$-linear map $\varphi: X \longrightarrow Y$ such that $d_Y \varphi = \varphi d_X$. Two morphisms $\varphi, \psi: X\lra Y$ are \textsl{homotopic} if there exists an odd $R$-linear map $\lambda:X\lra Y$ such that $d_Y\lambda + \lambda d_X = \psi-\varphi$. Equality up to homotopy is an equivalence relation. 

The \textsl{(homotopy) category of linear factorisations} $\HF(R,W)$ is the category of linear factorisations of $W\in R$ modulo homotopy relations. We denote by $\HMF(R,W)$ its full subcategory of matrix factorisations, and we write $\hmf(R,W)$ for the full subcategory of matrix factorisations whose objects are isomorphic to matrix factorisations with finitely-generated underlying $R$-modules. These three categories have standard triangulated structures whose shift functor we denote as~$[1]$. 

Given a potential $W\in R=k[x]$ there is always the \textsl{unit matrix factorisation} $\Delta_W \in \hmf(\Re, \widetilde W)$ where $\Re = R\otimes_k R$ and $\widetilde W = W\otimes 1 - 1\otimes W$. Introducing~$n$ formal symbols $\theta_i$ as a convenient notational device, we have 
$$
\Delta_W = \bigwedge \Big( \bigoplus_{i=1}^n \Re \theta_i \Big)
$$
as an $\Re$-module whose $\nZ_2$-grading is given by $\theta$-degree modulo~2. We write $\pi: \Delta_W \lra \Re$ for the projection to the $\theta$-degree~$0$ component and $\mu:\Re \lra R$ for multiplication. Typically we will omit the wedge product and write  e.\,g.~$\theta_i\wedge \theta_j$ simply as $\theta_i \theta_j$. To describe the differential $d_{\Delta_W}$ we further need the variable-changing map
$$
{}^{t_i}(-): k[x,y] \lra k[x,y] \, , \qquad p \lmt p\big|_{x_i\lmt y_i}
$$
in terms of which we can define difference quotient operators
$$
\partial_{[i]}: k[x,y] \lra k[x,y] \, , \qquad p \lmt \frac{{}^{t_1\ldots t_{i-1}}p - {}^{t_1\ldots t_i}p}{x_i-y_i} \, . 
$$
In terms of these the differential on $\Delta_W$ is given by
\be\label{DeltaW}
d_{\Delta_W} = \delta_+ + \delta_- \, , \qquad \delta_+ = \sum_{i=1}^n \partial_{[i]}W\cdot \theta_i\, , \qquad \delta_- =  \sum_{i=1}^n (x_i-y_i) \cdot \theta_i^*  \,. 
\ee

TODO: Put lemma on Leibniz rule for $\partial_{[i]}$ here or later? 

We call $\Delta_W$ the unit matrix factorisation as it is the unit with respect to the tensor product of matrix factorisations. For our purposes it will be sufficient to consider matrix factorisations $X\in \HMF(R_1\otimes_k R_2, W_2-W_1)$ and $Y\in \HMF(R_2\otimes_k R_3, W_3-W_2)$ (where of course $R_i = k$ is a possibility for any~$i$). Then the \textsl{tensor product matrix factorisation} $Y\otimes X \in \HMF(R_1\otimes_k R_3, W_3-W_1)$ is the module 
$$
Y\otimes X = \Big( (Y^0\otimes_{R_2} X^0) \oplus (Y^1\otimes_{R_2} X^1) \Big) \oplus \Big( (Y^0\otimes_{R_2} X^1) \oplus (Y^1\otimes_{R_2} X^0) \Big) 
$$
together with the differential
$$
d_{Y\otimes X} = d_Y \otimes 1 + 1 \otimes d_X
$$
where the second term comes with the usual Koszul signs when applied to elements. We  observe that e.\,g.~by the argument of~\cite[Section~12]{dm1102.2957} the tensor product does not lead out of the categories $\hmf(R_i \otimes_k R_j, W_j - W_i)$. Also note that there are obvious natural isomorphisms $\alpha_{X,Y,Z}: (X\otimes Y)\otimes Z \lra X\otimes (Y \otimes Z)$. 

Now we can be more specific about the tensor action of the unit matrix factorisation. For $X\in \hmf(R_1 \otimes_k R_2,W_2-W_1)$ there are natural maps
\be\label{lambdarho}
\lambda_X = \mu\pi \otimes 1_X: \Delta_{W_2} \otimes X \lra X \, , \qquad \rho_X = 1_X \otimes \mu\pi : X \otimes \Delta_{W_1} \lra X
\ee
which are isomorphisms in $\hmf(R_1 \otimes_k R_2,W_2-W_1)$. Later in Section~\ref{TODO} we will give a description of their explicit homotopy inverses. 

\begin{definition}
The \textsl{bicategory of Landau-Ginzburg models} $\LG$ consists of the following data: 
\begin{itemize}
\item Objects are pairs $(R,W)$ with $W\in R=k[x]$ a potential. 
\item 1- and 2-morphisms are the objects and morphisms of the categories $\hmf(R_1 \otimes_k R_2,W_2-W_1)$, respectively. 
\item The unit 1-morphisms are $\Delta_W \in \hmf(\Re,\widetilde W)$. 
\item The composition functor is the tensor product
$$
\otimes : \hmf(R_2 \otimes_k R_3,W_3-W_2) \times \hmf(R_2 \otimes_k R_3,W_3-W_2) \lra \hmf(R_1 \otimes_k R_3,W_3-W_1) \, .
$$
\item There are natural 2-isomorphisms $\alpha, \lambda, \rho$ as above. 
\end{itemize}¥
\end{definition}

\begin{proposition}[\cite{McNameethesis, Calinetal, cr0909.4381}] 
$\LG$ really is a bicategory, i.\,e.~$\alpha, \lambda, \rho$ are natural isomorphisms up to homotopy, and they satisfy the coherence axioms for bicategories. 
\end{proposition}

One of the main results of the present paper is that $\LG$ is endowed with an additional duality structure. Let us recall the relevant notion. 

\begin{definition}\label{def:bicatduals}
We say a bicategory~$\mathcal B$ \textsl{has duals} (or equivalently, that \textsl{every} 1-morphism is \textsl{dualisable}) if for each 1-morphism $X\in \mathcal B(A,B)$ there exists a 1-morphism $X^\dual \in \mathcal B(B,A)$ together with 2-morphisms 
\be\label{evcoev}
\eval_X : X^\dual \otimes X \lra 1_A \, , \qquad \coev_X : 1_B \lra X \otimes X^\dual
\ee
satisfying 
\begin{align}
\rho_X \circ (1_X \otimes \eval_X) \circ \alpha_{X,X^\dual,X} \circ (\coev_X \otimes 1_X) \lambda_X^{-1} & = 1_X \, , \label{uglyZorro1}\\
\lambda_{X^\dual} \circ (\eval_X \otimes 1_{X^\dual}) \circ \alpha^{-1}_{X^\dual,X,X^\dual} \circ (1_{X^\dual} \otimes \coev_X) \circ \rho_{X^\dual}^{-1} & = 1_{X^\dual} \, . \label{uglyZorro2}
\end{align}
\end{definition}

It is convenient (and also suggested by the motivation discussed in the Introduction) to denote identities in bicategories with duals in string diagram notation, see e.\,g.~\cite{TODO} for more details. In this language the evaluation and coevaluation maps~\eqref{evcoev} are written as
$$
\eval_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_A$}}
(3,0) node[line width=0pt] (D) {{\small $X\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {\small{$X^\dual$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {{\small$X^\dual$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture} , 
\qquad
\coev_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_B$}}
(3,0) node[line width=0pt] (D) {{\small$X\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {{\small$X^\dual$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X\vphantom{A^\dual}$}}
(2,0) node[line width=0pt] (s) {{\small$X^\dual$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture} \, . 
$$
Note that such diagrams are always to be read from bottom to top. Then the defining relations~\eqref{uglyZorro1} and~\eqref{uglyZorro2} translate into the \textsl{Zorro moves}
\be\label{Zorros}
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(-1,1.25) node[line width=0pt] (A) {{\small $X$}}
(1,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw[directed] (0,0) .. controls +(0,-1) and +(0,-1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,1) and +(0,1) .. (0,0);
\draw (-1,0) -- (A); 
\draw (1,0) -- (A2); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw (A2) -- (A); 
\end{tikzpicture}
\, , \qquad
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(1,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(-1,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw[directed] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[directed] (1,0) .. controls +(0,-1) and +(0,-1) .. (0,0);
\draw (-1,0) -- (A2); 
\draw (1,0) -- (A); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw (A2) -- (A); 
\end{tikzpicture} \, .
\ee

The dual~$X^\dual$ of~$X$ as described in Definition~\ref{def:bicatduals} is more precisely called the~\textsl{right dual} to~$X$, though we will mostly continue to simply speak of duals without a further attribute. However, let us mention that~$X^\dual$ is called the \textsl{left dual} to~$X$ if there are maps 
$$
\widetilde\eval_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_B$}}
(3,0) node[line width=0pt] (D) {{\small $X^\dual\vphantom{X^\dual}$}}
(2,0) node[line width=0pt] (s) {\small{$X\vphantom{X^\dual}$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=.6cm]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X^\dual$}}
(2,0) node[line width=0pt] (s) {{\small$X\vphantom{X^\dual}$}}; 
\draw[redirected] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture} , 
\qquad
\widetilde\coev_{X} = 
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(2.5,1.6) node[line width=0pt] (I) {{\small$1_A$}}
(3,0) node[line width=0pt] (D) {{\small$X^\dual$}}
(2,0) node[line width=0pt] (s) {{\small$X\vphantom{X^\dual}$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\draw[dashed] (2.5,0.81) -- (I);
\end{tikzpicture}
\equiv
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=-.6cm,rotate=180]
\draw[line width=0pt] 
(3,0) node[line width=0pt] (D) {{\small$X^\dual$}}
(2,0) node[line width=0pt] (s) {{\small$X\vphantom{X^\dual}$}}; 
\draw[directed] (D) .. controls +(0,1) and +(0,1) .. (s);
\end{tikzpicture}
$$
satisfying the associated Zorro moves
\be\label{otherZorros}
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(1,1.25) node[line width=0pt] (A) {{\small $X$}}
(-1,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw[redirected] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[redirected] (1,0) .. controls +(0,-1) and +(0,-1) .. (0,0);
\draw (-1,0) -- (A2); 
\draw (1,0) -- (A); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X$}}; 
\draw (A2) -- (A); 
\end{tikzpicture}
\, , \qquad
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(-1,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(1,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw[redirected] (0,0) .. controls +(0,-1) and +(0,-1) .. (-1,0);
\draw[redirected] (1,0) .. controls +(0,1) and +(0,1) .. (0,0);
\draw (-1,0) -- (A); 
\draw (1,0) -- (A2); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,1.25) node[line width=0pt] (A) {{\small $X^\dual$}}
(0,-1.25) node[line width=0pt] (A2) {{\small $X^\dual$}}; 
\draw (A2) -- (A); 
\end{tikzpicture} \, .
\ee

Checking that the Zorro moves hold in $\LG$ with the evaluation and coevaluation maps~\eqref{TODO} and duals $X^\dual = X^\vee[n]$ (all to be discussed in detail in Section~\ref{TODO}) is no easy task. Instead of tackling it directly we will in an intermediate step first prove the Zorro moves using a different model for the unit matrix factorisation, namely the completed bar complex of the ring~$R$. As preparation we shall next discuss some background on non-commutative forms. 

\subsection{Bar complex}\label{subsec:Bar}

Let us for the moment be slightly more general and consider an arbitrary unital associative $k$-algebra~$A$. In our applications to matrix factorisations we will set $A=R=k[x]$. 

\textsl{Non-commutative $n$-forms over~$A$} are elements in 
$$
\Omega^n A = A\otimes \bar A^{\otimes n} 
$$
where $\bar A = A/k$ and in this section by ``$\otimes$'' we mean ``$\otimes_k$''. We denote the projection of $a_0\otimes a_1 \otimes \ldots \otimes a_n \in A^{\otimes n}$ to $\Omega^n A$ as $(a_0,a_1,\ldots,a_n)$. The direct sum 
$$
\Omega A = \bigoplus_{n\geq 0} \Omega^n A
$$
is a differential graded algebra $(\Omega A, d, \cdot)$ with multiplication given by
$$
(a_0,\ldots,a_m) \cdot (a_{m+1},\ldots, a_{m+n}) = \sum_{i=0}^m (-1)^{m-i}(a_0,\ldots,a_{i-1},a_i a_{i+1},a_{i+2},\ldots, a_{m+n}) 
$$
and differential
$$
d: (a_0,\ldots,a_n) \lmt (1,a_0,\ldots,a_n)
$$
where $a_i\in A$. We will write $(a_0,a_1,\ldots,a_n)$ also as $a_0da_1\ldots da_n$. 

More generally one can consider relative non-commutative forms: for a subalgebra $B\subset A$ they are elements in $\Omega_B A = \bigoplus_{n\geq 0} A\otimes_B (A/B)^{\otimes_B n}$, which has a differential graded structure analogous to $\Omega A = \Omega_k A$. We refer to the book~\cite{Loday} for further details. 

A central role is played by the \textsl{(normalised) bar complex} 
$$
\Bar = \bigoplus_{n\geq 0} \Bar_n \, , \qquad \Bar_n = \Omega^n A \otimes A \, .
$$
It is an $(A^{\text{op}} \otimes A)$-module via $(a\otimes a').(a_0da_1\ldots da_n\otimes a_{n+1}) = aa_0da_1\ldots da_n\otimes a_{n+1}a'$. Together with the differential $d\otimes 1_A$ (which by standard abuse of notation we usually simply write~$d$) and the product induced from $\Omega A$ and~$A$, the bar complex~$\Bar$ is a differential graded algebra $(\Bar,d,\cdot)$ as well. 

There is a second differential graded structure on~$\Bar$ if the algebra~$A$ is commutative. To describe it let us first recall that (still for arbitrary~$A$) the bar complex is the standard resolution 
$$
\xymatrix{%
\cdots \ar[r]^-{b'} & A \otimes \bar A^{\otimes 2} \otimes A \ar[r]^-{b'} & A \otimes \bar A \otimes A \ar[r]^-{b'} & A\otimes A \ar[r]^-{b'} & A \ar[r] & 0
}%
$$
of~$A$, where the degree-lowering differential~$b'$ is the $A$-bilinear map
$$
b': (a_0,\ldots,a_n)\otimes a_{n+1} \lmt \sum_{i=0}^{n-1} (-1)^i (a_0,\ldots,a_i a_{i+1},\ldots, a_n) \otimes a_{n+1} + (-1)^n (a_0,\ldots,a_{n-1}) \otimes a_n a_{n+1} \, . 
$$
%Equivalently, in differential form notation~$b'$ acts as
%$$
%b': da_0\ldots da_n\otimes a_{n+1} \lmt (-1)^{n-1} a_0da_1\ldots da_{n-1} \cdot a_n \otimes a_{n+1} + (-1)^n a_0 da_1\ldots da_{n-1} \otimes a_n a_{n+1} \, . 
%$$
From this it is straightforward to check that we have the identity
\be\label{b'd+db'}
b'd+db'=1_{\Bar} \, .
\ee

From now on we assume that~$A$ is commutative. Recall that $(m,n)$-shuffles are permutations in
$$
\operatorname{Sh}(m,n) = \big\{ \sigma\in S_{m+n} \,|\, \sigma(1)<\sigma(2)<\ldots<\sigma(m), \, \sigma(m+1)<\sigma(m+2)<\ldots<\sigma(m+n) \big\} \, . 
$$
We use them to define the $A$-bilinear \textsl{shuffle product}~$\times$ on~$\Bar$ as
\begin{align*}
& (a_0da_1\ldots da_m \otimes a_{m+1}) \times (b_0db_1\ldots db_n \otimes b_{n+1}) \\
& \qquad 
= \sum_{\sigma_{\operatorname{Sh}(m,n)}} (-1)^{|\sigma|} a_0 b_0 \, \sigma_\bullet (da_1\ldots da_m db_1 \ldots db_n) \otimes a_{m+1} b_{n+1}
\end{align*}
where $\sigma_\bullet(da_1\ldots da_j) = da_{\sigma(1)}\ldots da_{\sigma(j)}$. One finds that $(\Bar,b',\times)$ is a graded-commutative differential graded algebra. Note that for $\omega\in A\otimes A=\Bar_0$ it follows immediately that $\omega\times(-) = \omega\cdot(-)$. 

We now return to the $k$-algebra $A=R=k[x_1,\ldots,x_n]$. Earlier we set $\widetilde W = W\otimes 1 - 1\otimes W \in \Re$ for a potential $W\in R$, in terms of which we now define the bar complex endomorphism
$$
d_{\Bar} = b' + d\widetilde W \times (-) \, . 
$$
\begin{lemma}
$(\Bar,d_{\Bar})$ is a linear factorisation of $\widetilde W\in \Re$. 
\end{lemma}

\begin{proof}
The bar complex $\Bar=\Bar^0 \oplus \Bar^1$ is $\nZ_2$-graded with $\Bar^i = \bigoplus_{n\in 2\nN+i}\Bar_n$. Since~$b'$ and~$\times$ are both $R$-bilinear, $d_{\Bar}$ is indeed $\Re$-linear. Furthermore, we have $b'^2=0$ and $d\widetilde W \times d\widetilde W = (dW\otimes 1) \times (dW\otimes 1) = dWdW\otimes 1 - dWdW \otimes 1 = 0$, so that for $\omega\in\Bar$ we find 
\begin{align*}
d_{\Bar}^2 (\omega) & = b'(d\widetilde W \times \omega) + d\widetilde W \times b'(\omega) \\
& = b'(d\widetilde W) \times \omega - d\widetilde W \times b'(\omega) + d\widetilde W \times b'(\omega) \\
& = \widetilde W \times \omega \\
& = \widetilde W \cdot \omega
\end{align*}
where in the second last step we used~\eqref{b'd+db'} together with $b'(\widetilde W)=0$. 
\end{proof}

If we use~$\pi$ also to denote the projection $\BarÊ\lra \Bar_0 = \Re$, then $\mu\pi \otimes 1_X : \Bar \otimes X \lra X$ and $1_X \otimes \mu\pi: X \otimes \Bar \lra X$ give left and right actions of~$\Bar$ as in~\eqref{lambdarho}. These maps have homotopy inverses too and we will construct them in Section~\ref{TODO}. For the moment we take the fact that~$\Bar$ is another model for the unit action on matrix factorisations as motivation to discuss its relation to the Koszul matrix factorisation~$\Delta_W$. Before we do this on the level of linear factorisations we shall consider the special case $W=0$. We write $\Delta = \Delta_0 = \bigwedge( \bigoplus_{i=1}^n \Re \theta_i)$ and observe that now $(\Delta_W, d_{\Delta_W})$ reduces to the ordinary Koszul complex $(\Delta, \delta_-)$, see~\eqref{DeltaW}

There are two $\Re$-linear maps between~$\Bar$ and~$\Delta$ which will be important to us: 
\begin{align*}
\Phi & : \Delta \lra \Bar \, , \qquad \theta_{i_1}\ldots \theta_{i_p} \lmt \sum_{\sigma\in S_p} (-1)^{|\sigma|} dx_{i_{\sigma(1)}} \ldots dx_{i_{\sigma(p)}} \otimes 1 \, , \\
\Psi & : \Bar \lra \Delta \, , \qquad df_1\ldots df_p \otimes 1 \lmt \sum_{1\leq i_1<\ldots<i_p\leq n} \Big( \prod_{k=1}^p \partial_{[i_k]} f_k \Big) \, \theta_{i_1} \ldots \theta_{i_p} \, .
\end{align*}
These maps were studied in~\cite{sw0911.0917}, we only rephrase the presentation of~$\Psi$ in terms of the difference quotient operators~$\partial_{[i]}$ suitable for our setting. One easily verifies that $\Psi\Phi = 1_\Delta$. 

\begin{lemma}\label{PhiPsiDG}
Both~$\Phi$ and~$\Psi$ are maps of differential graded algebras between $(\Delta, \delta_-, \wedge)$ and $(\Bar, b', \times)$. 
\end{lemma}

\begin{proof}
We refer to~\cite{sw0911.0917} for the case of~$\Phi$; since our expression for~$\Psi$ is not manifestly the same as in loc.~cit.~we spell out the proof. Let us first show that~$\Psi$ is compatible with the differentials. On the one hand we compute $(\delta_- \Psi) (df_1\ldots df_p \otimes 1)$ to be 
\begin{align}
& \delta_ -\Big( \sum_{i_1<\ldots <i_p} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_1} \ldots \theta_{i_p} \Big) \nonumber \\
& =  \sum_{j=1}^n \sum_{i_1<\ldots <i_p} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_p]} f_p) \cdot (x_j - y_j) \sum_{k=1}^p (-1)^{k+1} \delta_{j i_k} \theta_{i_1} \ldots \widehat{\theta_{i_k}} \ldots \theta_{i_p}  \nonumber \\
& = \sum_{k=1}^p (-1)^{k+1}\sum_{i_1<\ldots <i_p} (\partial_{[i_1]} f_1) \ldots ({}^{t_1\ldots t_{i_{k-1}}} f_k - {}^{t_1\ldots t_{i_{k}}} f_k) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_1} \ldots \widehat{\theta_{i_k}} \ldots \theta_{i_p}  \nonumber \\
& = \sum_{2\leq t_2<\ldots< i_p} (f_1 - {}^{t_1\ldots t_{i_{2}-1}} f_1) (\partial_{[i_2]} f_2) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_2} \ldots \theta_{i_p} \nonumber \\
& \qquad + \sum_{k=2}^{p-1} (-1)^{k+1}\sum_{i_1,\ldots,i_p} (\partial_{[i_1]} f_1) \ldots ({}^{t_1\ldots t_{i_{k-1}}} f_k - {}^{t_1\ldots t_{i_{k+1}-1}} f_k) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_1} \ldots \widehat{\theta_{i_k}} \ldots \theta_{i_p}  \nonumber \\
& \qquad + (-1)^{p+1} \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) ({}^{t_1\ldots t_{i_{p-1}}} f_p - {}^{t_1\ldots t_n} f_p)  \, \theta_{i_1} \ldots \theta_{i_{p-1}} \nonumber \\
& = \sum_{2\leq t_2<\ldots <i_p} f_1 (\partial_{[i_2]} f_2) \ldots (\partial_{[i_p]} f_p) \, \theta_{i_2} \ldots \theta_{i_p} \nonumber \\
& \qquad + (-1)^{p} \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p  \, \theta_{i_1} \ldots \theta_{i_{p-1}}  \label{delPsi} 
\end{align}
while on the other hand $(\Psi b') (df_1\ldots df_p \otimes 1)$ equals
\begin{align*}
& \Psi \Big( f_1 df_2 \ldots df_p \otimes 1 + \sum_{k=1}^{p-1} (-1)^k df_1 \ldots d(f_k f_{k+1}) \ldots df_p \otimes 1 + (-1)^p df_1 \ldots df_{p-1} \otimes f_p \Big) \\
& = \sum_{i_1<\ldots< i_{p-1}} f_1 (\partial_{[i_1]} f_2) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad + \sum_{k=1}^{p-1} (-1)^k \sum_{i_1<\ldots< i_{p-1}} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_k]} (f_k f_{k+1}) )\ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad + (-1)^p \sum_{i_1<\ldots< i_{p-1}} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& = \sum_{2\leq i_1<\ldots< i_{p-1}} f_1 (\partial_{[i_1]} f_2) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\ 
& \qquad + \sum_{2\leq i_2 \ldots< i_{p-1}} f_1 (\partial_{[1]} f_2) (\partial_{[i_2]} f_3) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\ 
& \qquad + \sum_{k=1}^{p-1} (-1)^k \sum_{i_1<\ldots< i_{p-1}} (\partial_{[i_1]} f_1) \ldots \big\{ ({}^{t_1\ldots t_{i_k -1}}f_k)(\partial_{[i_k]} f_{k+1}) \\
& \qquad\quad + (\partial_{[i_k]} f_k) ({}^{t_1\ldots t_{i_k}} f_{k+1}) \big\} \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad + (-1)^p \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& \qquad\quad + (-1)^p \sum_{i_1<\ldots< i_{p-2}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\
& = \sum_{2\leq i_1<\ldots< i_{p-1}} f_1 (\partial_{[i_1]} f_2) \ldots (\partial_{[i_{p-1}]} f_p) \, \theta_{i_1} \ldots \theta_{i_{p-1}} \\ 
& \qquad + (-1)^p \sum_{i_1<\ldots< i_{p-1}\leq n-1} (\partial_{[i_1]} f_1) \ldots (\partial_{[i_{p-1}]} f_{p-1}) \, {}^{t_1\ldots t_n} f_p \, \theta_{i_1} \ldots \theta_{i_{p-1}} 
\end{align*}
which agrees with~\eqref{delPsi}. 

To establish compatibility with the products we compute 
\begin{align*}
& \Psi( df_1\ldots df_p \otimes 1) \wedge \Psi( df_{p+1}\ldots df_{p+q} \otimes 1) \\ 
=\, & \Big\{ \sum_{i_1<\ldots< i_p} \Big( \prod_{k=1}^p \partial_{[i_k]} f_k \Big) \theta_{i_1} \ldots \theta_{i_p}\Big\} 
\wedge 
\Big\{ \sum_{i_{p+1}<\ldots< i_{p+q}} \Big( \prod_{k=p+1}^{p+q} \partial_{[i_k]} f_k \Big) \theta_{i_{p+1}} \ldots \theta_{i_{p+q}} \Big\} \\
= \, & \sum_{i_1<\ldots< i_p} \sum_{i_{p+1}<\ldots< i_{p+q}} \Big( \prod_{k=1}^{p+q} \partial_{[i_k]} f_k \Big) \theta_{i_{1}} \ldots \theta_{i_{p+q}} \\
= \, & \sum_{i_1<\ldots< i_{p+q}} \sum_{\sigma\in\operatorname{Sh}(p,q)} (-1)^{|\sigma|} \Big( \prod_{k=1}^{p+q} \partial_{[i_{\sigma(k)}]} f_k \Big) \theta_{i_{1}} \ldots \theta_{i_{p+q}} \\
= \, & \Psi \big((df_1\ldots df_p \otimes 1) \times( df_{p+1}\ldots df_{p+q} \otimes 1) \big)
\end{align*}
where in the third step the anti-commutativity of the~$\theta_i$ allowed us to sum over the longer sequences $i_1<\ldots< i_{p+q}$ by introducing an additional sum over shuffles. 
\end{proof}

Now we come back to consider any potential $W\in R$. The map~$\Psi$ continues to be a good map on the level of linear factorisations: 
\begin{lemma}\label{PsiHF}
$\Psi: (\Bar, d_\Bar) \lra (\Delta_W, d_{\Delta_W})$ is a morphism in $\HF(\Re,\widetilde W)$. 
\end{lemma}

\begin{proof}
We need to show $d_{\Delta_W} \Psi = \Psi d_\Bar$. But since $d_{\Delta_W} = \delta_+ + \delta_-$ and $d_\Bar = b' + d\widetilde W \times (-)$ by Lemma~\eqref{PhiPsiDG} what remains to be checked is $\delta_+ \Psi = \Psi (d\widetilde W\times (-))$. This can be done: 
$$
\delta_+ \Psi = \Big( \sum_{i=1}^n \partial_{[i]} W \cdot \theta_i^* \Big) \wedge \Psi(-) = \Psi(dW\otimes 1) \wedge \Psi(-) = \Psi (d\widetilde W\times (-)) \, . 
$$
\end{proof}


TODO: Say something about $\Phi$ here too


\begin{remark}
Instead of the bar complex $\Bar = \bigoplus_{n\geq 0} \Bar_n$ one can also consider its completed version
$$
\cBar = \prod_{n\geq 0} \Bar_n \, .
$$
It has differential graded structures $(\cBar,d,\cdot)$ and $(\cBar,b',\times)$ analogous to~$\Bar$, and the maps~$\Phi$ and~$\Psi$ lift to maps to and from the completed bar complex~$\cBar$ with the same properties as in Lemmas~\ref{PhiPsiDG} and~\ref{PsiHF}. 
\end{remark}

\section{Zorro moves}\label{sec:Zorro}

In this section we will show that the bicategory $\LG$ of Landau-Ginzburg models has duals for any noetherian $\mathbb{Q}$-algebra $k$. Let us fix two arbitrary potentials $W\in k[x] = k[x_1,\ldots,x_n]$ and $V\in k[z] = k[z_1,\ldots,z_m]$. Then we want to prove that for any matrix factorisation $X\in \hmf(k[z,x], V-W)$ and its dual $X^\dual = X^\vee[n]\in \hmf(k[z,x], W-V)$ the Zorro moves~\eqref{Zorros} and~\eqref{otherZorros} are satisfied. Let $\{ e_i \}_{i \in I}$ denote a homogeneous $k[z,x]$-basis of $X$ and $e_i^*$ the dual basis of $X^\vee$.

Let us consider the first identity of~\eqref{otherZorros} in more detail: 
\be\label{Zorro1detail}
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]

\fill (0.2,1.6) circle (0pt) node {{\small $\Delta$}};
\fill (-0.2,-1.6) circle (0pt) node {{\small $\Delta$}};

\fill (1,1.8) circle (2.5pt) node[right] {{\small $\lambda$}};
\fill (-1,-1.8) circle (2.5pt) node[left] {{\small $\rho^{-1}$}};

\fill (-1.25,-2.25) circle (0pt) node {{\footnotesize $z$}};
\fill (-0.75,-2.25) circle (0pt) node {{\footnotesize $x'$}};

\fill (-1.5,0) circle (0pt) node {{\footnotesize $z\vphantom{z'}$}};
\fill (-0.5,0) circle (0pt) node {{\footnotesize $x$}};
\fill (0.5,0) circle (0pt) node {{\footnotesize $z'$}};
\fill (1.5,0) circle (0pt) node {{\footnotesize $x'\vphantom{z'}$}};

\fill (1.25,2.25) circle (0pt) node {{\footnotesize $x'$}};
\fill (0.75,2.25) circle (0pt) node {{\footnotesize $z\vphantom{y}$}};

\draw[dashed] (-0.5,0.75) .. controls +(0,0.75) and +(-0.25,-0.75) .. (1,1.8);
\draw[dashed] (0.5,-0.75) .. controls +(0,-0.75) and +(0.25,0.75) .. (-1,-1.8);

\draw[line width=0] 
(1,2.7) node[line width=0pt] (A) {{\small $X$}}
(-1,-2.7) node[line width=0pt] (A2) {{\small $X$}}; 
\draw[redirected] (0,0) .. controls +(0,1) and +(0,1) .. (-1,0);
\draw[redirected] (1,0) .. controls +(0,-1) and +(0,-1) .. (0,0);
\draw (-1,0) -- (A2); 
\draw (1,0) -- (A); 
\end{tikzpicture}
=
\begin{tikzpicture}[very thick,scale=1.0,color=blue!50!black, baseline=0cm]
\draw[line width=0] 
(0,2.7) node[line width=0pt] (A) {{\small $X$}}
(0,-2.7) node[line width=0pt] (A2) {{\small $X$}}; 
\draw (A2) -- (A); 
\end{tikzpicture}
\ee
Here we have indicated the variable names in the various domains (\textbf{fix} we are still very messy with the variables). We call the left hand side of (\ref{Zorro1detail}) the \emph{Zorro map} and denote it $\mathcal Z$. It is the composite
\be\label{eq:zorro1a1}
\xymatrix@C+2pc{
X \ar[r]^-{\rho^{-1}} & X \otimes \Delta \ar[r]^-{1 \otimes \coev} & X \otimes X^{\dagger} \otimes X \ar[r]^-{\eval \otimes 1} & \Delta \otimes X \ar[r]^-{\lambda} & X\,,
}
\ee
which we prove is homotopic to the identity on $X$. Our strategy is to use the nondegenerate pairing on $\hmf(k[z,x], V-W)$. If $k$ is a field this is the Kapustin-Li pairing of \cite{??,??} but in general we use the contents of Section \ref{??} (\textbf{more}). The upshot is that there is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes over $k$
\be
\Hom_{k[z,x]}(X,X) \lto \Hom_k( \Hom_{k[z,x]}(X,X), k )[m+n]\,, \qquad \varphi \mapsto \langle \varphi, - \rangle_{\textup{KL}}\,.
\ee
To prove that $\mathcal{Z} \simeq 1_X$ it is therefore enough to prove that the functionals $\langle \mathcal{Z}, - \rangle_{\textup{KL}}$ and $\langle 1_X, - \rangle_{\textup{KL}}$ on $\Hom_{k[z,x]}(X,X)$ are \emph{homotopic}. When $k$ is a field this equivalent to showing that the two functionals take the same value on any closed endomorphism of $X$, and in general it amounts to showing that $\langle \mathcal{Z}, \varphi \rangle_{\textup{KL}}$ and $\langle 1_X, \varphi \rangle_{\textup{KL}}$ differ, as functionals of $\varphi$, by a functional of $D(\varphi)$. In light of the formula for $\langle -, - \rangle_{\textup{KL}}$ it is natural that our first step should therefore be to understand the map $\str( \mathcal{Z} \circ - )$.

Let us introduce the notation
$$
\langle\!\langle-\rangle\!\rangle = (-1)^{n+1\choose 2} \Res_{k[x,y,z]/k[y,z]} \left[ \frac{ \varepsilon\Psi(-) \underline{\operatorname{d}\!x}}{\partial_{x_1}W \ldots \partial_{x_n} W} \right]: \Bar \lto k[z,y]\,.
$$
where $\varepsilon\Psi: \Bar \lto k[z,y][n]$ is the chain map of Section \ref{??} and $\underline{\operatorname{d}\!x}=\operatorname{d}\!x_1\ldots \operatorname{d}\!x_n$. Let $\At$ denote the Atiyah class of $\End(X)$, which is an operator on $\End(X) \otimes_{k[x]} \Bar$. Let $\lambda_i$ be a null-homotopy on $X$ for the action of $\partial_{x_i} W$, for example $\lambda_i=\partial_{x_i}d_X(z,x)$, and set $\underline\lambda=\lambda_1\ldots \lambda_n$. Our first order of business is to establish the following expression for the Zorro map.

\begin{lemma}\label{lemma:Zorrointermediate}
\be\label{Zorrointermediate}
\mathcal Z(-) = \sum_j (-1)^{|e_j| + n} \big\langle\!\big\langle \str \big( \underline\lambda \circ \At^n (-\circ e_j^*) \big) \big\rangle\!\big\rangle \cdot e_j
\ee
\end{lemma}

%Given the explicit formula for the pairing in (\ref{??}) it is certainly enough to prove that the closed $k$-linear map
%\[
%\str(\mathcal{Z} \circ -): \Hom_{k[z,x]}(X,X) \lto k[z,x]/(\partial_{x_i} W, \partial_{z_i} V)
%\]
%is homotopic to $\str(-)$. That is, we prove that modulo the ideal generated by the partial derivatives $\partial_{y_i} W, \partial_{z_i} V$, the difference between $\str(\mathcal{Z} \circ -)$ and $\str(-)$ factors via a degree one $k$-linear operator on $\Hom_{k[z,x]}(X,X)$. The first step is to find an explicit formula for $\mathcal{Z}$.

%We will denote equality modulo the derivatives $f_i(y):= \partial_{y_i}W$ and $g_i(z):= \partial_{z_i}V$ by ``$\equiv$'',

 Before proceeding with the proof, let us recall the explicit formulas for the maps involved
\begin{align*}
\rho^{-1}: X \lto X \otimes \Delta, \qquad \rho^{-1}(a) &= \sum_{i \ge 0}(-1)^i \Psi\! \At^i_X(a)\,,\\
\coev: \Delta \lto X^{\dagger} \otimes X, \qquad \coev(\gamma) &= \varepsilon\Big( \gamma \wedge \sum_{i \ge 0}(-1)^i (\Psi\!\At^i_{X^{\dagger}} \otimes 1)(\iota_X) \Big)\,,\\
&= \sum_{i,j} (-1)^{i+|e_j|} \varepsilon \Big( \gamma \wedge \Psi\!\At^i_{X^{\dagger}}( e_j^* ) \otimes e_j \Big)\\
\eval: X \otimes X^{\dagger} \lto \Delta, \qquad \eval(\alpha) &= (-1)^{\binom{n+1}{2}}\Res_{k[x,y,z]/k[y,z]}\! \left[ \frac{\str ( \alpha|_{z=z'} \underline{\lambda}) \underline{\operatorname{d}\! x}}{\partial_{x_1}W \ldots \partial_{x_n} W} \right] + \mathcal{O}(\theta)\,.
\end{align*}
Note that tensoring with the diagonal defines a map $(-)|_{z=z'}: X \otimes X^{\dagger} \lto \Hom_{k[x,z]}(X,X)$ (\textbf{more}) and $\mathcal{O}(\theta)$ denotes higher order terms which do not survive $\lambda$ and therefore may be ignored for present purposes. Also define $\nabla$ and Atiyah classes (\textbf{todo}).

Let us consider the image of a basis element $e_q$ under the first two maps of (\ref{eq:zorro1a1})
\begin{align}
(1 \otimes \coev) \circ \rho^{-1}( e_q ) &= \sum_{i,k,j} (-1)^{i+k} \varepsilon\Big( \Psi\! \At^i_X( e_q ) \wedge \Psi \!\At^k_{X^{\dagger}}( e_j^* ) \otimes e_j \Big) \nonumber\\
&= \sum_{j} \sum_{i+k = n} (-1)^n \varepsilon\Psi\Big( \At^i_X( e_q ) \times \At^k_{X^{\dagger}}( e_j^* ) \otimes e_j \Big) \nonumber\\
&= \sum_{j} (-1)^n \varepsilon\Psi\Big( \At^n_{X \otimes X^{\dagger}}( e_q \otimes e_j^* ) \otimes e_j \Big)\,. \label{firstzorromaps}
\end{align} 
In the last step we use the following lemma about associative Atiyah classes.

\begin{lemma} $\At \times \At = \At$.
\end{lemma}

The proof is given at the end of this section. 

\begin{proof}[Proof of Lemma \ref{lemma:Zorrointermediate}]
Applying $\eval$ in the first two components of $X \otimes X^{\dagger} \otimes X$ to the expression in (\ref{firstzorromaps}) has the effect of identifying $z$ with $z'$. This changes the associative Atiyah class of $X \otimes X^{\dagger}$ to the associative Atiyah class of $\End(X)$ and so
\begin{align}
\mathcal{Z}(e_q) &= \lambda \circ (\eval \otimes 1) \circ (1 \otimes \coev) \circ \rho^{-1}( e_q )\\
&= \sum_j (-1)^{|e_j|+n+\binom{n+1}{2}}\Res_{k[x]/k}\! \left[ \frac{ \varepsilon\Psi \str\Big( \At^n( e_q \circ e_j^* ) \underline{\lambda} \Big) \underline{\operatorname{d}\! x} }{\partial_{x_1}W \ldots \partial_{x_n} W} \right] \cdot e_j
\end{align}
Since the Zorro map~$\mathcal Z$ is $k[z,x]$-linear it is fixed by its action on basis elements~$e_q$, which proves that $\mathcal{Z}$ is given by (\ref{Zorrointermediate}).
\end{proof}

Then we can compute for $\varphi \in \End(X)$ homogeneous
\begin{align}
\str(\mathcal Z\varphi) & = \sum_i (-1)^{|e_i|} e^*_i \big( \mathcal Z(\varphi(e_i)) \big) \nonumber \\
& = \sum_{i,j} (-1)^{|e_i| + |e_j| + n} e^*_i \Big( \big\langle\!\big\langle \str( \underline\lambda \At^n (\varphi(e_i)\otimes e^*_j \otimes e_j)) \big\rangle\!\big\rangle \Big) \nonumber \\
& = \sum_{i,j} (-1)^{|e_i| + |e_j| + n + n|e_j|} e^*_i \Big( \big\langle\!\big\langle \str( \underline\lambda \At^n (\varphi(e_i)\otimes e^*_j )) \big\rangle\!\big\rangle e_j \Big) \nonumber \\
& = \big\langle\!\big\langle \str \big( \underline\lambda \At^n \big(\sum_i \varphi(e_i)\otimes e^*_j \big)\big) \big\rangle\!\big\rangle \nonumber \\
& = \big\langle\!\big\langle \str \big( \underline\lambda \At^n (\varphi)\big) \big\rangle\!\big\rangle \label{strlambdaAtn} \, .
\end{align}
The next step of the proof that $\mathcal{Z} \simeq 1_X$ is to show that $\str(\mathcal{Z} \circ -)$ is homotopic to $\str(-)$. In outline, here is the argument: the Atiyah class is ``anti-self-adjoint'' with respect to $\langle\!\langle \str( - ) \rangle\!\rangle$, so
\begin{equation}\label{eq:trueproofeq}
\str(\mathcal{Z} \circ -) = \big\langle\!\big\langle \str \big( \underline\lambda \circ \At^n (-)\big) \big\rangle\!\big\rangle \simeq (-1)^n \big\langle\!\big\langle \str \big( \At^n( \underline\lambda ) \circ -\big) \big\rangle\!\big\rangle\,.
\end{equation}
We will see that $\At^n( \underline\lambda )$ is a transition determinant in the sense of the calculus of residues, so that the right hand side can be identified with $\str(-)$. Conceptually this parallels the proof of nondegeneracy of the Kapustin-Li formula given in Section \ref{??}. However we proceed a little differently here, since we are working with noncommutative differential forms and this introduces various subtleties.

The form of self-adjointness of the Atiyah class that we will use is contained in the next result. The $p = 0$ case is the statement that
\[
\big\langle\!\big\langle \str( \lambda_1 \cdots \lambda_n \circ \At(\varphi) ) \big\rangle\!\big\rangle = \sum_{i=1}^n (-1)^{i-1} \Big\langle\!\Big\langle \nabla \left\{ f_i \str( \lambda_1 \cdots \widehat{\lambda_i} \cdots \lambda_n \circ \varphi ) \right\} \Big\rangle\!\Big\rangle\,,
\]
where as usual $\widehat{\lambda_i}$ means that $\lambda_i$ is omitted. Applying the lemma inductively will interpolate between the left and right hand sides of (\ref{eq:trueproofeq}). For the general statement we will need some notation: given a sequence $\bs{i} = (i_1,\ldots,i_p)$ in $[1,n]$ (not necessarily in ascending order) we define
\[
\ell(\bs{i}) = p, \qquad w(\bs{i}) = i_1 + \cdots + i_p, \qquad |\bs{i}| = \sum_{1 \le a < b \le n} \delta_{i_a > i_b}\, \qquad \gamma(\bs{i}) = w(\bs{i}) + |\bs{i}| + \binom{p+1}{2}\,.
\]
We write $\underline{\lambda}_{i_1,\ldots,i_p}$ for the product $\underline{\lambda} = \lambda_1 \cdots \lambda_n$ with the $\lambda_{i_1},\ldots,\lambda_{i_p}$ omitted. We deliberately confuse an endomorphism of $X$ with the operator on $\End(X) \otimes_{k[x]} \Bar$ which acts by post-composition with the endomorphism. Let $D$ denote the differential on $\End(X)$.

\begin{lemma}\label{lemma:zorromain} For $\varphi \in \End(X) \otimes_{k[x]} \Bar$ and $0 \le p < n$ we have
\begin{align*}
\sum_{\ell(\bs{i}) = p} (-1)^{\gamma(\bs{i}) + p} & \Big\langle\!\Big\langle \nabla f_{i_1} \nabla f_{i_2} \cdots \nabla f_{i_p} \str\big( \underline{\lambda}_{i_1,\ldots,i_p} \circ \At(\varphi) \big) \Big\rangle\!\Big\rangle\\
&= \sum_{\ell(\bs{i}) = p+1} (-1)^{\gamma(\bs{i}) + p+1} \Big\langle\!\Big\langle \nabla f_{i_1} \nabla f_{i_2} \cdots \nabla f_{i_{p+1}} \str\big( \underline{\lambda}_{i_1,\ldots,i_p,i_{p+1}} \circ \varphi \big) \Big\rangle\!\Big\rangle + h_p( D( \varphi ) )
\end{align*}
where the sums are over all sequences of length $p, p+1$ respectively and
\[
h_p( \psi ) = \sum_{\ell(\bs{i}) = p} (-1)^{\gamma(\bs{i}) +p} \Big\langle\!\Big\langle \nabla f_{i_1} \cdots \nabla f_{i_p} \str\big( [ \underline{\lambda}_{i_1,\ldots,i_p}, \nabla](\psi) \big) \Big\rangle\!\Big\rangle\,.
\]
\end{lemma}
\begin{proof}
Fix a sequence $\bs{i}$ of length $p$. The super Jacobi identity for operators on $\End(X) \otimes \Bar$ gives
\be\label{superJacobi}
\big[ \underline{\lambda}_{i_1,\ldots,i_p}, \At \big] = (-1)^{n-p} \big[ D, \big[ \underline{\lambda}_{i_1,\ldots,i_p}, \nabla \big] \big] - \big[ \nabla, \big[ D, \underline{\lambda}_{i_1,\ldots,i_p} \big] \big]\,.
\ee
It is easy to see that $\str \circ \nabla = \nabla \circ \str$ and hence $\str \circ \At = 0$ so if we apply the previous identity to $\varphi$ and then apply $\dlangle \eta \str( - ) \drangle$, with $\eta = \nabla \circ f_{i_1} \circ \cdots \circ \nabla \circ f_{i_p}$, we have
\begin{align}
\dlangle \eta \str\big( \underline{\lambda}_{i_1,\ldots,i_p} \circ \At(\varphi) \big) \drangle &= (-1)^{n-p} \dlangle \eta \str\big( \big[ D, \big[ \underline{\lambda}_{i_1,\ldots,i_p}, \nabla \big] \big] \varphi \big) \drangle \nonumber\\
&\qquad - \dlangle \eta \str\big( \big[ \nabla, \big[ D, \underline{\lambda}_{i_1,\ldots,i_p} \big] \big] \varphi \big) \drangle \nonumber\\
&= \dlangle \eta \str\big( \big[ \underline{\lambda}_{i_1,\ldots,i_p}, \nabla \big] ( D\varphi ) \big) \drangle \label{eq:hutch1}\\
&\qquad- \dlangle \eta \nabla \str\big( \big[ D, \underline{\lambda}_{i_1,\ldots,i_p} \big] \varphi \big) \drangle \label{eq:hutch2}\\
&\qquad+ (-1)^{n-p+1} \bigdlangle \eta \str\big( \big[ D, \underline{\lambda}_{i_1,\ldots,i_p} \big]( \nabla \varphi ) \big) \drangle \label{eq:hutch3}
\end{align}
For compactness let us write $f_i = \partial_{x_i} W$. Since $[d_X, \lambda_i] = f_i$ we have
\[
\big[ D, \underline{\lambda}_{i_1,\ldots,i_p} \big] = \sum_{a \notin \{ i_1, \ldots, i_p \} } (-1)^{a-1 + \#\{ b \l i_b < a \}} f_{a} \cdot \underline{\lambda}_{i_1,\ldots,i_p,a}
\]
where the sign counts the number of $\lambda$'s to the left of $\lambda_a$ in $\underline{\lambda}_{i_1,\ldots,i_p}$. Subsituting, the last summand (\ref{eq:hutch3}) in the above is, up to a sign
\[
\sum_{a \notin \{ i_1,\ldots, i_p \}} (-1)^{a-1 + \#\{ b \l i_b < a \}} \bigdlangle \nabla f_{i_1} \cdots \nabla f_{i_p} f_a \str\big( \big[ D, \underline{\lambda}_{i_1,\ldots,i_p,a} \big]( \nabla \varphi ) \big) \bigdrangle
\]
If we sum over all sequences $\bs{i}$ with the signs given in the statement of the lemma it is straightforward to check that the above term vanishes, because $f_{i_p} f_a$ and $f_a f_{i_p}$ appear in the sum with opposite signs. This completes the proof, since the sum over $\bs{i}$ of (\ref{eq:hutch1}) and (\ref{eq:hutch2}) gives us the right hand side of the equation in the statement of the lemma.
\end{proof}

For the proof of the main theorem we will also need the following.

\begin{lemma}
Let $\omega\in\Omega(k[x_1,\ldots,x_n])$ be and $n$-form. Then $\Psi(\omega f)=\Psi(\omega) f(y)$ for any $f\in k[x]$. 
\end{lemma}

\begin{proof}
We may assume that $\omega$ is of the form $da_1\ldots da_n$ for some $a_i\in k[x]$. Then
\begin{align*}
\Psi(\omega f) & = \Psi \Big( \sum_{i=1}^n (-1)^{n-i} da_1\ldots da_{i-1} d(a_i a_{i+1}) da_{i+2}\ldots da_n df + (-1)^n a_1 da_2\ldots da_n df \Big) \\
& = \sum_{i=1}^n (-1)^{n-i} \partial_{[1]} a_1\ldots \partial_{[i-1]} a_{i-1} \partial_{[i]} (a_i a_{i+1}) \partial_{[i+1]} a_{i+2} \ldots \partial_{[n-1]} a_n \partial_{[n]} f \\
& \qquad + (-1)^n a_1 \partial_{[1]} a_2 \ldots \partial_{[n-1]} a_n \partial_{[n]} f \\
& = \sum_{i=1}^n (-1)^{n-i} \partial_{[1]} a_1\ldots \partial_{[i-1]} a_{i-1} \Big(\partial_{[i]} a_i {}	^{t_1\ldots t_i}a_{i+1} + {}^{t_1\ldots t_{i-1}} a_i \partial_{[i]} a_{i+1} \Big) \\
& \qquad \cdot  \partial_{[i+1]} a_{i+2} \ldots \partial_{[n-1]} a_n \partial_{[n]} f + (-1)^n a_1 \partial_{[1]} a_2 \ldots \partial_{[n-1]} a_n \partial_{[n]} f \\
& = \partial_{[1]} a_1 \ldots \partial_{[n]} a_n f(y) \\
& = \Psi(\omega) f(y) \, ,
\end{align*}
where we used Lemma~\ref{TODO} in the third step. 
\end{proof}

\begin{theorem}\label{theorem:mainzorro} The Zorro map $\mathcal{Z}$ is homotopic to $1_X$.
\end{theorem}
\begin{proof}
Applying Lemma \ref{lemma:zorromain} repeatedly and using (\ref{strlambdaAtn} we find that for $\varphi \in \End(X)$
\begin{align*}
\str( \mathcal{Z} \varphi ) &= \big\langle\!\big\langle \str \big( \underline\lambda \At^n (\varphi)\big) \big\rangle\!\big\rangle\\
&= (-1)^n \sum_{\sigma \in S_n} (-1)^{|\sigma|} \big\langle\!\big\langle \nabla f_{\sigma(1)} \cdots \nabla f_{\sigma(n)} \str(\varphi) \big\rangle\!\big\rangle + \sum_{p=0}^{n-1} h_i( D \At^{n-p-1}(\varphi) )\,.
\end{align*}
%where 
%$$
%\delta = 
%\det 
%\begin{pmatrix}
%df_1 & df_2 & \cdots & df_n \\
%\vdots & \vdots & & \vdots \\
%df_1 & df_2 & \cdots & df_n 
%\end{pmatrix} .
%$$
%This concludes the proof that the Zorro map~\eqref{Zorro1superdetail} is homotopic to the identity. 
But by a small argument involving transition determinants this shows that
\[
\str( \mathcal{Z} \varphi ) = \str( \varphi )|_{x \mapsto y} + \sum_{p=0}^{n-1} h_i( D \At^{n-p-1}(\varphi) ).
\]
This shows that $\str( \mathcal{Z} \circ - )$ is homotopic to $\str( - )$ but this is not quite what we need. After all
\begin{equation}\label{eq:bracketkl}
\langle -, - \rangle_{\textup{KL}} = \frac{1}{n!} \sum_{\sigma \in S_n} \textup{sgn}(\sigma) \Res_{k[y,z]/k} \left[ \frac{ \str( - \circ - \circ \underline{\lambda} \underline{\mu}) \underline{\operatorname{d}\!y} \underline{\operatorname{d}\!z}}{\partial_{x_1}W \ldots \partial_{x_n} W \partial_{z_1} V \ldots \partial_{z_n} V} \right]
\end{equation}
But given $\varphi' \in \End(X)$ if we set $\varphi = \varphi' \circ \underline{\lambda} \underline{\mu}$ and substitute in (\ref{??}) we find that the two functionals $\langle \mathcal{Z}, - \rangle_{\textup{KL}}$ and $\langle 1_X, - \rangle_{\textup{KL}}$ differ by a term which is an expression in residues of
\begin{equation}\label{eq:mainzorro1}
h_p( D \At^{n-p-1}(\varphi) ) = h_p( D \At^{n-p-1}(\varphi' \underline{\lambda} \underline{\mu}) )
\end{equation}
with a sum over all $p$. So to prove that these two functionals are homotopic, it is enough to prove that the residue of (\ref{eq:mainzorro1}) is a function of $D(\varphi')$. But $\At$ is closed, so
\begin{align}
h_p( D \At^{n-p-1}(\varphi' \underline{\lambda} \underline{\mu}) ) &= h_p \At^{n-p-1}D(\varphi' \underline{\lambda} \underline{\mu}) ) \nonumber\\
&= h_p \At^{n-p-1}\big( D(\varphi') \underline{\lambda} \underline{\mu} )\\
&\qquad + h_p \At^{n-p-1}\big( \varphi' D(\underline{\lambda}) \underline{\mu} ) \label{eq:mainzorro4}\\
&\qquad + h_p \At^{n-p-1}\big( \varphi' \underline{\lambda} D(\underline{\mu}) ) \label{eq:mainzorro5}
\end{align}
Now $D(\underline{\mu})$ is a linear combination of terms divisible by the $\partial_{z_j} V$, and since $h_p$ and $\At$ are $k[z]$-linear these coefficients pass through to annihilate with the denominator in the residue in  (\ref{eq:bracketkl}). 

Similarly $\varphi' D(\underline{\lambda}) \underline{\mu}$ is a sum of terms of the form $f_j \alpha$ for various $j$. But the Atiyah class and the commutator $[\underline{\lambda}_{i_1,\ldots,i_p}, \nabla]$ are right linear (explain right action on $\Bar$) so
\begin{align*}
h_p \At^{n-p-1}\big( \alpha f_j ) &= h_p\left( \At^{n-p-1}(\alpha) \cdot f_j \right)\\
&= \sum_{\ell(\bs{i}) = p} (-1)^{\gamma(\bs{i}) +p} \Big\langle\!\Big\langle \nabla \left\{ f_{i_1} \cdots \nabla f_{i_p} \str\big( [ \underline{\lambda}_{i_1,\ldots,i_p}, \nabla]\At^{n-p-1}(\alpha) \big) \cdot f_j \right\} \Big\rangle\!\Big\rangle\,.
\end{align*}
But $\nabla( f_{i_1} \beta f_j ) = f_{i_1} \nabla( \beta f_j ) + df_{i_1} \beta f_j$. The first summand vanishes in the residue for obvious reasons, and the second vanishes since by Lemma \ref{??}
\[
\dlangle - \cdot f_j \drangle = \dlangle - \drangle \cdot f_j(y)
\]
which vanishes in the residue.

The upshot is that (\ref{eq:mainzorro4}) and (\ref{eq:mainzorro5}) do not contribute under the residue, so that
\[
\langle \mathcal{Z}, - \rangle_{\textup{KL}} - \langle 1_X, - \rangle_{\textup{KL}} = 
\frac{1}{n!} \sum_{\sigma \in S_n}\sum_{p=0}^{n-1} \textup{sgn}(\sigma) \Res_{k[y,z]/k} \left[ \frac{ h_p \At^{n-p-1}( D(-) \underline{\lambda} \underline{\mu} ) \underline{\operatorname{d}\!y} \underline{\operatorname{d}\!z}}{\partial_{x_1}W \ldots \partial_{x_n} W \partial_{z_1} V \ldots \partial_{z_n} V} \right]\,.
\]
This proves that $\langle \mathcal{Z}, - \rangle_{\textup{KL}}$ and $\langle 1_X, - \rangle_{\textup{KL}}$ are homotopic functionals, and so by the nondegeneracy of Theorem \ref{??} we conclude that $\mathcal{Z}$ and $1_X$ are homotopic.
\end{proof}

The three other Zorro moves are proven analogously. What remains to be done is to show that the same is true if we replace the completed bar complex~$\cBar$ by the unit object~$\Delta_W$ of the monoidal category $\HMF(k[x,y], \widetilde W)$.

\newpage

, as well as the fact that we use the completed bar complex~$\cBar$ as a model for the unit endomorphism of the object~$W$. Writing out the coevaluation~\eqref{TODO} the left-hand side of~\eqref{Zorro1detail} becomes 
\be\label{Zorro1superdetail}
\mathcal Z := 
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline=1.7cm,line/.style={&gt;=latex}]

\draw (-1.3,0) -- (-1.3,4.8); 
\draw (-4.9,-3) -- (-4.9,4.8); 
\draw[redirected] (-1.3,4.8) .. controls +(0,1.75) and +(0,1.75) .. (-4.9,4.8);

\draw (0,0) -- (0,8.5); 

\draw[dashed] (1.3,0.4) -- (1.3,4.5);

\draw[dashed] (-2.6,0.4) -- (-2.6,1.1);
\draw[dashed] (-2.6,1.1) .. controls +(1,0.7) and +(-1,-0.7) .. (2.6,1.9);
\draw[dashed] (2.6,1.9) -- (2.6,3);

\draw[line width=0.75pt] 
(0,4.5) node[fill=white,draw,text width=5cm,align=center]{{\footnotesize$1_{X^\dual} \otimes 1_X \otimes (\varepsilon\circ\Psi)\vphantom{1_{\cBar} \otimes \sum_{b\geq 0} (-1)^b (\At_{X^\dual\otimes X})^b(\iota)}$}} 
(0,3) node[fill=white,draw,text width=5cm,align=center]{{\footnotesize$1_{X^\dual} \otimes 1_X \otimes \times\vphantom{1_{\cBar} \otimes \sum_{b\geq 0} (-1)^b (\At_{X^\dual\otimes X})^b(\iota)}$}}
(0,1.5) node[draw,text width=5cm,align=center]{{\footnotesize$\vphantom{1_{\cBar} \otimes \sum_{b\geq 0} (-1)^b \At(d_{X^\dual\otimes X})^b(\iota)}$}}
(0,0) node[fill=white,draw,text width=5cm,align=center]{{\footnotesize$1_{\cBar} \otimes \sum_{b\geq 0} (-1)^b (\At_{X^\dual\otimes X})^b(\iota)$}};

\fill (3.2,4.5) circle (0pt) node[right] {{\small $\gamma_4$}};
\fill (3.2,3) circle (0pt) node[right] {{\small $\gamma_3$}};
\fill (3.2,1.5) circle (0pt) node[right] {{\small $\gamma_2$}};
\fill (3.2,0) circle (0pt) node[right] {{\small $\gamma_1$}};

\fill (0,7.8) circle (2.5pt) node[right] {{\small $\lambda_X$}};
\fill (-4.9,-2.2) circle (2.5pt) node[left] {{\small $\rho_X^{-1}$}};

\draw[dashed] (-4.9,-2.2) .. controls +(0.25,1) and +(0,-1) .. (-2.6,-0.4);
\draw[dashed] (-3.1,6) .. controls +(0,1) and +(-0.25,-1) .. (0,7.8);

\end{tikzpicture}
\ee
where $\iota = \sum_j (-1)^{|e_j|} e_j^* \otimes e_j$, with $\{e_j\}$ a $k[z,x]$-basis of~$X$, corresponds to $1_E\in\End(X)$ in~$\gamma_1$, and the twist map~$\gamma_2$ produces Koszul signs coming from commuting non-commutative forms from the left to the very right. 

To prove that~\eqref{Zorro1superdetail} is indeed homotopic to the identity we first concentrate on the map 
$$
\Gamma := \gamma_3 \circ \gamma_2 \circ \gamma_1 \circ \rho_X^{-1}: X \longrightarrow X \otimes X^\dual \otimes X \otimes \cBar \, . 
$$
If we understand the bar complex as $\Omega_{k[x]}k[z,x]$ then as explained in Section~\ref{TODO} only $d_{X^\dual}$ contributes to the Atiyah class in~$\gamma_1$. As a result~$\Gamma$ is basically the shuffle product of two telescopic series of the Atiyah classes for~$X$ and $X^\dual$. This can be expressed in terms of the Atiyah class of the tensor product $X^\dual \otimes X$: 

\begin{lemma}
$\Gamma(e_q) = \sum_{n\geq 0} \sum_j (-1)^{|e_j| + n} (\At_{X\otimes X^\dual})^n(e_q \otimes e_j^* \otimes e_j)$. 
\end{lemma}

\begin{proof}
We compute $\Gamma(e_q)$, using $\At_X(e_q) = (-1)^{|e_q|+1} e_k \otimes d(d_X)_{kq}$ and paying attention to Koszul signs: 
\begin{align}
e_q & \stackrel{\rho_X^{-1}}{\longmapsto} \sum_{a\geq 0} (-1)^a \At_X^a(e_q) \nonumber \\
& \qquad\; = \sum_{a\geq 0} (-1)^{a + (|e_q|+1)+\ldots+(|e_q|+a)} e_{k_a} \otimes d(d_X)_{k_a k_{a-1}} \ldots d(d_X)_{k_1 q} \nonumber \\
& \stackrel{\gamma_1}{\longmapsto} \Big( \sum_{a\geq 0} (-1)^{a + a|e_q| + {a+1\choose 2}} e_{k_a} \otimes d(d_X)_{k_a k_{a-1}} \ldots d(d_X)_{k_1 q} \Big) \nonumber \\
& \qquad\; \otimes \Big( \sum_{b\geq 0} \sum_j (-1)^{|e_j|+b} (-1)^{(|e_j|+1)+\ldots+(|e_j|+b) + b|e_j|} e^*_{l_b} \otimes e_j \otimes d(d_{X^\dual})_{l_b l_{b-1}} \ldots d(d_{X^\dual})_{l_1 j} \Big) \nonumber \\
& \stackrel{\gamma_3 \circ \gamma_2}{\longmapsto} \sum_{n\geq 0} \sum_j (-1)^{|e_j|+n} \sum_{a=0}^n(-1)^{a|e_q| + {a+1\choose 2} + {n-a+1\choose 2}} \sum_{\sigma \in \Sh(n-a,a)} (-1)^{|\sigma|} e_{k_a} \otimes e^*_{l_{n-a}} \otimes e_j \nonumber \\
& \qquad\;   \otimes \sigma_\bullet \left( d(d_{X^\dual})_{l_{n-a} l_{n-a-1}} \ldots d(d_{X^\dual})_{l_1 j} d(d_X)_{k_a k_{a-1}} \ldots d(d_X)_{k_1 q} \right) \nonumber \\
& \qquad\; =  \sum_{n\geq 0} \sum_j (-1)^{|e_j|+n} \sum_{a=0}^n (-1)^{a|e_q| + {a+1\choose 2} + {n-a+1\choose 2} + a(n-a)} \sum_{\sigma \in \Sh(a,n-a)} (-1)^{|\sigma|}  \label{31} \\
& \qquad\qquad \cdot e_{k_a} \otimes e^*_{l_{n-a}} \otimes e_j \otimes \sigma_\bullet \left( d(d_X)_{k_a k_{a-1}} \ldots d(d_X)_{k_1 q} d(d_{X^\dual})_{l_{n-a} l_{n-a-1}} \ldots d(d_{X^\dual})_{l_1 j} \right) \nonumber \\
& \qquad\; =  \sum_{n\geq 0} \sum_j (-1)^{|e_j|+n} ( \At_X + \At_{X^\dual} )^n (e_q \otimes e^*_j \otimes e_j) \label{32} \\
& \qquad\; =  \sum_{n\geq 0} \sum_j (-1)^{|e_j|+n} (\At_{X\otimes X^\dual})^n (e_q \otimes e^*_j \otimes e_j) \, . \nonumber
\end{align}
To understand the penultimate step we note that the sign $(-1)^{a|e_q| + {a+1\choose 2} + {n-a+1\choose 2} + a(n-a)}$ with $\sigma=\operatorname{id}$ in~\eqref{31} is precisely that of the contribution to~\eqref{32} where $\At_{X^\dual}$ first acts $n-a$ times on $e_q\otimes e^*_j\otimes e_j$, followed by $\At_X^a$. The sign $(-1)^{|\sigma|}$ appears in~\eqref{32} if some $\At_X$ acts before some of the $\At_{X^\dual}$. 
\end{proof}







[TODO: better write this bit only once the section on $\cBar$ as a MF is in place] 

\begin{theorem}
TODO: $\LG$ has duals\ldots
\end{theorem}


\section{Defect action on bulk fields}\label{sec:defectaction}

In any bicategory with duals there are natural maps between the endomorphism spaces of unit 1-morphisms. Roughly, these maps are constructed by capturing a 2-morphism of a unit 1-morphism inside a loop labelled by an arbitrary 1-morphism (and its dual). Below we present the details for the case of the bicategory $\LG$. We will also give the interpretation in terms of defect actions on bulk fields in Landau-Ginzburg models. 

Let $X\in \hmf(k[z,x], V-W)$ as before. In this section when we write $\End$ we mean the spaces of 2-endomorphisms in $\LG$. We define maps 
$$
\mathcal D_l(X): \End(\Delta_V) \longrightarrow \End(\Delta_W) \, , \qquad
\mathcal D_r(X): \End(\Delta_W) \longrightarrow \End(\Delta_V)
$$
in terms of the morphisms encoding the monoidal and duality structures as follows. For $\phi\in \End(\Delta_V)$ and $\psi\in \End(\Delta_W)$ we set
\begin{align*}
\mathcal D_l(X)(\phi) & = \eval_X \circ (1_{X^\dual}\otimes (\lambda_X \circ (\phi\otimes 1_X)\circ \lambda_X^{-1})) \circ \widetilde\coev_X \, , \\ 
\mathcal D_r(X)(\phi) & = \widetilde\eval_X \circ (1_{X}\otimes (\lambda_{X^\dual} \circ (\phi\otimes 1_{X^\dual})\circ \lambda_{X^\dual}^{-1})) \circ \coev_X \, .
\end{align*}
Diagrammatically these definitions read 
\be\label{defectaction}
\mathcal D_l(X)(\phi) = 
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]

\fill (1.5,1.3) circle (2.5pt) node[right] {{\small $\lambda_X$}};
\fill (1.5,-1.3) circle (2.5pt) node[right] {{\small $\lambda^{-1}_X$}};
\fill (0,0) circle (2.5pt) node[left] {{\small $\phi$}};

\fill (0.6,1) circle (0pt) node {{\small $\Delta_V$}};
\fill (0.6,-0.95) circle (0pt) node {{\small $\Delta_V$}};

\draw[directed] (1.5,1.3) .. controls +(0,1.5) and +(0,1.5) .. (-1.5,1.3);
\draw[directed] (-1.5,-1.3) .. controls +(0,-1.5) and +(0,-1.5) .. (1.5,-1.3);
\draw (1.5,-1.3) -- (1.5,1.3)
node[midway,left] {{{\footnotesize$z'\vphantom{y}$}}}
node[midway,right] {{{\footnotesize$y\vphantom{yz'}$}}};
\draw (-1.5,-1.3) -- (-1.5,1.3)
node[midway,left] {{{\footnotesize$x\vphantom{yz'}$}}}
node[midway,right] {{{\footnotesize$z\vphantom{yz'}$}}};
\draw[dashed] (0,0) .. controls +(0,1) and +(-0.5,-1) .. (1.5,1.3);
\draw[dashed] (0,0) .. controls +(0,-1) and +(-0.5,1) .. (1.5,-1.3);
\draw[dashed] (0,-2.5) -- (0,-3.5)
node[near end,right] {{{\small$\Delta_W$}}};
\draw[dashed] (0,2.47) -- (0,3.5)
node[near end,right] {{{\small$\Delta_W$}}};
\end{tikzpicture}
\, , \qquad 
\mathcal D_r(X)(\psi) = 
\begin{tikzpicture}[very thick,scale=0.8,color=blue!50!black, baseline]

\fill (1.5,1.3) circle (2.5pt) node[right] {{\small $\lambda_{X^\dual}$}};
\fill (1.5,-1.3) circle (2.5pt) node[right] {{\small $\lambda^{-1}_{X^\dual}$}};
\fill (0,0) circle (2.5pt) node[left] {{\small $\psi$}};

\fill (0.6,1) circle (0pt) node {{\small $\Delta_W$}};
\fill (0.6,-0.95) circle (0pt) node {{\small $\Delta_W$}};

\draw[redirected] (1.5,1.3) .. controls +(0,1.5) and +(0,1.5) .. (-1.5,1.3);
\draw[redirected] (-1.5,-1.3) .. controls +(0,-1.5) and +(0,-1.5) .. (1.5,-1.3);
\draw (1.5,-1.3) -- (1.5,1.3)
node[midway,left] {{{\footnotesize$y\vphantom{yz'}$}}}
node[midway,right] {{{\footnotesize$z'\vphantom{yz'}$}}};
\draw (-1.5,-1.3) -- (-1.5,1.3)
node[midway,left] {{{\footnotesize$z\vphantom{yz'}$}}}
node[midway,right] {{{\footnotesize$x\vphantom{yz'}$}}};
\draw[dashed] (0,0) .. controls +(0,1) and +(-0.5,-1) .. (1.5,1.3);
\draw[dashed] (0,0) .. controls +(0,-1) and +(-0.5,1) .. (1.5,-1.3);
\draw[dashed] (0,-2.5) -- (0,-3.5)
node[near end,right] {{{\small$\Delta_V$}}};
\draw[dashed] (0,2.47) -- (0,3.5)
node[near end,right] {{{\small$\Delta_V$}}};
\end{tikzpicture}
\ee
where again we indicated our choice of variable names in the four domains. 

\begin{remark}
$\End(\Delta_W) = k[x]/(\partial_{x_i}W)$ is the Hochschild cohomology of $\hmf(k[x], W)$~\cite{d0904.4713}. This space also precisely describes bulk fields of Landau-Ginzburg models with potential~$W$, it is a commutative Frobenius algebra whose non-degenerate pairing
\be\label{bulktopmet}
\langle \phi, \psi \rangle_W = (-1)^n \Res_{k[x]/k} \left[ \frac{\phi \psi \, \underline{\operatorname{d}\!x}}{\partial_{x_1}W\ldots\partial_{x_n} W}\right]
\ee
describes two-point correlators. Furthermore, matrix factorisations of $V-W$ describe defect conditions between different Landau-Ginzburg models. Hence the maps~\eqref{defectaction} have the natural interpretations in terms of defect operators on bulk fields: for example, a bulk field~$\phi$ in the theory with potential~$V$ is mapped to the bulk field $\mathcal D_l(X)(\phi)$ in the theory with potential~$W$ by wrapping around its insertion on the worldsheet a defect line labelled by~$X$, and then collapsing this loop onto the insertion point. This limiting process is non-singular as the bicategory $\LG$ describes the purely topological sector of Landau-Ginzburg models. 
\end{remark}

Using the ``folding trick'' (which relates defects to boundary conditions in a product theory) one can argue for explicit expressions for $\mathcal D_l(X)$ and $\mathcal D_r(X)$. This was done in~\cite{cr1006.5609} for the case $V=W$. Here we use the duality structure to directly prove it for the general case: 

\begin{proposition}
For any $X\in \hmf(k[z_1,\ldots,z_m,x_1,\ldots,x_n], V-W)$, $\phi\in \End(\Delta_V)$ and $\psi\in \End(\Delta_W)$ we have
\begin{align*}
\mathcal D_l(X)(\phi) & = (-1)^{{m+1\choose 2} + {n\choose 2}} \Res_{k[z,x]/k[x]} \left[ \frac{\phi(z) \str\big( \partial_{z_1} d_{X}\ldots \partial_{z_m} d_{X} \partial_{x_1} d_{X}\ldots \partial_{x_n} d_{X} \big) \underline{\operatorname{d}\! z}}{\partial_{z_1} V \ldots \partial_{z_m} V} \right] \, , \\
\mathcal D_r(X)(\psi) & = (-1)^{{m\choose 2} + {n+1\choose 2}} \Res_{k[z,x]/k[z]} \left[ \frac{\psi(x) \str\big( \partial_{z_1} d_{X}\ldots \partial_{z_m} d_{X} \partial_{x_1} d_{X}\ldots \partial_{x_n} d_{X} \big) \underline{\operatorname{d}\! x}}{\partial_{x_1} W \ldots \partial_{x_n} W} \right] \, . 
\end{align*}
\end{proposition}

\begin{proof}
We treat the case of $\mathcal D_l(X)$ in detail, the argument for $\mathcal D_r(X)$ works analogously. Since $\End(\Delta_W) = k[x]/(\partial_{x_i}W)$ and $\End(\Delta_V) = k[z]/(\partial_{z_i}V)$ we are free to set $x=y$ and $z=z'$ at appropriate places, cf.~\eqref{defectaction}. Furthermore, $\lambda_X$ will project out all non-zero degree contributions coming from the action of $\lambda_X^{-1}$, so $\lambda_X\circ (\phi \otimes 1_X)\circ \lambda_X^{-1}$ is simply multiplication by the polynomial $\phi(z)$. 

In the lower part of the expression for $\mathcal D_l(X)(\phi)$ in~\eqref{defectaction} we have 
\begin{align}
\widetilde\coev (1) & = \sum_j (-1)^{|e_j|} (\varepsilon\Psi) \left( (-\At_{X})^n (e_j^*\otimes e_j) \right) \nonumber \\
& = \sum_j (-1)^{|e_j| + n} (-1)^{(|e_j| + 1)+\ldots +(|e_j| + n) + n|e_j|} e^*_{j} \otimes e_{k_n} \otimes (\varepsilon\Psi) \left( d(d_{X})_{k_n k_{n-1}} \ldots d(d_{X})_{k_1 j} \right) \nonumber \\
& = \sum_j (-1)^{|e_j|(|e_j| + n) + {n+1\choose 2} + n} e_j^* \otimes e_{k_n}\big( \partial_{[1]} d_{X} \ldots \partial_{[n]} d_{X} \big)_{k_n j} \nonumber \\
& = \sum_j (-1)^{|e_j|(|e_j| + n) + {n\choose 2}} e_j^* \otimes \big( \partial_{x_1} d_{X} \ldots \partial_{x_n} d_{X} \big) (e_{j}) \label{coevtilde1}
\end{align}
which we identify with $(-1)^{{n\choose 2}} \partial_{x_1} d_{X} \ldots \partial_{x_n} d_{X}$ in $\End(X)$. Note that in the last step leading to~\eqref{coevtilde1} we set $\partial_{[i]} d_{X}(x,z) = \partial_{x_i} d_{X}(x,z)$ since $x=y$ in $\End(\Delta_W)$. 

Next we apply the upper part of $\mathcal D_l(X)(\phi)$ in~\eqref{defectaction} to~\eqref{coevtilde1} to get
$$
\mathcal D_l(X)(\phi) = (-1)^{{m+1\choose 2} + {n\choose 2}} \Res_{k[z,x]/k[x]} \left[ \frac{\phi(z) \str\big( \partial_{z_1} d_{X}\ldots \partial_{z_m} d_{X} \partial_{x_1} d_{X}\ldots \partial_{x_n} d_{X} \big) \underline{\operatorname{d}\! z}}{\partial_{z_1} V \ldots \partial_{z_m} V} \right] + \mathcal O(\theta) \, . 
$$
Here we collectively denote the contributions from $\eval_X$ of non-zero degree in the Koszul complex $\Delta_W$ by $\mathcal O(\theta)$. Since we know that $\mathcal D_l(X)(\phi)$ is a morphism in $\End(\Delta_W) = k[x]/(\partial_{x_i}W)$ it follows that $\mathcal O(\theta)$ must be null-homotopic, thus concluding the proof. 
\end{proof}

\begin{corollary}
For any $X\in \hmf(k[z,x], V-W)$ the operators $\mathcal D_l(X)$ and $\mathcal D_r(X)$ are adjoint with respect to the pairings~\eqref{bulktopmet}, i.\,e.~we have
\be\label{Dadjoint}
\big\langle \mathcal D_l(X)(\phi), \psi \big\rangle_W = \big\langle \phi , \mathcal D_r(X)(\psi) \big\rangle_V
\ee
for all $\phi\in \End(\Delta_V)$ and $\psi\in \End(\Delta_W)$. 
\end{corollary}

\begin{remark}
We recall the physical interpretation of the relation~\eqref{Dadjoint}. Both sides of this equation are two-point correlators on the Riemann sphere, with a defect line labelled by~$X$ wrapped around counterclockwise the bulk field~$\phi$, or wrapped around~$\psi$ in clockwise fashion. That both correlators should be equal follows from the fact that the topological defect can be moved around the sphere at no cost: 
$$
\left\langle
\begin{tikzpicture}[baseline=-0.1cm]
\def\R{1.85}
\def\angEl{45}
\filldraw[ball color= white!77!blue,draw=white] (0,0) circle (\R);
\DrawLatitudeCircleU[\R,rotate=130,very thick, blue]{65}
\fill (-0.95,-0.83) circle (1pt) node[above] {{\small$\phi$}}; 
\fill (0.95,-0.83) circle (1pt) node[above] {{\small$\psi$}}; 
\end{tikzpicture}
\right\rangle
=
\left\langle
\begin{tikzpicture}[baseline=-0.1cm]
\def\R{1.85}
\def\angEl{45}
\filldraw[ball color= white!77!blue,draw=white] (0,0) circle (\R);
\DrawLongitudeCircle[\R]{80}
\fill (-0.95,-0.83) circle (1pt) node[above] {{\small$\phi$}}; 
\fill (0.95,-0.83) circle (1pt) node[above] {{\small$\psi$}}; 
\end{tikzpicture}
\right\rangle
=
\left\langle
\begin{tikzpicture}[baseline=-0.1cm]
\def\R{1.85}
\def\angEl{45}
\filldraw[ball color= white!77!blue,draw=white] (0,0) circle (\R);
\DrawLatitudeCircle[\R,rotate=-130, very thick, blue]{65}
\fill (-0.95,-0.83) circle (1pt) node[above] {{\small$\phi$}}; 
\fill (0.95,-0.83) circle (1pt) node[above] {{\small$\psi$}}; 
\end{tikzpicture}\right\rangle .
$$
\end{remark}


\section{Shadows}

The duality structure of $\LG$ affords us the construction of the bicategorical trace in terms of shadow functors~\cite{p0807.1471}. We will also see that shadows allow to recover and generalise the boundary-bulk and bulk-boundary maps of the two-dimensional topological field theories based on Landau-Ginzburg models. 

\begin{definition}
A bicategory~$\mathcal B$ \textsl{has shadows} if there is a category~$\mathcal C$ together with functors
$$
\langle\!\langle - \rangle\!\rangle : \mathcal B(A,A) \lra \mathcal C 
$$
for every object $A\in \mathcal B$ such that there are natural isomorphisms $\theta : \langle\!\langle X \otimes Y \rangle\!\rangle \lra \langle\!\langle Y \otimes X \rangle\!\rangle$ for every pair of composable 1-morphisms $X,Y$, and the diagrams
$$
\xymatrix{%
\langle\!\langle (X \otimes Y) \otimes Z \rangle\!\rangle \ar[r]^-{\theta} \ar[d]_-{\langle\!\langle \alpha \rangle\!\rangle} & 
\langle\!\langle Z \otimes (X \otimes Y) \rangle\!\rangle \ar[r]^-{\langle\!\langle \alpha^{-1} \rangle\!\rangle} & 
\langle\!\langle (Z \otimes X) \otimes Y \rangle\!\rangle \\
\langle\!\langle X \otimes (Y \otimes Z) \rangle\!\rangle \ar[r]^-{\theta} & 
\langle\!\langle (Y \otimes Z) \otimes X \rangle\!\rangle \ar[r]^-{\langle\!\langle \alpha \rangle\!\rangle} & 
\langle\!\langle Y \otimes (Z \otimes X) \rangle\!\rangle \ar[u]_-{\theta}
}%
$$
and
$$
\xymatrix{%
\langle\!\langle X \otimes 1_A \rangle\!\rangle \ar[r]^-{\theta} \ar[dr]_-{\langle\!\langle \rho \rangle\!\rangle} & 
\langle\!\langle 1_A \otimes X \rangle\!\rangle \ar[r]^-{\theta} \ar[d]^-{\langle\!\langle \lambda \rangle\!\rangle} & 
\langle\!\langle X \otimes 1_A \rangle\!\rangle \ar[dl]^-{\langle\!\langle \rho \rangle\!\rangle}  \\
 & 
\langle\!\langle X \rangle\!\rangle & 
}%
$$
commute whenever they make sense. 
\end{definition}

\begin{proposition}
The bicategory $\LG$ has shadows given by 
\begin{align*}
\langle\!\langle - \rangle\!\rangle : \LG \big( (R,W), (R,W) \big) & \lra \hmf(k,0) \, , \\
Z & \lmt Z\otimes_{\Re} R
\end{align*}
with the isomorphism $\theta: \langle\!\langle X \otimes Y \rangle\!\rangle \lra \langle\!\langle Y\otimes X  \rangle\!\rangle$ induced by the graded twist map $X \otimes Y \lra Y \otimes X$. 
\end{proposition}

The proof is a straightforward check of the axioms, made especially easy by the fact that $\langle\!\langle - \rangle\!\rangle$ is simply defined as tensoring with the actual diagonal~$R$. Note however that this is homotopy equivalent to tensoring with the unit matrix factorisation $\Delta_W$. 

Since $\LG$ is a bicategory with  duals and shadows it is automatically equipped with a 2-categorical trace operation as introduced and discussed at length in~\cite{p0807.1471, ps0910.1306}. We only quote the definition: 

\begin{definition}
Let~$\mathcal B$ be a bicategory with shadows and a dualisable 1-morphism~$Y$. Then the \textsl{trace} of a 2-morphism $\psi: X\otimes Y \lra Y \otimes Z$ is the map 
$$
\xymatrix{%
\langle\!\langle X \rangle\!\rangle \ar[rr]^-{\langle\!\langle1\otimes \coev_Y\rangle\!\rangle} && 
\langle\!\langle X \otimes Y \otimes Y^\dual \rangle\!\rangle \ar[r]^-{\langle\!\langle\psi \otimes 1\rangle\!\rangle} & 
\langle\!\langle Y \otimes Z \otimes Y^\dual \rangle\!\rangle \ar[r]^-{\theta} &
\langle\!\langle Y^\dual \otimes Y \otimes Z \rangle\!\rangle \ar[rr]^-{\langle\!\langle\eval_Y \otimes 1\rangle\!\rangle} && 
\langle\!\langle Z \rangle\!\rangle 
}%
\, . 
$$
\end{definition}

Next we wish to point out a connection between shadows and the structure of two-dimensional open/closed topological field theory (TFT) for Landau-Ginzburg models. Recall that a TFT is the data of a commutative Frobenius algebra~$C$, a Calabi-Yau category~$\mathcal O$, bulk-boundary maps $\beta_A: C \lra \End_{\mathcal O}(A)$, and boundary-bulk maps $\beta^A: \End_{\mathcal O}(A) \lra C$ for all $A\in\mathcal O$. These data are subject to several consistency conditions, see e.\,g.~\cite{Kock}. 

Every Landau-Ginzburg model with potential $W\in R = k[x_1,\ldots,x_n]$ gives rise to a TFT with $C=R/(\partial W)$, $\mathcal O = \hmf(R,W)$ and
\be\label{betaQ}
\beta_Q : \phi \lmt \phi \cdot 1_Q \, , \qquad 
\beta^Q : \psi \lmt (-1)^{n\choose 2} \str(\psi \, \partial_{x_1} d_Q \ldots \partial_{x_n} d_Q) \, . 
\ee
The hardest part in establishing this result is to prove the non-degeneracy of the Kapustin-Li pairing and that the Cardy condition holds; this was first done in~\cite{m0912.1629} and~\cite{pv1002.2116}, respectively. We note that the maps~\eqref{betaQ} can be recovered from the duality and shadow structure of $\LG$ as follows. On the one hand we have 
$$
\langle\!\langle \Delta_W \rangle\!\rangle = R/(\partial W)[n]
$$
since $\langle\!\langle \Delta_W \rangle\!\rangle = \Delta_W \otimes_{\Re} R = (\bigwedge (\bigoplus_{i=1}^n R \theta_i), \sum_{i=1}^n \partial_{x_i}W \theta_i)$ which is homotopy equivalent (and therefore equal in $\hmf(k,0)$) to $R/(\partial W)[n]$. On the other hand $\langle\!\langle Q^\dual \otimes Q \rangle\!\rangle = Q^\vee \otimes_k Q \otimes_{\Re} R = \End_R(Q)$. Thus from the explicit expressions~\eqref{TODO} and~\eqref{TODO} we find that $\beta_Q = \langle\!\langle \widetilde\coev_Q \rangle\!\rangle$ and $\beta^Q = \langle\!\langle \eval_Q \rangle\!\rangle$ (up to a sign, TODO?). 

Motivated by the above this construction can be extended to any 1-morphism in $\LG$: for $X \in \hmf(k[x_1,\ldots,x_n,z_1,\ldots,z_m], W_1 - W_2)$ we define the \textsl{generalised bulk-boundary} and \textsl{boundary-bulk maps} to be
$$
\beta_X= \langle\!\langle \widetilde\coev_X \rangle\!\rangle : \langle\!\langle \Delta_{W_2} \rangle\!\rangle \lra \langle\!\langle X^\dual \otimes X \rangle\!\rangle
\, , \qquad 
\beta^X= \langle\!\langle \eval_X \rangle\!\rangle : \langle\!\langle X^\dual \otimes X \rangle\!\rangle \lra \langle\!\langle \Delta_{W_2} \rangle\!\rangle \, , 
$$
respectively. Substituting the expressions~\eqref{TODO} and~\eqref{TODO} we find that the form of $\beta_X$ stays the same while for $m\neq 0$ the generalised boundary-bulk map $\beta^X$  involves a residue and additional derivatives $\partial_{z_i} d_X$: 
\begin{align*}
\beta_X : k[x]/(\partial W_1)[n] & \lra \End_{k[x,z]}(X)[m] \, , \\
\phi & \lmt \phi \cdot 1_{X}[m] \, , \\
\beta^X : \End_{k[x,z]}(X)[m] & \lra k[x]/(\partial W_1)[n] \, , \\
\psi & \lmt (-1)^{m+1\choose 2} \Res_{k[x,z]/k[x]} \left[ \frac{\str\left( \psi\, \partial_{z_1} d_X \ldots \partial_{z_m} d_X \partial_{x_1} d_X \ldots \partial_{x_n} d_X \right) \underline{\operatorname{d}\!z}}{\partial_{z_1} W_2 \ldots \partial_{z_m} W_2} \right] \, . 
\end{align*}

[TODO: comment on relation to defect action??]

\section{Duality via adjoint operators}\label{section:dualityadjointop}
% All rings are commutative by default unless they are called "associative"
% TODO match generality to dviat5

Let $k$ be a noetherian $\mathbb{Q}$-algebra and $R = k[x_1,\ldots,x_n]$. If $k$ is a field then we know from \cite{??,??} that for any polynomial $W$ with an isolated singularity, the Kapustin-Li formula gives a nondegenerate pairing on the mapping spaces of the triangulated category of matrix factorisations of $W$ over $R$. In this section we prove the analogue of this result for an arbitrary base $k$. In particular, the mapping spaces of the triangulated category will not be flat over $k$, so we work instead with dg-categories.

Given $W \in R$ and two finite rank matrix factorisations $X,Y$ of $W$ let $\Hom(X,Y) = \Hom_R(X,Y)$ denote the $\mathbb{Z}_2$-graded Hom-complex. We define a natural $k$-bilinear pairing
\[
\langle -, - \rangle_{\textup{KL}}: \Hom(X,Y) \otimes_k \Hom(Y,X) \lto k[n]
\]
by the following formula, where $\lambda_i = \partial_{x_i}(D_Y), \omega = \ud x_1 \cdots \ud x_n$ and $f_i = \partial_{x_i} W$
\begin{equation}\label{eq:generalklpairing}
\langle \varphi, \psi \rangle_{\textup{KL}} = \frac{1}{n!} \sum_{\sigma \in S_n} (-1)^{|\sigma|} \Ress{R/k}\Bigg[ \frac{ \str( \varphi \circ \psi \circ \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} )\, \omega }{ f_1,\ldots,f_n } \Bigg]\,.
\end{equation}
Such a pairing is \emph{homotopically nondegenerate} if the adjoint morphism of $\mathbb{Z}_2$-graded complexes
\begin{gather*}
\Hom(X,Y) \lto \Hom_k( \Hom(Y,X), k )[n]\,,\\
\varphi \mapsto \langle \varphi, - \rangle_{\textup{KL}}
\end{gather*}
is a homotopy equivalence over $k$. The main theorem here is that under some reasonable hypotheses the pairing $\langle -, - \rangle_{\textup{KL}}$ is homotopically nondegenerate. This nondegeneracy is used in Section \ref{??} to prove that specified evaluation and coevaluation morphisms give rise to adjoint $1$-morphisms in the bicategory of Landau-Ginzburg models over $k$.

\begin{theorem}\label{theorem:generalkl} Suppose that the following conditions are satisfied
\begin{itemize}
\item[(H1)] The partial derivatives $f_i = \partial_{x_i} W$ form a regular sequence $f = \{f_1,\ldots,f_n\}$ in $R$.
\item[(H2)] $\bar{R} = R/(f_1,\ldots,f_n)R$ is a finitely generated projective $k$-module.
\item[(H3)] The $R$-linear map
\begin{gather*}
\bar{R} \lto \Hom_k( \bar{R}, k)\,\\
r \mapsto \Ress{R/k}\Bigg[ \frac{r \cdot (-) \, \ud \underline{x}}{ f_1, \ldots, f_n} \Bigg]
\end{gather*}
is an isomorphism.
\end{itemize}
Then the pairing $\langle -, - \rangle_{\textup{KL}}$ is homotopically nondegenerate.
\end{theorem}

There is also version when $X,Y$ are graded matrix factorisations; see Section \ref{section:gradedduality}. The proof of the theorem takes up the rest of this section. We argue that $\Hom(X,Y)[n]$ and $\Hom_k(\Hom(Y,X),k)$ are homotopy equivalent by showing that they split idempotents on
\[
\Hom(\bar{X},\bar{Y}) = \Hom(X,Y) \otimes_R \bar{R}
\]
and
\[
\Hom_k( \Hom(\bar{Y}, \bar{X}), k) = \Hom_k( \Hom(Y,X) \otimes_R \bar{R}, k )
\]
respectively, in the homotopy category of $\mathbb{Z}_2$-graded $k$-complexes. There is an isomorphism
\begin{equation}\label{eq:frobnondeg}
\Hom(\bar{X}, \bar{Y}) \cong \Hom_k( \Hom(\bar{Y}, \bar{X}), k)
\end{equation}
of complexes which identify these idempotents, and from this the theorem follows. The existence of the isomorphism (\ref{eq:frobnondeg}) is an easy consequence of the fact that $\bar{R}$ is Frobenius over $k$. The hard work lies in showing that this isomorphism identifies the two idempotents, and for this we need to carefully study adjointness between operators on dg-categories. Thus the first part of the proof, in Section \ref{section:adjointopdg}, consists in formalising this kind of adjointness.

In fact it will be convenient to prove the theorem slightly more generally, since in order to equip $R$ with a connection we may need to pass to the $fR$-adic completion. Consequently, for the rest of this section $R$ is an arbitrary noetherian $k$-algebra, $W \in R$, and our actual hypotheses are:
\begin{itemize}
\item[(H1')] $f = \{ f_1,\ldots,f_n \}$ is any regular sequence in $R$ with the property that multiplication by $f_i$ is a null-homotopic endomorphism of $X,Y \in \hmf(R,W)$ for $1 \le i \le n$.
\item[(H2')] $\bar{R} = R/(f_1,\ldots,f_n)R$ is a finitely generated projective $k$-module.
\item[(H3')] $R$ admits a flat $k$-linear connection
\[
\nabla: R \lto R \otimes_{k[f]} \Omega^1_{k[f]/k}
\]
as a $k[f]$-module, which is standard in the sense of \cite{??}.
\item[(H4')] There is an $n$-form $\omega \in \Omega^n_{R/k}$ such that the $R$-linear map
\begin{gather*}
\bar{R} \lto \Hom_k( \bar{R}, k)\,\\
r \mapsto \Ress{R/k}\Bigg[ \frac{r \cdot (-) \cdot \omega}{ f_1, \ldots, f_n} \Bigg]
\end{gather*}
is an isomorphism.
\end{itemize}
In this situation one can still write down the pairing (\ref{eq:generalklpairing}) and we prove that this is homotopically nondegenerate (Proposition \ref{prop:almostkltheorem}). The theorem follows by passing from $k[x_1,\ldots,x_n]$ to a completion, which satisfies (H3') above even if the polynomial ring does not.

\subsection{Adjoint operators on dg-categories}\label{section:adjointopdg}
% TODO: Point out that these Atiyah classes are from connections over k[f], not k like in the associative case.

In this section $\otimes$ denotes $\otimes_k$. Let $\cat{C}$ be a $\mathbb{Z}_2$-graded dg-category over $k$ equipped with the data of a $k$-linear morphism of complexes for each pair of objects $X,Y$ in $\cat{C}$
\[
c_{XY}: \cat{C}(X,Y) \otimes \cat{C}(Y,X) \lto k\,.
\]
When it is convenient we write $\langle \alpha, \beta \rangle$ for $c_{XY}(\alpha \otimes \beta)$. Throughout the differentials on the $\cat{C}(X,Y)$ and their tensor products are denoted $D$, with additional subscripts if necessary.

\begin{definition}\label{defn:nondegpair} We say that the pairing $\{ c_{XY} \}_{X,Y \in \cat{C}}$ is
\begin{itemize}
\item[(i)] \emph{Cyclic} if for all $X,Y$ the diagram
\[
\xymatrix{
\cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[dr]_{c_{XY}}\ar[rr]^\tau & & \cat{C}(Y,X) \otimes \cat{C}(X,Y) \ar[dl]^{c_{YX}}\\
& k
}
\]
commutes, where $\tau$ is the graded twist $\tau( \varphi \otimes \psi) = (-1)^{|\varphi||\psi|} \psi \circ \varphi$. 
\item[(ii)] \emph{Nondegenerate} if for all $X,Y$ the morphism
\begin{gather*}
\zeta_{XY}: \cat{C}(X,Y) \lto \Hom_k( \cat{C}(Y,X), k)\,,\\
\varphi \mapsto c_{XY}( \varphi \otimes - )
\end{gather*}
is an isomorphism of complexes.
\end{itemize}
\end{definition}

%\begin{remark} \textbf{todo}. Probably this all works for a weaker form of nondegeneracy, where $\zeta$ is just a homotopy equivalence, but we don't need this. In what generality should we state things, then? Maybe we also only need cyclicity up to homotopy.
%\end{remark}

From now on we assume $\cat{C}$ is equipped with a cyclic nondegenerate pairing. In this section an \emph{operator} is a closed homogeneous $k$-linear operator on some mapping complex $\cat{C}(X,Y)$ in $\cat{C}$, that is, a closed homogeneous element of the complex $\Hom_k( \cat{C}(X,Y), \cat{C}(X,Y) )$. We are interested in linear operators on the $\cat{C}(X,Y)$ and adjunctions between them, with respect to the pairing.

Recall that if $\Psi$ is homogeneous then $1 \otimes \Psi$ acts on tensors with Koszul signs.

\begin{definition}\label{defn:adjointop} An operator $\Phi$ on $\cat{C}(X,Y)$ is \emph{adjoint} to an operator $\Psi$ on $\cat{C}(Y,X)$ if both $\Phi$ and $\Psi$ are homogeneous of the same degree and the diagram
\[
\xymatrix@C+1pc@R+0.5pc{
\cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[d]_{\Phi \otimes 1} \ar[r]^{1 \otimes \Psi} & \cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[d]^{c_{XY}}\\
\cat{C}(X,Y) \otimes \cat{C}(Y,X) \ar[r]_-{c_{XY}} & k
}
\]
commutes up to homotopy. Equivalently, there is a $k$-linear degree $|\Phi|+1$ morphism
\[
\mu: \cat{C}(X,Y) \otimes \cat{C}(Y,X) \lto k
\]
with the property that $[D, \mu] = c_{XY} \circ (1 \otimes \Psi) - c_{XY} \circ ( \Phi \otimes 1)$. Evaluated on homogeneous morphisms $\alpha, \beta$ this identity reads
\begin{equation}\label{eq:adjointopeq}
(-1)^{|\Phi|} \mu D(\alpha \otimes \beta) = (-1)^{|\alpha||\Psi|}\langle \alpha, \Psi(\beta) \rangle - \langle \Phi(\alpha) , \beta \rangle.
\end{equation}
\end{definition}

We will show in a moment that adjointness is symmetric in $\Phi, \Psi$ so there is no need to distinguish between left and right adjoints. If $\Psi$ is a homogeneous operator on $\cat{C}(Y,X)$ then $\Psi^*$ is the operator on $\Hom_k(\cat{C}(Y,X),k)$ defined by $\Psi^*(f) = (-1)^{|f||\Psi|} f \circ \Psi$. It is easy to see that

\begin{lemma} An operator $\Phi$ is adjoint to $\Psi$ if and only if the diagram
\begin{equation}\label{eq:lemadjointdia}
\xymatrix@C+2pc{
\cat{C}(X,Y) \ar[d]_\Phi \ar[r]^-{\zeta} & \Hom_k( \cat{C}(Y,X), k ) \ar[d]^{\Psi^*}\\
\cat{C}(X,Y) \ar[r]_-{\zeta} & \Hom_k( \cat{C}(Y,X), k)
}
\end{equation}
commutes up to homotopy.
\end{lemma}

\begin{lemma} An operator $\Phi$ is adjoint to $\Psi$ if and only if $\Psi$ is adjoint to $\Phi$.
\end{lemma}
\begin{proof}
By naturality of the graded twist $\tau$ and the cyclicity axiom for $c_{XY}$.
\end{proof}

\begin{lemma} Any operator $\Phi$ admits an adjoint, which is unique up to homotopy. 
\end{lemma}
\begin{proof}
This follows from commutativity of (\ref{eq:lemadjointdia}).
%If $\Phi$ is adjoint to $\Psi$ then from the previous lemma and (\ref{eq:lemadjointdia}) we deduce that $\Psi$ is homotopic to $\zeta^{-1} \circ \Phi^* \circ \zeta$ and from this both claims are clear.
\end{proof}

\begin{definition} Given an operator $\Phi$ we denote by $\Phi^{\dagger}$ the adjoint of $\Phi$.
\end{definition}

Since the adjoint is only well-defined up to homotopy it is implicit that in any identities involving the dagger notation we are working in the homotopy category of $\mathbb{Z}_2$-graded complexes. The following basic properties of adjoints are easily checked.

\begin{lemma} 
\begin{itemize}
\item[(i)] Let $\Phi_1, \Phi_2$ be operators on $\cat{C}(X,Y)$ and $\cat{C}(Y,Z)$ respectively. Then
\[
(\Phi_2 \circ \Phi_1)^{\dagger} = (-1)^{|\Phi_1||\Phi_2|} \Phi_1^{\dagger} \circ \Phi_2^{\dagger}\,.
\]
\item[(ii)] If $\Phi_1, \Phi_2$ are operators on $\cat{C}(X,Y)$ of the same degree, then $(\Phi_1 + \Phi_2)^{\dagger} = \Phi_1^{\dagger} + \Phi_2^{\dagger}$.
\end{itemize}
\end{lemma}

So much for the general theory; from now on $\cat{C}$ denotes the dg-category whose objects are finite rank matrix factorisations of $W$ and whose mapping complexes are given by the quotients
\[
\cat{C}(X,Y) = \Hom(\bar{X}, \bar{Y}) = \Hom(X,Y) \otimes_R \bar{R}\,.
\]
While the ordinary dg-category of matrix factorisations only admits a pairing which is homotopically nondegenerate, this (linear) quotient $\cat{C}$ admits a cyclic nondegenerate pairing in the stronger sense explained above. To define it, let
\[
\langle - \rangle: R \lto k
\]
denote the $k$-linear map
\[
\langle r \rangle = \Ress{R/k}\Bigg[ \frac{r \cdot \omega}{ f_1, \ldots, f_n} \Bigg]\,.
\]
This annihilates the ideal $(f_1,\ldots,f_n)R$ and therefore factors via a $k$-linear map $\bar{R} \lto k$.

\begin{proposition}\label{prop:barnondeg} The pairing on $\cat{C}$ defined by
\begin{gather*}
\langle -, - \rangle: \Hom(\bar{X}, \bar{Y}) \otimes \Hom(\bar{Y}, \bar{X}) \lto k\,,\\
\langle \varphi, \psi \rangle = \langle \str( \varphi \circ \psi ) \rangle
\end{gather*}
is cyclic and nondegenerate in the sense of Definition \ref{defn:nondegpair}.
\end{proposition}
\begin{proof}
The pairing factors as
\begin{equation}\label{eq:barnondeg}
\xymatrix@C+1pc{
\Hom(\bar{X}, \bar{Y}) \otimes \Hom(\bar{Y}, \bar{X}) \ar[r]^-{-\circ-} & \Hom(\bar{Y}, \bar{Y}) \ar[r]^-{\str} & \bar{R} \ar[r]^-{\langle - \rangle} & k
}
\end{equation}
so it is clear that it is a closed $k$-linear map, and moreover cyclicity follows from the cyclicity of the supertrace. Nondegeneracy follows from hypothesis (H4') and the following calculation, in which the first step is adjoint (\textbf{todo} not really!) to the composite of the first two maps in (\ref{eq:barnondeg})
\begin{align*}
\Hom_R(\bar{X}, \bar{Y}) &\cong \Hom_R( \Hom(\bar{Y}, \bar{X}), \bar{R} )\,\\
&\cong \Hom_R( \Hom(\bar{Y}, \bar{X}), \Hom_k( \bar{R}, k) )\\
&\cong \Hom_k( \Hom(\bar{Y}, \bar{X}), k )\,.
\end{align*}
\end{proof}

We have in mind two special classes of operators on the dg-category $\cat{C}$. The first arise because the partial derivatives $f_i$ act as zero on the cohomology of $\cat{C}$ but via nonzero maps on the dg-level. In what follows let $X,Y$ denote finite rank matrix factorisations of $W$.

\begin{definition} Given a null-homotopy $\lambda_i$ for the action of $f_i$ on $Y$, that is, a map $\lambda_i \in \Hom(Y,Y)$ of degree one with $[D, \lambda_i] = f_i \cdot 1_Y$, we define the odd operator $\lambda_i^\bullet$ on $\Hom(\bar{X},\bar{Y})$ by
\[
\lambda_i^\bullet(\varphi) = \lambda_i \circ \varphi\,
\]
and the odd operator ${\lambda_i}_\bullet$ on $\Hom(\bar{Y}, \bar{X})$ by
\[
{\lambda_i}_\bullet(\varphi) = (-1)^{|\varphi|} \varphi \circ \lambda_i \,.
\]
\end{definition}

Observe that composition with $\lambda_i$ is not a closed map on $\Hom(X,Y)$ but is closed as an operator on $\Hom(\bar{X}, \bar{Y})$. These operators give the simplest example of an adjoint pair.

\begin{lemma} The operator $\lambda_i^\bullet$ is adjoint to ${\lambda_i}_\bullet$.
\end{lemma}
\begin{proof}
The identity (\ref{eq:adjointopeq}) holds with $\mu = 0$, since
\begin{align*}
\langle {\lambda_i}_\bullet(\alpha), \beta \rangle &= \langle \str( {\lambda_i}_\bullet(\alpha) \circ \beta ) \rangle\\
&= (-1)^{|\varphi|} \langle \str( \alpha \circ \lambda_i \circ \beta ) \rangle\\
&= (-1)^{|\varphi|} \langle \alpha, \lambda_i^\bullet(\beta) \rangle\,.
\end{align*}
\end{proof}

The second class of operators are the components of the Atiyah class. Recall that by hypothesis (H2') the ring $R$ admits a flat $k$-linear connection $\nabla$ as a $k[f]$-module. The $n$ components of this connection define $k$-linear operators $\partial_{f_i} = (\ud f_i)^* \circ \nabla$ on $R$ with the property that $[\partial_{f_i}, f_j] = \delta_{ij}$.

Any free $R$-module admits a $k$-linear connection over $k[f]$. For convenience choose homogeneous $R$-bases $\{ e_i \}_{i \in I}$ for $X$ and $\{ e_j \}_{j \in J}$ for $Y$ respectively. Then the maps $e_{ji} = e_j \circ e_i^*$ form an $R$-basis for $\Hom(X,Y)$ and the induced $k$-linear connection over $k[f]$ is defined by
\begin{gather*}
\nabla = \nabla_{XY}: \Hom(X,Y) \lto \Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k}\,,\\
\nabla_{XY}( r e_{ji} ) = e_{ji} \otimes \nabla(r)\,.
\end{gather*}
This connection connection has components $\partial_{f_i}$ defined by $\partial_{f_i}( r e_{ji} ) = \partial_{f_i}(r) \cdot e_{ji}$ which are $k$-linear operators on $\Hom(X,Y)$. The \emph{Atiyah class} of $\Hom(X,Y)$ is the commutator
\[
\At = \At_{XY} = [D, \nabla] = D \circ \nabla - \nabla \circ D: \Hom(X,Y) \lto \Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k}\,.
\]
The Atiyah class is $k[f]$-linear and is easily seen to be a morphism of complexes from $\Hom(X,Y)$ to the shift $\Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k}[1]$. Moreover the homotopy class of this morphism is independent of the choice of connection, and in this sense choosing a basis for $X,Y$ is harmless. In terms of the components this means


\begin{definition} For $1 \le i \le n$ the components $\At_i = [D, \partial_{f_i}]$ of the Atiyah class define $k$-linear closed operators of degree one on $\Hom(\bar{X}, \bar{Y})$.
\end{definition}

For each pair of objects $X,Y$ in $\cat{C}$ we have defined a family of operators $\At_i$ on $\cat{C}(X,Y)$, defined using a choice of basis but independent of this choice up to homotopy. Conceptually, duality in the dg-category of matrix factorisations rests on the fact that these operators are anti-self-adjoint. To prove this we need the following Leibniz rule for Atiyah classes.

\begin{lemma}\label{lemma:leibnizatiyah} For homogeneous $\alpha \in \Hom(Y,Z)$ and $\beta \in \Hom(X,Y)$
\begin{equation}\label{eq:leibnizcompos}
\At_i( \alpha \circ \beta ) = \At_i(\alpha) \circ \beta + (-1)^{|\alpha|} \alpha \circ \At_i(\beta) + [g,D]( \alpha \otimes \beta)
\end{equation}
where $g( \alpha \otimes \beta ) = \partial_i(\alpha) \circ \beta + \alpha \circ \partial_i(\beta) - \partial_i( \alpha \circ \beta )$.
\end{lemma}
\begin{proof}
If $\nabla_{YZ}$ denotes the connection on $\Hom(Y,Z)$ and $\nabla_{XY}$ the connection on $\Hom(X,Y)$ then
\[
\nabla_{YZ,XY}(\alpha \otimes \beta) = \nabla_{YZ}(\alpha) \otimes \beta + \alpha \otimes \nabla_{XY}(\beta)
\]
defines a connection on $\Hom(Y,Z) \otimes_{k[f]} \Hom(X,Y)$. With $\At_{YZ,XY} = [D, \nabla_{YZ,XY}]$ it follows from naturality of the Atiyah class \cite{??} that the diagram
\[
\xymatrix{
\Hom(Y,Z) \otimes_{k[f]} \Hom(X,Y) \ar[d]_{\At_{YZ,XY}}\ar[r]^-{\kappa} & \Hom(X,Z) \ar[d]^{\At_{XZ}}\\
\Hom(Y,Z) \otimes_{k[f]} \Hom(X,Y) \otimes_{k[f]} \Omega^1_{k[f]/k} \ar[r]_-{\kappa} & \Hom(X,Z) \otimes_{k[f]} \Omega^1_{k[f]/k}
}
\]
commutes up to homotopy, where $\kappa$ is the composition map. Specifically, if $g = [\kappa, \nabla] = \kappa \circ \nabla_{YZ,XY} - \nabla_{XZ} \circ \kappa$ then a simple calculation using the graded Jacobi identity shows that
\[
\At_{XZ} \circ \kappa - \kappa \circ \At_{YZ,XY} = [g,D]\,.
\]
Applying both sides to $\alpha \otimes \beta$ and projecting to the $\ud f_i$ component yields (\ref{eq:leibnizcompos}).
\end{proof}

\begin{lemma}\label{lemma:stratiyahzero} For any $\alpha \in \Hom(X,X)$ we have $\str( \At_i( \alpha ) ) = 0$ in $R$.
\end{lemma}
\begin{proof}
Consider the diagram
\[
\xymatrix@C+1pc{
\Hom(X,X) \ar[d]_{\At_{XX}} \ar[r]^-{\str} & R \ar[d]^{\At = 0}\\
\Hom(X,X) \otimes_{k[f]} \Omega^1_{k[f]/k} \ar[r]_-{\str} & R \otimes_{k[f]} \Omega^1_{k[f]/k}\,.
}
\]
By the graded Jacobi identity $\str \circ \At_{XX} = [\str, \At] = [g,D]$ where $g: \Hom(X,X) \lto R \otimes_{k[f]} \Omega^1_{k[f]/k}$ is $g = [\str, \nabla]$. But from the way we have defined our connections, it is clear that $\str$ and $\nabla$ commute, so $g = 0$ and $\str \circ \At_{XX} = 0$.
\end{proof}

\begin{proposition} The operator $\At_i$ on $\Hom(\bar{X}, \bar{Y})$ is adjoint to $-\At_i$ on $\Hom(\bar{Y}, \bar{X})$.
\end{proposition}
\begin{proof}
If we apply $\langle \str( - ) \rangle$ to both sides of (\ref{eq:leibnizcompos}) and use Lemma \ref{lemma:stratiyahzero} we find that
\begin{align*}
\langle \At_i(\alpha), \beta \rangle = -(-1)^{|\alpha|} \langle \alpha,  \At_i(\beta) \rangle - \langle \str( gD(\alpha \otimes \beta) ) \rangle\,.
\end{align*}
So $\mu( \alpha \otimes \beta ) = \langle \str( g( \alpha \otimes \beta ) ) \rangle$ is a homotopy expressing $\At_i$ as adjoint to $-\At_i$.
\end{proof}

\subsection{Idempotents}\label{section:idempkl}

In the previous section we constructed operators $\lambda_i^\bullet, {\lambda_i}_\bullet$ and $\At_i$ on the dg-category $\cat{C}$. Now we use these operators to define idempotent endomorphisms of the complex
\[
\cat{C}(X,Y) = \Hom(\bar{X}, \bar{Y})
\]
which split in the homotopy category of $\mathbb{Z}_2$-graded $k$-complexes to give $\Hom(X,Y)$. In this way the dg-category of matrix factorisations can be recovered from the quotient $\cat{C}$ and the nondegenerate pairing defined above induces the homotopically nondegenerate pairing $\langle -, - \rangle_{\textup{KL}}$.

The main result of \cite{??} is that if $V$ is the free $k$-module on the basis $\theta_1,\ldots,\theta_n$ then there is a homotopy equivalence
\[
\Hom(\bar{X}, \bar{Y}) \cong \Hom(X,Y) \otimes_k \bigwedge V\,.
\]
There are consequently $2^n$ ways to embed $\Hom(X,Y)$ in the homotopy category of $k$-complexes as a direct summand in $\Hom(\bar{X}, \bar{Y})$. The ``top degree'' embedding, corresponding to the form $\theta_1 \cdots \theta_n$, is determined by the following idempotent endomorphism of $\Hom(\bar{X}, \bar{Y})$
\[
e = \frac{1}{(n!)^2} (-1)^{\binom{n}{2}}\sum_{\sigma,\tau \in S_n} \textup{sgn}(\sigma\tau) \cdot \lambda_{\sigma(1)}^\bullet \cdots \lambda_{\sigma(n)}^\bullet \At_{\tau(1)} \cdots \At_{\tau(n)}\,.
\]
The embedding corresponding to the $0$-form $1$ in $\bigwedge V$ was not discussed in \cite{??} but we give the details in Appendix \ref{??}. The upshot is that this embedding is determined by the idempotent
\[
e' = \frac{1}{(n!)^2} (-1)^{\binom{n+1}{2}}\sum_{\sigma, \tau \in S_n} \textup{sgn}(\sigma\tau) \cdot \At_{\tau(1)} \cdots \At_{\tau(n)} {\lambda_{\sigma(1)}}_\bullet \cdots {\lambda_{\sigma(n)}}_\bullet\,.
\]
To be precise, there is a diagram of degree zero $k$-linear morphisms of complexes
\[
\xymatrix@C+2pc{
\Hom(\bar{X}, \bar{Y}) \ar@<-0.5ex>[r]_-{\psi} & \Hom(X,Y)[n] \ar@<-0.5ex>[l]_-{\vartheta}
}
\]
with $\psi \circ \vartheta = 1$ and $\vartheta \circ \psi = e$ (equalities meaning equal up to $k$-linear homotopy) and a diagram
\[
\xymatrix@C+2pc{
\Hom(\bar{Y}, \bar{X}) \ar@<-0.5ex>[r]_-{\psi'} & \Hom(Y,X) \ar@<-0.5ex>[l]_-{\vartheta'}
}
\]
with $\psi' \circ \vartheta' = 1$ and $\vartheta' \circ \psi' = e'$. A concrete description of $\psi, \psi'$ is not important for us, but we will need to know that $\vartheta'$ is simply the quotient map, and that
\[
\vartheta = \frac{1}{n!} \sum_{\sigma \in S_n} \textup{sgn}(\sigma) \lambda_{\sigma(1)}^\bullet \cdots \lambda_{\sigma(n)}^{\bullet}\,.
\]

\begin{proposition}\label{prop:eadjointeprime} The idempotent $e$ is adjoint to $(-1)^n e'$. Equivalently, the diagram
\begin{equation}\label{eq:eadjointeprime}
\xymatrix@C+2pc{
\Hom(\bar{X}, \bar{Y}) \ar[d]_-{e} \ar[r]^-{\zeta}_-{\cong} & \Hom_k(\Hom(\bar{Y},\bar{X}),k) \ar[d]^-{(-1)^n (e')^*}\\
\Hom(\bar{X}, \bar{Y}) \ar[r]_-{\zeta}^-{\cong} & \Hom_k( \Hom(\bar{Y}, \bar{X}), k )
}
\end{equation}
commutes up to homotopy.
\end{proposition}
\begin{proof} 
Observe that by the (anti-)self-adjointness established in the previous section
\begin{align*}
\left( \lambda_{\sigma(1)}^\bullet \cdots \lambda_{\sigma(n)}^\bullet \At_{\tau(1)} \cdots \At_{\tau(n)} \right)^{\dagger} &= (-1)^n \At^\dagger_{\tau(n)} \cdots \At^\dagger_{\tau(1)} (\lambda_{\sigma(n)}^\bullet)^\dagger \cdots (\lambda_{\sigma(1)}^\bullet)^{\dagger}\\
&= \At_{\tau(n)} \cdots \At_{\tau(1)} {\lambda_{\sigma(n)}}_{\bullet} \cdots {\lambda_{\sigma(1)}}_{\bullet}\,,
\end{align*}
from which it is immediate that $e^{\dagger} = (-1)^n e'$.
\end{proof}

\begin{proposition}\label{prop:almostkltheorem} The pairing (\ref{eq:generalklpairing}) is homotopically nondegenerate.
\end{proposition}
\begin{proof} Consider the diagram
\[
\xymatrix@C+2pc{
\Hom(\bar{X},\bar{Y}) \ar[d]_-{\zeta}^-{\cong} \ar@<-0.5ex>[r]_-{\psi} & \Hom(X,Y)[n] \ar@<-0.5ex>[l]_-{\vartheta} \ar@{.>}[d]^{\zeta_{\textup{KL}}}\\
\Hom_k(\Hom(\bar{Y}, \bar{X},k) \ar@<-0.5ex>[r]_-{(\vartheta')^*} & \Hom_k( \Hom(Y,X), k) \ar@<-0.5ex>[l]_-{(\psi')^*}
}
\]
where $\zeta_{KL} = (\vartheta')^* \circ \zeta \circ \vartheta$. It is immediate from commutativity of (\ref{eq:eadjointeprime}) up to homotopy that $\zeta_{\textup{KL}}$ is a homotopy equivalence with inverse $(-1)^n \psi \circ \zeta^{-1} \circ (\psi')^*$. To prove the theorem it only remains to observe that $\zeta_{\textup{KL}}(\alpha)$ is the functional $\langle \alpha, - \rangle_{\textup{KL}}$. But
\begin{align*}
\zeta_{\textup{KL}}(\alpha) &= (\vartheta')^* \zeta \vartheta( \alpha )\\
&= (\vartheta')^* \zeta\left( \frac{1}{n!} \sum_{\sigma \in S_n} \textup{sgn}(\sigma) \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} \circ \alpha \right)\\
&= \frac{1}{n!} (-1)^n \sum_{\sigma \in S_n} \textup{sgn}(\sigma) \langle \str( \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} \circ \alpha \circ (-) ) \rangle\\
&= \frac{1}{n!} \sum_{\sigma \in S_n} \textup{sgn}(\sigma) \langle \str(  \alpha \circ (-) \circ \lambda_{\sigma(1)} \circ \cdots \circ \lambda_{\sigma(n)} ) \rangle\\
&= \langle \alpha, - \rangle_{\textup{KL}}
\end{align*}
which completes the proof.
\end{proof}

Let us now abandon the general setting, and return to the situation of the main theorem where $R = k[x_1,\ldots,x_n]$, and (H1)-(H3) are satisfied for $f_i = \partial_{x_i} W$ and $\omega = \ud x_1 \cdots \ud x_n$.

\begin{proof}[Proof of Theorem \ref{theorem:generalkl}] Set $I = (f_1,\ldots,f_n)R$ and let $\widehat{R}$ denote the $I$-adic completion of $R$. Then by \cite{??} this algebra admits a flat standard connection as a $k[f]$-module, and the other axioms among (H1')-(H4') follow for $\widehat{R}$ from our hypotheses about $R$ with $\omega = \ud x_1 \cdots \ud x_n$ (here we use that residues for $R/k$ and $\widehat{R}/k$ agree). Note that in (H1') we only need that the $f_i$ act null-homotopically on the matrix factorisations
\[
\widehat{X} = X \otimes_R \widehat{R}, \qquad \widehat{Y} = Y \otimes_R \widehat{R}
\]
extended from $R$. Consider the diagram
\[
\xymatrix@C+2pc{
\Hom_R(X,Y) \ar[d]_{\can} \ar[r] & \Hom_k( \Hom_R(Y,X), k )[n]\\
\Hom_{\widehat{R}}(\widehat{X}, \widehat{Y}) \ar[r] & \Hom_k( \Hom_{\widehat{R}}(\widehat{X}, \widehat{Y}), k)[n] \ar[u]_{\can}
}
\]
where the columns are the canonical maps, and the rows are adjoint to the two versions of the pairing (\ref{eq:generalklpairing}). It is easy to see that this diagram commutes, and as the bottom row is a homotopy equivalence by Proposition \ref{prop:almostkltheorem}, to prove the theorem it is enough to argue that the canonical map
\[
\Hom_R(X,Y) \lto \Hom_{\widehat{R}}(\widehat{X}, \widehat{Y})
\]
is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes over $k$. But this is a consequence of the general fact that the ``pushforward commutes with flat base change'', see \cite[Remark 7.7]{??}.
\end{proof}

\subsection{Graded duality}\label{section:gradedduality}

In this section we collect together the modifications necessary in order to make Theorem \ref{theorem:generalkl} compatible with an additional $\mathbb{Z}$-grading on matrix factorisations. Our conventions for graded modules and matrix factorisations are contained in Section \ref{??}.

Let $k$ be a noetherian $\mathbb{Q}$-algebra which is graded, and let $R = k[x_1,\ldots,x_n]$ be a graded ring in such a way that the structural map $k \lto R$ has degree zero. Let $W \in R$ be given, homogeneous of degree $|W| = 2c$ and let $X,Y$ be finite rank graded matrix factorisations of $W$ over $R$. Define
\[
a = \sum_{i=1}^n |x_i| - nc.
\]
Then the graded analogue of the earlier theorem is

\begin{theorem}\label{theorem:generalklgraded} Under the conditions (H1)-(H3) of Theorem \ref{theorem:generalkl} the pairing $\langle -, - \rangle_{\textup{KL}}$ is adjoint to a homotopy equivalence of $\mathbb{Z} \times \mathbb{Z}_2$-graded complexes over $k$
\[
\Hom(X,Y) \lto \Hom^{gr}_k( \Hom(Y,X), k )[n](a)\,.
\]
\end{theorem}

Note that $\Hom(Y,X)$ is unlikely to be finitely generated over $k$, so there is a need to distinguish between $\Hom_k$ and $\Hom_k^{gr}$. For the proof we need the following fact about residues.

\begin{lemma}\label{lemma:residuesarehomog} If $f_1,\ldots,f_n$ is a regular sequence in $R$ of homogeneous elements, then the map
\[
\Ress{R/k}\Bigg[ \frac{(-) \, \ud \underline{x}}{ f_1, \ldots, f_n} \Bigg]: R \lto k
\]
is homogeneous of degree $\sum_{i=1}^n( |x_i| - |f_i| )$.
\end{lemma}
\begin{proof}
(\textbf{todo}) Follows from the determinantal formula for residues in Lipman's book.
\end{proof}

\begin{proof}[Proof of Theorem \ref{theorem:generalklgraded}]
Consider the following diagram of $\mathbb{Z}_2$-graded complexes
\[
\xymatrix@C+2pc{
\Hom(X,Y) \ar@{.>}[dr]_-{\zeta_{gr}} \ar[r]^-{\zeta_{KL}} & \Hom(\Hom(Y,X),k)[n]\\
& \Hom^{gr}_k( \Hom(Y,X), k)[n](a) \ar[u]_{\iota = \inc}
}
\]
where $\zeta_{KL}$ is adjoint to (\ref{eq:generalklpairing}), and is therefore a homotopy equivalence by the earlier theorem. It is clear from the explicit formula for the pairing and Lemma \ref{lemma:residuesarehomog} that the image of $\zeta_{KL}$ lies in the subspace of homogeneous maps, and we let $\zeta_{gr}$ denote this factorisation. The value of $a$ is chosen such that $\zeta_{gr}$ is homogeneous of degree zero. It is enough to prove that $\zeta_{gr}$ is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes (forgetting the $\mathbb{Z}$-grading) since then by an elementary argument we can find a homotopy inverse which is degree zero, and graded homotopies.

It suffices to prove that the inclusion $\iota$ is a homotopy equivalence of $\mathbb{Z}_2$-graded complexes. This would be a tautology if $\Hom(Y,X)$ were a finitely generated $k$-module, and in general we use the fact that $\Hom(Y,X)$ embeds up to homotopy in a finitely generated complex. That is: by \cite[Section ??]{blah} we have a diagram
\begin{equation}\label{eq:generalklgraded}
\xymatrix@C+2pc{
\Hom(\bar{Y}, \bar{X}) \ar@<-0.5ex>[r]_-{\psi} & \Hom(Y,X)[n] \ar@<-0.5ex>[l]_-{\vartheta}
}
\end{equation}
of $\mathbb{Z}_2$-graded complexes over $k$ with $\psi \circ \vartheta \simeq 1$. But if one examines the explicit expressions for $\vartheta, \psi$ given in \emph{loc.cit.} it is clear that $\vartheta$ has degree $-a$, $\psi$ has degree $a$, and the homotopy between $\psi \circ \vartheta$ and the identity is homogeneous. If we apply both $\Hom_k(-,k)$ and $\Hom_k^{gr}(-,k)$ to (\ref{eq:generalklgraded}) we obtain a diagram
\[
\xymatrix@C+2pc{
\Hom_k( \Hom(\bar{Y}, \bar{X}), k ) \ar@<-0.5ex>[r]_-{\vartheta^*} & \Hom_k(\Hom(Y,X),k)[n] \ar@<-0.5ex>[l]_-{\psi^*}\\
\Hom_k^{gr}(\Hom(\bar{Y}, \bar{X}), k) \ar[u]^{=} \ar@<-0.5ex>[r]_-{\vartheta^*} & \Hom_k^{gr}(\Hom(Y,X),k)[n](a) \ar@<-0.5ex>[l]_-{\psi^*} \ar[u]_{\iota}
}
\]
in which both of the implict squares commute up to homotopy, and from this we deduce that $\iota$ is a homotopy equivalence with inverse $\vartheta^* \circ \psi^*$.
\end{proof}

\section{Symmetrised idempotents}\label{section:symidem}

In Section \ref{section:dualityadjointop} we used the idempotent pushforward construction of \cite{dm1102.2957} to establish a relative form of duality for matrix factorisations. We needed slightly more than what is stated in \emph{loc.cit.} and in this appendix we provide the necessary additions. With later applications in mind we work in the same generality as the original construction, but the reader should keep in mind that for Section \ref{section:dualityadjointop} we only need the case $Z = \Hom_R(X,Y)$ and $W = 0$ of the following.

Let $k$ be a commutative $\mathbb{Q}$-algebra and $R$ a $k$-algebra with a quasi-regular sequence $\{ f_1, \ldots, f_n \}$ such that $\bar{R} = R/(f_1,\ldots,f_n)R$ is a finitely generated projective $k$-module. Let $W \in k$ be given and let $Z$ be a finite rank matrix factorisation of $W$ over $R$ with each $f_i$ acting null-homotopically on $Z$, moreover let $\lambda_i \in \Hom_R(Z,Z)$ be odd maps with $[D, \lambda_i] = f_i \cdot 1_Z$ for each $1 \le i \le n$.

The aim is to present $Z$, up to $k$-linear homotopy equivalence, as the splitting of an idempotent on the quotient $\bar{Z} = Z \otimes_R \bar{R}$. Suppose that $R$ admits a flat $k$-linear connection $\nabla$ as a $k[f]$-module which is standard in the sense of \cite{??}. If $K(f) = K(f_1,\ldots,f_n)$ denotes the usual Koszul complex then by hypothesis the map $K(f) \lto \bar{R}$ is a quasi-isomorphism and by \cite[Section 10]{dm1102.2957} the projection
\begin{equation}\label{eq:symidem1}
\pi: Z \otimes_R K(f) \lto Z \otimes_R \bar{R} = \bar{Z}
\end{equation}
is a homotopy equivalence over $k$. 

As a graded $R$-algebra $K(f)$ is the exterior algebra $\bigwedge F$ where $F$ is $R$-free on symbols $\theta_1,\ldots,\theta_n$ placed in degree $-1$. Since the $f_i$ all act null-homotopically on $Z$ it is easy to see that $Z \otimes_R K(f)$ is homotopy equivalent over $R$ to the tensor product $Z \otimes_R \bigwedge F$, with no differential placed on the exterior component. This is just a direct sum of $2^n$ copies of $Z$ and $Z[1]$. In light of (\ref{eq:symidem1}) this means that in the homotopy category of linear factorisations of $W$ over $k$, there is a homotopy equivalence
\[
\bar{Z} \cong Z \otimes_k \bigwedge (k\theta_1 \oplus \cdots \oplus k\theta_n)
\]
and to this direct sum decomposition corresponds $2^n$ orthogonal idempotents on $\bar{Z}$.

To describe these idempotents, consider the case of a single $f_i$, so there is an exact sequence
\[
\xymatrix{
0 \ar[r] & Z \ar[r]^-{\kappa_i} & Z \otimes K(f_i) \ar[r]^-{\varepsilon_i} & Z[1] \ar[r] & 0
}
\]
where $\kappa_i(x) = x \otimes 1$ is the inclusion and $\varepsilon_i( x \theta_i ) = (-1)^{|x|} x$. This sequence is split exact, and choosing a splitting is equivalent to choosing a null-homotopy on $X$ for action of $f_i$. The maps
\[
\rho_i(x + y \theta_i) = x + (-1)^{|y|} \lambda_i(y), \qquad \vartheta_i(x) = (-1)^{|x|} x \theta_i - \lambda_i(x)
\]
satisfy $\kappa_i \circ \rho_i + \vartheta_i \circ \varepsilon_i = 1$ and $\rho_i \circ \kappa_i = 1, \varepsilon_i \circ \theta_i = 1$ and $\rho_i \circ \vartheta_i = 0$. That is, they equip $Z \otimes_R K(f_i)$ with the structure of a biproduct $X \oplus X[1]$. It will be convenient to have a more compact definition of $\vartheta$. Let us agree that left multiplication by $\theta_i$ on $X \otimes_R K(f)$ comes with signs $\theta_i \cdot (x \otimes \eta) = (-1)^{|x|} x \otimes \theta_i \eta$ so that multiplication by $\theta_i$ defines a map $\theta_i: X \lto X \otimes_R K(f_i)$ and $\vartheta_i = \theta_i - \lambda_i$.

To construct idempotents on $X \otimes_R K(f)$ we can inductively apply either the projections $\varepsilon$ or $\rho$ until we reach form degree zero, e.g. in the first step
\[
X \otimes_R K(f_1,\ldots,f_n) = (X \otimes_R K(f_1,\ldots,f_{n-1})) \otimes_R K(f_n) \xlto{\varepsilon} (X \otimes_R K(f_1,\ldots,f_{n-1}))[1]\,,
\]
and applying $\varepsilon$ $(n-1)$ more times we obtain a split epimorphism $\varepsilon: X \otimes_R K(f) \lto X[n]$ defined by $\varepsilon(x \theta_1 \cdots \theta_n) = (-1)^{n|x|} x$ with left inverse $\vartheta$. The formula given in \cite[Section 4]{dm1102.2957} depends on a chosen ordering of the $\lambda$'s, but we can symmetrise over all permutations to obtain the left inverse
\[
\vartheta = \frac{1}{n!} \sum_{\sigma \in S_n} \textup{sgn}(\sigma) (\theta_{\sigma(1)} - \lambda_{\sigma(1)}) \circ \cdots \circ (\theta_{\sigma(n)} - \lambda_{\sigma(n)})
\]
to $\varepsilon$. One checks directly that $\varepsilon \circ \vartheta = 1$, so $\vartheta \circ \varepsilon$ is an idempotent on $X \otimes_R K(f)$ splitting to $X[n]$.

If instead we project out with $\rho$ at each step we obtain the split epimorphism
\[
\rho: X \otimes_R K(f) \lto X, \qquad \rho(x) = ...
\]
with left inverse the inclusion $\kappa(x) = x \otimes 1$. Again, symmetrising.

So we have produced the two idempotents on $X \otimes_R K(f)$ corresponding to top form degree and bottom form degree. Let us now shift these to idempotents on $\bar{Z}$. $e$ is taken care of in \cite{??} so we worry only about $e'$.
\[
\xymatrix{
\bar{Z} \ar@<-0.5ex>[r]_-{\sigma_\infty} & Z \otimes_R K(f) \ar@<-0.5ex>[l]_-{\pi} \ar@<-0.5ex>[r]_-{\rho} & Z \ar@<-0.5ex>[l]_-{\kappa}
}
\]
Here $\sigma_\infty$ is described by

\begin{lemma} We have
\[
\sigma_\infty = \sum_{m \ge 0} \sum_{\sigma \in S_{m,n}} (-1)^{\binom{m+1}{2}} \frac{1}{m!} \At_{\sigma(1)} \cdots \At_{\sigma(m)} \theta_{\sigma(1)} \cdots \theta_{\sigma(m)}
\]
\end{lemma}
\begin{proof}
By construction modulo the $f_i$ we have ($\nabla_{gr}$ has degree one for commutators)
\begin{align*}
\sigma_\infty &= \sum_{m \ge 0} (-1)^m (\tau^{-1} \nabla_{gr} D) \cdots (\tau^{-1} \nabla_{gr} D) \,\\
&= \sum_{m \ge 0} (-1)^m \frac{1}{m!} [ D, \nabla_{gr} ]^m \\
&= \sum_{m \ge 0} \sum_{\sigma \in S_{m,n}} (-1)^{\binom{m+1}{2}} \frac{1}{m!} \At_{\tau(1)} \cdots \At_{\tau(m)} \theta_{\sigma(1)} \cdots \theta_{\sigma(m)}
\end{align*}
\end{proof}

It follows that
\begin{align*}
e' &= \pi \circ \kappa \circ \rho \circ \sigma_\infty\\
&= \sum_{m \ge 0} \sum_{\sigma \in S_{m,n}} (-1)^{\binom{m+1}{2}} \rho \At_{\sigma(1)} \cdots \At_{\sigma(m)} \theta_{\sigma(1)} \cdots \theta_{\sigma(m)}
&= the good formula
\end{align*}



\newcommand{\etalchar}[1]{$^{#1}$}
\providecommand{\href}[2]{#2}
\begin{thebibliography}{FYH{\etalchar{+}}85}

%\bibitem[AS]{as1105.5117}
%M.~Aganagic and S.~Shakirov, \textsl{Knot {H}omology from {R}efined
%  {C}hern-{S}imons {T}heory},
%  \href{http://arxiv.org/abs/1105.5117}{[arXiv:1105.5117]}.
%
%\bibitem[BN]{bnKhovanov11crossings}
%D.~Bar-Natan, \textsl{Khovanov {H}omology for {K}nots and {L}inks with up to 11
%  {C}rossings}, available at
%  \href{http://www.math.toronto.edu/drorbn/papers/KHTables/KHTables.pdf}{http:%
%//www.math.toronto.edu/drorbn/papers/KHTables/KHTables.pdf}.
%
%\bibitem[Bec]{b1105.0702}
%H.~Becker, \textsl{Khovanov-Rozansky homology via Cohen-Macaulay approximations and Soergel bimodules},
%  \href{http://arxiv.org/abs/1105.0702}{[arXiv:1105.0702]}.
%
%\bibitem[BR07]{br0707.0922}
%I.~Brunner and D.~Roggenkamp, \textsl{B-type defects in {L}andau-{G}inzburg
%  models}, JHEP \textbf{0708} (2007), 093,
%  \href{http://arxiv.org/abs/0707.0922}{[arXiv:0707.0922]}.
%
%\bibitem[CF94]{cf9405183}
%L.~Crane and I.~B. Frenkel, \textsl{Four dimensional topological quantum field
%  theory, {H}opf categories, and the canonical bases}, J. Math. Phys.
%  \textbf{35} (1994), 5136--5154,
%  \href{http://arxiv.org/abs/hep-th/9405183}{[hep-th/9405183]}.
%
%\bibitem[CK08a]{ck0701194}
%S.~Cautis and J.~Kamnitzer, \textsl{Knot homology via derived categories of
%  coherent sheaves {I}, {$sl(2)$} case}, Duke Math. J. \textbf{142} (2008),
%  511--588, \href{http://arxiv.org/abs/math/0701194}{[math.AG/0701194]}.
%
%\bibitem[CK08b]{ck0710.3216}
%S.~Cautis and J.~Kamnitzer, \textsl{Knot homology via derived categories of coherent sheaves {II},
%  {$sl(m)$} case}, Invent. Math. \textbf{174} (2008), 165--232,
%  \href{http://arxiv.org/abs/math/0710.3216}{[math.AG/0710.3216]}.
%
%\bibitem[CM]{cmWebCompileCode}
%N.~Carqueville and D.~Murfet, \textsl{Code to compute {K}hovanov-{R}ozansky
%  homology and defect fusion in {L}andau-{G}inzburg models},
%  \href{http://www.carqueville.net/nils/webCompilations}{http://www.carqueville.net/nils/webCompilations}.

\bibitem[CR10]{cr0909.4381}
N.~Carqueville and I.~Runkel, \textsl{On the monoidal structure of matrix bi-factorisations}, J. Phys.
  A: Math. Theor. \textbf{43} (2010), 275401,
  \href{http://arxiv.org/abs/0909.4381}{[arXiv:0909.4381]}.

\bibitem[CR12]{cr1006.5609}
N.~Carqueville and I.~Runkel, \textsl{Rigidity and defect actions in
  Landau-Ginzburg models}, Comm. Math. Phys. \textbf{310} (2012) 135--179, 
  \href{http://arxiv.org/abs/1006.5609}{[arXiv:1006.5609]}.

%\bibitem[Cra]{c0403266}
%M.~Crainic, \textsl{On the perturbation lemma, and deformations},
%  \href{http://arxiv.org/abs/math/0403266}{[math.AT/0403266]}.
%
%\bibitem[DGR06]{dgr0505662}
%N.~M. Dunfield, S.~Gukov, and J.~Rasmussen, \textsl{The {S}uperpolynomial for
%  {K}not {H}omologies}, Experimental Math. \textbf{15} (2006), 129--159,
%  \href{http://arxiv.org/abs/math/0505662}{[math.GT/0505662]}.
%
%\bibitem[DKR]{dkr1107.0495}
%A.~Davydov, L.~Kong, and I.~Runkel, \textsl{Field theories with defects and the
%  centre functor}, \href{http://arxiv.org/abs/1107.0495}{[arXiv:1107.0495]}.
%
%\bibitem[DBM{\etalchar{+}}11]{dbmmss1106.4305}
%P.~Dunin-Barkowski, A.~Mironov, A.~Morozov, A.~Sleptsov, A.~Smirnov, \textsl{Superpolynomials for toric knots from evolution induced by cut-and-join operators},
%  \href{http://arxiv.org/abs/1106.4305}{[arXiv:1106.4305]}. 
%  
\bibitem[Dyc11]{d0904.4713}
T.~Dyckerhoff, \textsl{Compact generators in categories of matrix factorizations},
  Duke Math. J. \textbf{159} (2011), 223--274,
  \href{http://arxiv.org/abs/0904.4713}{[arXiv:0904.4713]}.

\bibitem[DM]{dm1102.2957}
T.~Dyckerhoff and D.~Murfet, \textsl{Pushing forward matrix factorisations},
  \href{http://arxiv.org/abs/1102.2957}{[arXiv:1102.2957]}.

%\bibitem[FFRS07]{ffrs0607247}
%J.~Fr\"ohlich, J.~Fuchs, I.~Runkel, and C.~Schweigert, \textsl{Duality and
%  defects in rational conformal field theory}, Nucl. Phys. B \textbf{763}
%  (2007), 354--430,
%  \href{http://arxiv.org/abs/hep-th/0607247}{[hep-th/0607247]}.
%
%\bibitem[FYH{\etalchar{+}}85]{Homfly}
%P.~Freyd, D.~Yetter, J.~Hoste, W.~B.~R. Lickorish, K.~Millett, and A.~Ocneanu,
%  \textsl{A new polynomial invariant of knots and links}, Bull. Amer. Math. Soc.
%  \textbf{12} (1985), 239--246.
%
%\bibitem[GIKV10]{gikv0705.1368}
%S.~Gukov, A.~Iqbal, C.~Koz\c{c}az, and C.~Vafa, \textsl{Link {H}omologies and the
%  {R}efined {T}opological {V}ertex}, Comm. Math. Phys. \textbf{298} (2010),
%  757--785, \href{http://arxiv.org/abs/0705.1368}{[arXiv:0705.1368]}.
%
%\bibitem[GSV05]{gsv0412243}
%S.~Gukov, A.~Schwarz, and C.~Vafa, \textsl{Khovanov-{R}ozansky {H}omology and
%  {T}opological {S}trings}, Lett. Math. Phys. \textbf{74} (2005), 53--74,
%  \href{http://arxiv.org/abs/hep-th/0412243}{[hep-th/0412243]}.
%
%\bibitem[GV99]{gv9811131}
%R.~Gopakumar and C.~Vafa, \textsl{On the {G}auge {T}heory/{G}eometry
%  {C}orrespondence}, Adv. Theor. Math. Phys. \textbf{3} (1999), 1415--1443,
%  \href{http://arxiv.org/abs/hep-th/9811131}{[hep-th/9811131]}.
%
%\bibitem[GW]{gw0512298}
%S.~Gukov and J.~Walcher, \textsl{Matrix {F}actorizations and {K}auffman
%  {H}omology}, \href{http://arxiv.org/abs/hep-th/0512298}{[hep-th/0512298]}.
%
%\bibitem[Jae]{j1101.3302}
%T.~C. Jaeger, \textsl{Khovanov-{R}ozansky {H}omology and {C}onway {M}utation},
%  \href{http://arxiv.org/abs/1101.3302}{[arXiv:1101.3302]}.
%
%\bibitem[Jon85]{JonesPolynomialPaper}
%V.~F.~R. Jones, \textsl{A polynomial invariant for knots via von {N}eumann
%  algebras}, Bull. Amer. Math. Soc. \textbf{12} (1985), 103--111.
%
%\bibitem[Kap]{k1004.2307}
%A.~Kapustin, \textsl{Topological {F}ield {T}heory, {H}igher {C}ategories, and
%  {T}heir {A}pplications},
%  \href{http://arxiv.org/abs/1004.2307}{[arXiv:1004.2307]}.
%
%\bibitem[Kaw96]{kawauchibook}
%A.~Kawauchi, \textsl{A {S}urvey of {K}not {T}heory}, Birkh\"auser, 1996.
%
%\bibitem[Kho00]{k9908171}
%M.~Khovanov, \textsl{A categorification of the {J}ones polynomial}, Duke Math. J.
%  \textbf{101} (2000), 359--426,
%  \href{http://arxiv.org/abs/math/9908171}{[math.QA/9908171]}.
%
%\bibitem[Kho07]{k0510265}
%M.~Khovanov, \textsl{Triply-graded link homology and Hochschild homology of Soergel bimodules},
%  Int. Journal of Math. \textbf{18} (2007), 869--885,
%  \href{http://arxiv.org/abs/math/0510265}{[math.GT/0510265]}.
%
%\bibitem[KR07a]{kr0701333}
%M.~Khovanov and L.~Rozansky, \textsl{Virtual crossings, convolutions and a
%  categorification of the {$\operatorname{SO}(2N)$} {K}auffman polynomial},
%  Journal of G\"okova Geometry Topology \textbf{1} (2007), 116--214,
%  \href{http://arxiv.org/abs/math/0701333}{[math.QA/0701333]}.
%
%\bibitem[KR07b]{kr0404189}
%M.~Khovanov and L.~Rozansky, \textsl{Topological Landau-Ginzburg models on the world-sheet foam},
%  Adv. Theor. Math. Phys. \textbf{11} (2007), 233--259,
%  \href{http://arxiv.org/abs/hep-th/0404189}{[hep-th/0404189]}.
%
%\bibitem[KR08a]{kr0401268}
%M.~Khovanov and L.~Rozansky, \textsl{Matrix factorizations and link homology}, Fund. Math.
%  \textbf{199} (2008), 1--91,
%  \href{http://arxiv.org/abs/math/0401268}{[math/0401268]}.
%
%\bibitem[KR08b]{kr0505056}
%M.~Khovanov and L.~Rozansky, \textsl{Matrix factorizations and link homology {II}}, Geometry \&
%  Topology \textbf{12} (2008), 1387--1425,
%  \href{http://arxiv.org/abs/math/0505056}{[math.QA/0505056]}.

\bibitem[Ko]{Kock}
J.~Kock, \textsl{Frobenius Algebras and 2D Topological Quantum Field Theories}, Cambridge University Press, 2003.

%\bibitem[Lam86]{LambekRingsModules}
%J.~Lambek, \textsl{Lectures on rings and modules}, AMS Chelsea Publishing, 1986.

\bibitem[LM]{Calinetal}
C.~I. Lazaroiu and D.~McNamee, unpublished.

\bibitem[Lo]{Loday}
J.-L. Loday, \textsl{Cyclic homology}, Springer, 1997.

%\bibitem[LMnV00]{lmv0010102}
%J.~M.~F. Labastida, M.~Mari\~{n}o, and C.~Vafa, \textsl{Knot {I}nvariants and
%  {T}opological {S}trings}, JHEP \textbf{0011} (2000), 007,
%  \href{http://arxiv.org/abs/hep-th/0010102}{[hep-th/0010102]}.
%
%\bibitem[MSV09]{msv0708.2228}
%M.~Mackaay, M.~Sto\v{s}i\'{c}, and P.~Vaz, \textsl{$\mathfrak{sl}(N)$ link homology ($N\geq 4$) using foams and the Kapustin-Li formula}, Geometry \& Topology \textbf{13} (2009), 1075--1128,
%  \href{http://arxiv.org/abs/0708.2228}{[arXiv:0708.2228]}.
%
%\bibitem[Man07]{m0601629}
%C.~Manolescu, \textsl{Link homology theories from symplectic geometry}, Adv. in
%  Math. \textbf{211} (2007), 363--416,
%  \href{http://www.arxiv.org/abs/math.AG/0601629}{[math.SG/0601629]}.

\bibitem[McN09]{McNameethesis}
D.~McNamee, \textsl{On the mathematical structure of topological defects in
  {L}andau-{G}inzburg models}, MSc Thesis, Trinity College Dublin, 2009.
  
\bibitem[Mu]{m0912.1629}
D.~Murfet, \textsl{Residues and duality for singularity categories of isolated {G}orenstein singularities},
  \href{http://arxiv.org/abs/0912.1629}{[arXiv:0912.1629]}.  

%\bibitem[Mn05]{marinoknotbook}
%M.~Mari\~{n}o, \textsl{Chern-{S}imons {T}heory, {M}atrix {M}odels, and
%  {T}opological s{t}rings}, Oxford University Press, 2005.
%
%\bibitem[MOY98]{moy1998}
%H.~Murakami, T.~Ohtsuki, and S.~Yamada, \textsl{Homfly polynomial via an
%  invariant of colored plane graphs}, Enseign. Math. \textbf{44} (1998),
%  325--360.
%
%\bibitem[MS]{ms0709.1971}
%V.~Manzorchuck and C.~Stroppel, \textsl{A combinatorial approach to functorial
%  quantum {$\mathfrak{sl}_k$} knot invariants},
%  \href{http://arxiv.org/abs/0709.1971}{[arXiv:0709.1971]}.
%
%\bibitem[OV00]{ov9912123}
%H.~Ooguri and C.~Vafa, \textsl{Knot {I}nvariants and {T}opological {S}trings},
%  Nucl. Phys. B \textbf{577} (2000), 419--438,
%  \href{http://arxiv.org/abs/hep-th/9912123}{[hep-th/9912123]}.

\bibitem[P10]{p0807.1471}
K.~Ponto, \textsl{Shadows and traces in bicategories}, 
Ast\'erisque, (333), 2010, 
\href{http://arxiv.org/abs/0807.1471}{[arXiv:0807.1471]}. 

\bibitem[PS]{ps0910.1306}
K.~Ponto and M.~Shulman, \textsl{Shadows and traces in bicategories}, 
\href{http://arxiv.org/abs/0910.1306}{[arXiv:0910.1306]}. 

\bibitem[PV]{pv1002.2116}
A.~Polishchuk and A.~Vaintrob, \textsl{Chern characters and {H}irzebruch-{R}iemann-{R}och formula for matrix factorizations}, 
\href{http://arxiv.org/abs/1002.2116}{[arXiv:1002.2116]}. 


%\bibitem[PT87]{HomflyPT}
%J.~Przytycki and P.~Traczyk, \textsl{Conway algebras and skein equivalence of
%  links}, Proc. Amer. Math. Soc. \textbf{100} (1987), 744--748.
%
%\bibitem[Ras]{r0607544}
%J.~Rasmussen, \textsl{Some differentials on {K}hovanov-{R}ozansky homology},
%  \href{http://arxiv.org/abs/math/0607544}{[math.GT/0607544]}.
%
%\bibitem[Ras07]{r0508510}
%J.~Rasmussen, \textsl{Khovanov-{R}ozansky homology of two-bridge knots and links},
%  Duke Math. J. \textbf{136} (2007), 551--583,
%  \href{http://arxiv.org/abs/math/0508510}{[math.GT/0508510]}.
%  
%\bibitem[Ric94]{rickard}
%J.~Rickard, \textsl{Translation functors and equivalences of derived categories for blocks of algebraic groups}, in âFinite dimensional algebras and related topicsâ, Kluwer (1994), 255-â264.
%
%\bibitem[Rou06]{RouquierMexico}
%R.~Rouquier, \textsl{Categorification of {$\mathfrak{sl}_{2}$} and braid groups},
%  Trends in representation theory of algebras and related topics (2006),
%  137--167.
%
%\bibitem[RT90]{RT1990}
%N.~Reshetikhin and V.~Turaev, \textsl{Ribbon graphs and their invariants derived
%  from quantum groups}, Comm. Math. Phys. \textbf{127} (190), 1--26.
%
%\bibitem[RT91]{RT1991}
%N.~Reshetikhin and V.~Turaev, \textsl{Invariants of 3-manifolds via link polynomials and quantum
%  groups}, Invent. Math. \textbf{103} (1991), 547--597.
%
%\bibitem[SS06]{ss0405089}
%P.~Seidel and I.~Smith, \textsl{A link invariant from the symplectic geometry of
%  nilpotent slices}, Duke Math. J. \textbf{134} (2006), 453--514,
%  \href{http://arxiv.org/abs/math/0405089}{[math.SG/0405089]}.

\bibitem[SW11]{sw0911.0917}
C.~V.~Shepler and S.~Witherspoon, \textsl{Quantum differentiation and chain maps of bimodule complexes}, Algebra and Number Theory \textbf{5}-3 (2011), 339--360, 
\href{http://arxiv.org/abs/0911.0917}{[arXiv:0911.0917]}. 

%\bibitem[Str05]{sCatTLcTCpf}
%C.~Stroppel, \textsl{Categorification of the {T}emperley-{L}ieb category,
%  tangles, and cobordisms via projective functors}, Duke Math. J. \textbf{126}
%  (2005), 547--596.
%
%\bibitem[Sus]{s0701045}
%J.~Sussan, \textsl{Category {$\mathcal O$} and {$\mathfrak{sl}_k$} link
%  invariants}, \href{http://arxiv.org/abs/math/0701045}{[math.QA/0701045]}.
%
%\bibitem[Tur88]{t1988YB}
%V.~Turaev, \textsl{The {Y}ang-{B}axter equation and invariants of links}, Invent.
%  Math. \textbf{92} (1988), 527--553.
%
%\bibitem[Tur10]{turaevbook}
%V.~Turaev, \textsl{Quantum invariants of knots and 3-manifolds}, de Gruyter, 2010,
%  2nd edition.
%
%\bibitem[Weba]{w0610650}
%B.~Webster, \textsl{Khovanov-Rozansky homology via a canopolis formalism},
%  \href{http://arxiv.org/abs/math/0610650}{[math.GT/0610650]}.
%
%\bibitem[Webb]{w1005.4559}
%B.~Webster, \textsl{Knot invariants and higher representation theory {II}: the
%  categorification of quantum knot invariants},
%  \href{http://arxiv.org/abs/1005.4559}{[arXiv:1005.4559]}.
%
%\bibitem[Wit]{w1101.3216}
%E.~Witten, \textsl{Fivebranes and {K}nots},
%  \href{http://arxiv.org/abs/1101.3216}{[arXiv:1101.3216]}.
%
%\bibitem[Wit89]{wittenjones}
%E.~Witten, \textsl{Quantum field theory and the {J}ones polynomial}, Comm. Math.
%  Phys. \textbf{121} (1989), 351--399.
%
%\bibitem[Wit95]{w9207094}
%E.~Witten, \textsl{Chern-{S}imons {G}auge {T}heory {A}s {A} {S}tring {T}heory},
%  Prog. Math. \textbf{133} (1995), 637--678,
%  \href{http://arxiv.org/abs/hep-th/9207094}{[hep-th/9207094]}.
%
%\bibitem[Wu]{w0907.0695}
%H.~Wu, \textsl{A colored {$\mathfrak{sl}(N)$}-homology for links in {$S^3$}},
%  \href{http://arxiv.org/abs/0907.0695}{[arXiv:0907.0695]}.
%
%\bibitem[Wu08]{w0508064}
%H.~Wu, \textsl{Braids, {T}ransversal links and the {K}hovanov-{R}ozansky {T}heory},
%  \href{http://arxiv.org/abs/math/0508064}{[math.GT/0508064]}, Trans. Amer. Math. Soc. \textbf{360}
%  (2008), 3365--3389.
%
%\bibitem[Yon]{y0906.0220}
%Y.~Yonezawa, \textsl{Quantum {$(\mathfrak{sl}_n, \wedge V_n)$} link invariant and
%  matrix factorizations},
%  \href{http://arxiv.org/abs/0906.0220}{[arXiv:0906.0220]}.

\end{thebibliography}

\end{document}
